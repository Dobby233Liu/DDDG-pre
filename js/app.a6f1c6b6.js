(function(t){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],l=0,d=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);f&&f(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},o={app:0},a={app:0},i=[];function c(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-57967dfc":"2f238bd3","chunk-f6c4e426":"e497202e"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-57967dfc":1,"chunk-f6c4e426":1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-57967dfc":"54fae591","chunk-f6c4e426":"308ae515"}[t]+".css",a=s.p+r,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var u=i[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return e()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){u=d[c],l=u.getAttribute("data-href");if(l===r||l===a)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var r=e&&e.target&&e.target.src||a,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete o[t],f.parentNode.removeChild(f),n(i)},f.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(f)})).then((function(){o[t]=0})));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,n){r=a[t]=[e,n]}));e.push(r[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=c(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(f);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",d.name="ChunkLoadError",d.type=r,d.request=o,n[1](d)}a[t]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var f=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"02e0":function(t,e,n){"use strict";n("632f")},"032b":function(t,e,n){"use strict";n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("96cf");var r=n("1da1"),o=n("d4ec"),a=n("bee2"),i=n("262e"),c=n("2caf"),s=(n("99af"),n("4de4"),n("c975"),n("d81d"),n("a434"),n("ac1f"),n("25f0"),n("6062"),n("841c"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("5530")),u=n("2909"),l=n("7a23"),d=n("4918"),f=function(){function t(){var e=this;Object(o["a"])(this,t),this.state=Object(l["s"])({autoAdd:[],downloadLocation:"Default download folder"}),this._gameMode=null,this.vuexHistory=null,this.$store=null,this.isSavingEnabled=Object(l["t"])(!1),this.localRepositoryUrl="";var n=this,a=h.canSave();window.addEventListener("beforeunload",(function(t){t.preventDefault(),t.returnValue="Are you sure you want to leave? All your progress will be lost!"}));var i=Object(l["s"])({optionalSaving:a,get autoLoading(){return a&&n.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([])});this.supports=i,this.loading=a?Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h.doesDbExists();case 2:n=t.sent,e.savingEnabled=n;case 4:case"end":return t.stop()}}),t)})))():Promise.resolve(),this.loading.then(Object(r["a"])(regeneratorRuntime.mark((function t(){var n,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.creatingDB){t.next=3;break}return t.next=3,e.creatingDB;case 3:if(!e.savingEnabled){t.next=16;break}return t.next=6,h.loadAutoload();case 6:if(t.t0=t.sent,t.t0){t.next=9;break}t.t0=[];case 9:return n=t.t0,e.state.autoAdd=n,t.next=13,d["a"].getInstance();case 13:o=t.sent,a=n.map((function(t){var e=o.getPack(t);return e.dddg2Path||e.dddg1Path})),e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",a);case 2:case"end":return t.stop()}}),t)}))));case 16:case"end":return t.stop()}}),t)}))))}return Object(a["a"])(t,[{key:"loadGameMode",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=new URLSearchParams(location.search),n=e.get("mode"),"ddlc"!==n&&"ddlc_plus"!==n){t.next=5;break}return this._gameMode=n,t.abrupt("return");case 5:return t.next=7,this.loading;case 7:return t.next=9,this.creatingDB;case 9:if(r="",!this.isSavingEnabled.value){t.next=14;break}return t.next=13,h.loadGameMode();case 13:r=t.sent;case 14:o="ddlc","ddlc"!==r&&"ddlc_plus"!==r||(o=r),this._gameMode=o;case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"saveGameMode",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.isSavingEnabled.value){t.next=3;break}return t.next=3,h.saveGameMode(e);case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateDownloadFolder",value:function(){throw new Error("Method not implemented.")}},{key:"openFolder",value:function(t){throw new Error("Method not implemented.")}},{key:"connectToStore",value:function(t,e){this.vuexHistory=t,this.$store=e}},{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",o=c.length>3&&void 0!==c[3]?c[3]:1,a=document.createElement("a"),a.setAttribute("download",n),t.next=6,this.createObjectURL(e,r,o);case 6:return i=t.sent,a.setAttribute("href",i),document.body.appendChild(a),a.click(),document.body.removeChild(a),t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"installBackground",value:function(t){throw new Error("This environment does not support installing backgrounds")}},{key:"uninstallBackground",value:function(t){throw new Error("This environment does not support uninstalling backgrounds")}},{key:"localRepoInstall",value:function(t,e,n){throw new Error("This environment does not support a local repository")}},{key:"localRepoUninstall",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"autoLoadAdd",value:function(t){var e=this;Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.loading;case 2:return n.next=4,e.creatingDB;case 4:return n.next=6,h.saveAutoload([].concat(Object(u["a"])(e.state.autoAdd),[t]));case 6:e.state.autoAdd.push(t);case 7:case"end":return n.stop()}}),n)})))()}},{key:"autoLoadRemove",value:function(t){var e=this;Object(r["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.loading;case 2:return n.next=4,e.creatingDB;case 4:return n.next=6,h.saveAutoload(e.state.autoAdd.filter((function(e){return e!=t})));case 6:r=e.state.autoAdd.indexOf(t),e.state.autoAdd.splice(r,1);case 8:case"end":return n.stop()}}),n)})))()}},{key:"loadSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:if(e={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0},this.isSavingEnabled.value){t.next=7;break}return t.abrupt("return",e);case 7:return t.t0=s["a"],t.t1=Object(s["a"])({},e),t.next=11,h.loadSettings();case 11:return t.t2=t.sent,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"saveSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:if(this.isSavingEnabled.value){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,h.saveSettings(e);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"isInitialized",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return new Promise((function(n,r){n(prompt(t,e))}))}))},{key:"onPanelChange",value:function(t){}},{key:"createObjectURL",value:function(t,e,n){var r=this;return new Promise((function(o,a){var i=!(!window.URL||!window.URL.createObjectURL);if(!i)return o(t.toDataURL(e,n));if(t.toBlob)t.toBlob((function(t){t?o(URL.createObjectURL(t)):a()}),e,n);else{var c=t.toDataURL(e,n),s=r.dataURItoBlob(c,e);o(URL.createObjectURL(s))}}))}},{key:"dataURItoBlob",value:function(t,e){for(var n=atob(t.split(",")[1]),r=n.length,o=new Uint8Array(r),a=0;a<r;a++)o[a]=n.charCodeAt(a);return new Blob([o],{type:e})}},{key:"gameMode",get:function(){return this._gameMode}},{key:"savingEnabled",get:function(){return this.isSavingEnabled.value},set:function(t){var e=this;t?(localStorage.setItem("saving","true"),this.creatingDB=h.createDB(),this.creatingDB.then((function(){e.creatingDB=void 0,e.isSavingEnabled.value=!0})).catch((function(){}))):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=h.clearDB().then((function(){e.creatingDB=void 0})).catch((function(){})))}}]),t}(),h={indexedDB:function(){try{return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB}catch(t){return null}}(),transaction:function(){try{return window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction}catch(t){return null}}(),db:null,canSave:function(){return!(!h.indexedDB||!window.localStorage)},doesDbExists:function(){var t=localStorage.getItem("saving");return"true"===t?Promise.resolve(!0):Promise.resolve(!1)},createDB:function(){return h.db?h.db:h.db=new Promise((function(t,e){var n=h.indexedDB.open("dddg",3);n.onerror=function(t){e(t)},n.onupgradeneeded=function(t){var e,n=t.target.result,r=null!==(e=t.oldVersion)&&void 0!==e?e:t.version;r<1&&n.createObjectStore("settings"),1===r&&(n.deleteObjectStore("settings"),n.createObjectStore("settings"))},n.onsuccess=function(e){t(n.result)}}))},clearDB:function(){return new Promise((function(t,e){if(h.db){var n=h.indexedDB.deleteDatabase("dddg");h.db=null,n.onerror=function(t){e(t)},n.onsuccess=function(e){t()}}else t()}))},loadAutoload:function(){var t=this;return this.objectStorePromise("readonly",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.reqPromise(n.get("autoload"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},saveAutoload:function(t){var e=this;return this.objectStorePromise("readwrite",function(){var n=Object(r["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.reqPromise(r.put(Object(u["a"])(t),"autoload"));case 2:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())},loadGameMode:function(){var t=this;return this.objectStorePromise("readonly",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.reqPromise(n.get("gameMode"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},saveGameMode:function(t){var e=this;return this.objectStorePromise("readwrite",function(){var n=Object(r["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.reqPromise(r.put(t,"gameMode"));case 2:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())},saveSettings:function(t){var e=this;return this.objectStorePromise("readwrite",function(){var n=Object(r["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.reqPromise(r.put(Object(s["a"])({},t),"settings"));case 2:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())},loadSettings:function(){var t=this;return this.objectStorePromise("readonly",function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.reqPromise(n.get("settings"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},objectStorePromise:function(t,e){var n=this;return this.db?new Promise(function(){var o=Object(r["a"])(regeneratorRuntime.mark((function r(o,a){var i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.db;case 2:return i=r.sent.transaction(["settings"],t),c=i.objectStore("settings"),r.prev=4,r.t0=o,r.next=8,e(c);case 8:r.t1=r.sent,(0,r.t0)(r.t1),r.next=15;break;case 12:r.prev=12,r.t2=r["catch"](4),a(r.t2);case 15:case"end":return r.stop()}}),r,null,[[4,12]])})));return function(t,e){return o.apply(this,arguments)}}()):Promise.reject(new Error("No database"))},reqPromise:function(t){return new Promise((function(e,n){t.onerror=function(t){n(t)},t.onsuccess=function(n){e(t.result)}}))}},b=function(t){Object(i["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(o["a"])(this,n),e.apply(this,arguments)}return Object(a["a"])(n,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",o=c.length>3&&void 0!==c[3]?c[3]:1,a=e.toDataURL(r,o),i=this.dataURItoBlob(a,r),window.URL&&window.URL.createObjectURL&&(a=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,n),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),n}(f),p=(n("2ca0"),n("5947")),m=n("0c0f"),v={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},g=function(){function t(){var e=this;Object(o["a"])(this,t),this.state=Object(l["s"])({autoAdd:[],downloadLocation:""}),this.localRepositoryUrl="/repo/",this._gameMode=null,this.electron=window,this.vuexHistory=null,this.$store=null,this.bgInvalidation=null,this.pendingContentPacks=[],this.supports={autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"])},this.savingEnabled=!0,this.electron.ipcRenderer.on("add-persistent-content-pack",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store&&e.vuexHistory){t.next=3;break}return e.pendingContentPacks.push(n),t.abrupt("return");case 3:e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",n);case 2:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("add-persistent-background",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r="persistentBg-"+n,o=n.split("/"),Object(p["g"])(r,n),v.backgrounds.push({id:r,variants:[[r]],label:o[o.length-1],scaling:"none"}),e.invalidateInstalledBGs();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("push-message",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:m["h"].fire(new m["f"](e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("config.downloadFolderUpdate",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.state.downloadLocation=n;case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.onConversation("load-packs",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){var o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getInstance();case 2:o=t.sent,a=n.map((function(t){var e=o.getPack(t);return e.dddg2Path||e.dddg1Path})),e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",a);case 2:case"end":return t.stop()}}),t)}))));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.onConversation("auto-load.changed",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.state.autoAdd=n;case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.onConversation("reload-repo",Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getInstance();case 2:return t.next=4,t.sent.reloadLocalRepo();case 4:case"end":return t.stop()}}),t)})))),this.electron.ipcRenderer.onConversation("replace-pack",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/replaceContentPack",{processed:!1,contentPack:n});case 2:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.send("init-dddg")}return Object(a["a"])(t,[{key:"updateDownloadFolder",value:function(){this.electron.ipcRenderer.send("config.newDownloadFolder")}},{key:"openFolder",value:function(t){this.electron.ipcRenderer.send("open-folder",t)}},{key:"onPanelChange",value:function(t){}},{key:"saveSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.set","nsfw",e.nsfw);case 2:return t.next=4,this.electron.ipcRenderer.sendConvo("config.set","darkMode",null!==(n=e.darkMode)&&void 0!==n?n:void 0);case 4:return t.next=6,this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",e.defaultCharacterTalkingZoom);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadGameMode",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.get","gameMode");case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0="ddlc";case 5:this._gameMode=t.t0;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"saveGameMode",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.set","gameMode",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.get","nsfw");case 2:if(t.t1=e=t.sent,t.t0=null!==t.t1,!t.t0){t.next=6;break}t.t0=void 0!==e;case 6:if(!t.t0){t.next=10;break}t.t2=e,t.next=11;break;case 10:t.t2=!1;case 11:return t.t3=t.t2,t.next=14,this.electron.ipcRenderer.sendConvo("config.get","darkMode");case 14:if(t.t5=n=t.sent,t.t4=null!==t.t5,!t.t4){t.next=18;break}t.t4=void 0!==n;case 18:if(!t.t4){t.next=22;break}t.t6=n,t.next=23;break;case 22:t.t6=void 0;case 23:return t.t7=t.t6,t.next=26,this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom");case 26:if(t.t9=r=t.sent,t.t8=null!==t.t9,!t.t8){t.next=30;break}t.t8=void 0!==r;case 30:if(!t.t8){t.next=34;break}t.t10=r,t.next=35;break;case 34:t.t10=void 0;case 35:return t.t11=t.t10,t.abrupt("return",{lq:!1,nsfw:t.t3,darkMode:t.t7,defaultCharacterTalkingZoom:t.t11});case 37:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"localRepoInstall",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("repo.install",e,n,r);case 2:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"localRepoUninstall",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("repo.uninstall",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"autoLoadAdd",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("auto-load.add",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"autoLoadRemove",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("auto-load.remove",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"saveToFile",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise((function(i,c){t.toBlob(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(r){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return c(),t.abrupt("return");case 3:return t.next=5,r.arrayBuffer();case 5:return o=t.sent,t.next=8,n.electron.ipcRenderer.sendConvo("save-file",e,new Uint8Array(o));case 8:i(URL.createObjectURL(r));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o,a)}))}},{key:"installBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.uploadedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(p["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,fetch(n.src);case 11:return r=t.sent,t.t0=Uint8Array,t.next=15,r.arrayBuffer();case 15:t.t1=t.sent,o=new t.t0(t.t1),this.electron.ipcRenderer.send("install-background",o);case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"uninstallBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.installedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(p["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:if(n.src.startsWith("blob:")){t.next=18;break}return t.next=12,fetch(n.src);case 12:return r=t.sent,t.next=15,r.blob();case 15:o=t.sent,a=URL.createObjectURL(o),Object(p["g"])(e.assets[0].hq,a);case 18:this.electron.ipcRenderer.send("uninstall-background",e.id);case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("show-prompt",e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"connectToStore",value:function(t,e){var n=this;this.vuexHistory=t,this.$store=e,this.invalidateInstalledBGs(),this.pendingContentPacks.length>0&&this.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.$store.dispatch("content/loadContentPacks",n.pendingContentPacks);case 2:case"end":return t.stop()}}),t)}))))}},{key:"invalidateInstalledBGs",value:function(){var t=this;this.vuexHistory&&this.$store&&null===this.bgInvalidation&&(this.bgInvalidation=requestAnimationFrame((function(){t.updateInstalledBGs()})))}},{key:"updateInstalledBGs",value:function(){var t=this;this.bgInvalidation&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.vuexHistory&&this.$store&&this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:v})}))}},{key:"gameMode",get:function(){return this._gameMode}}]),t}();function j(){return window.isElectron?new g:void 0!==window.navigator.msSaveOrOpenBlob?new b:new f}var O=j();window.toast=O;e["a"]=O},"0904":function(t,e,n){},"0c0f":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return f}));var r=n("d4ec"),o=n("14b7"),a=Object(o["a"])();e["h"]={fire:function(t){a.emit(t.kind,t)},subscribe:function(t,e){a.on(t.kind,e)},unsubscribe:function(t,e){a.off(t.kind,e)}};var i=function t(e){Object(r["a"])(this,t),this.path=e,this.kind="AssetFailureEvent"};i.kind="AssetFailureEvent";var c=function t(e){Object(r["a"])(this,t),this.message=e,this.kind="FailureEvent"};c.kind="FailureEvent";var s=function t(e){Object(r["a"])(this,t),this.error=e,this.kind="CustomAssetFailureEvent"};s.kind="CustomAssetFailureEvent";var u=function t(){Object(r["a"])(this,t),this.kind="InvalidateRenderEvent"};u.kind="InvalidateRenderEvent";var l=function t(e){Object(r["a"])(this,t),this.message=e,this.kind="ShowMessageEvent"};l.kind="ShowMessageEvent";var d=function t(e){Object(r["a"])(this,t),this.color=e,this.kind="ColorPickedEvent"};d.kind="ColorPickedEvent";var f=function t(e,n){Object(r["a"])(this,t),this.error=e,this.info=n,this.kind="VueErrorEvent"};f.kind="VueErrorEvent"},"121d":function(t,e,n){"use strict";n("8c48")},"13b6":function(t,e,n){},"1a7b":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n("b85c"),o=n("d4ec"),a=n("bee2"),i=n("45eb"),c=n("7e84"),s=n("262e"),u=n("2caf"),l=n("ba37"),d=n("4a6f"),f=function(t){Object(s["a"])(n,t);var e=Object(u["a"])(n);function n(t,r){var a;return Object(o["a"])(this,n),a=e.call(this,t),a.data=r,a.scaleable=!0,a}return Object(a["a"])(n,[{key:"updatedContent",value:function(t,e){Object(i["a"])(Object(c["a"])(n.prototype),"updatedContent",this).call(this,t,e),this.data=Object(l["e"])(t,this.obj)}},{key:"getAssetList",value:function(){var t,e=Object(l["h"])(this.data,this.obj),n=Object(l["f"])(this.data,this.obj),o=[],a=Object(r["a"])(e.renderCommands);try{for(a.s();!(t=a.n()).done;){var i=t.value;switch(i.type){case"head":o.push({offset:i.offset,composite:i.composite,assets:n?n.variants[this.obj.posePositions.head||0]:[]});break;case"image":o.push({offset:i.offset,composite:i.composite,assets:i.images});break;case"pose-part":var c=e.positions[i.part];if(!c||0===c.length)break;var s=c[this.obj.posePositions[i.part]||0];if(!s)break;o.push({offset:i.offset,composite:i.composite,assets:s});break}}}catch(u){a.e(u)}finally{a.f()}return o}},{key:"canvasHeight",get:function(){var t=Object(l["h"])(this.data,this.obj);return t.size[1]}},{key:"canvasWidth",get:function(){var t=Object(l["h"])(this.data,this.obj);return t.size[0]}},{key:"closeZoom",get:function(){var t=1;return this.obj.close&&(t*=2),t}},{key:"width",get:function(){return this.obj.width*this.closeZoom}},{key:"height",get:function(){return this.obj.height*this.closeZoom}}]),n}(d["a"])},"1adc":function(t,e,n){},"1c59":function(t,e,n){"use strict";n("ec4d")},"20ef":function(t,e,n){},"25d4":function(t,e,n){"use strict";n("db4f")},"28de":function(t,e,n){"use strict";n("e074")},3048:function(t,e,n){"use strict";n.r(e),n.d(e,"screenWidth",(function(){return r})),n.d(e,"screenHeight",(function(){return o})),n.d(e,"positions",(function(){return a})),n.d(e,"sdCharacterScaleFactor",(function(){return i})),n.d(e,"hdCharacterScaleFactor",(function(){return c})),n.d(e,"CloseUpYOffset",(function(){return s})),n.d(e,"BaseCharacterYPos",(function(){return u})),n.d(e,"characterPositions",(function(){return l}));var r=1920,o=1080,a=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],i=1.5,c=1,s=-111,u=-39,l=[300,360,600,740,960,1180,1320,1560,1620]},"31cb":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("99af"),n("c975"),n("d81d"),n("fb6a"),n("d3b7"),n("ac1f"),n("25f0"),n("4d90"),n("1276"),n("498a");var r=n("d4ec"),o=n("bee2"),a=n("e965"),i=function(){function t(e,n,o,a){Object(r["a"])(this,t),this.r=e,this.g=n,this.b=o,this.a=a}return Object(o["a"])(t,[{key:"toCss",value:function(){return this.a>1?"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")"):"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")")}},{key:"toHex",value:function(){return"#".concat(Math.round(this.r).toString(16).padStart(2,"0")).concat(Math.round(this.g).toString(16).padStart(2,"0")).concat(Math.round(this.b).toString(16).padStart(2,"0")).concat(Math.round(255*this.a).toString(16).padStart(2,"0"))}},{key:"toRgb",value:function(){return this}},{key:"toHSL",value:function(){var t=this.r,e=this.g,n=this.b,r=this.a;t/=255,e/=255,n/=255;var o,i,c=Math.max(t,e,n),s=Math.min(t,e,n),u=(c+s)/2;if(c===s)o=i=0;else{var l=c-s;switch(i=u>.5?l/(2-c-s):l/(c+s),c){case t:o=(e-n)/l+(e<n?6:0);break;case e:o=(n-t)/l+2;break;case n:o=(t-e)/l+4;break}o/=6}return new a["a"](o,i,u,r)}},{key:"luminance",get:function(){return Math.sqrt(Math.pow(this.r/255*.299,2)+Math.pow(this.g/255*.587,2)+Math.pow(this.b/255*.114,2))}}],[{key:"validCss",value:function(t){return this.validCssRgb(t)||this.validHex(t)}},{key:"fromCss",value:function(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}},{key:"validCssRgb",value:function(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}},{key:"fromCssRgb",value:function(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");var n=e.slice(0,-1),r=n.indexOf("("),o=n.slice(r+1),a=o.split(",").map((function(t){return parseFloat(t.trim())}));return new t(a[0],a[1],a[2],4===a.length?a[3]:1)}},{key:"validHex",value:function(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}},{key:"fromHex",value:function(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");var n=e.slice(1);if(3===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(4===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(6===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(8===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}}]),t}();i.rgbEx=/^rgb\((\d*?),(\d*?),(\d*?)\)$/i,i.rgbaEx=/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i,i.hexShortEx=/^#[0-9A-Z]{3,4}$/i,i.hexLongEx=/^#[0-9A-Z]{6,8}$/i},3394:function(t,e,n){},3672:function(t,e,n){"use strict";n("0904")},"39b7":function(t,e,n){"use strict";var r=n("7a23");function o(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("a",{target:"_blank",rel:"noopener noreferrer",href:t.href},[Object(r["v"])(t.$slots,"default")],8,["href"])}n("ac1f"),n("5319");var a=n("aacd"),i=Object(r["m"])({mixins:[a["a"]],props:{to:{type:String,required:!0}},computed:{href:function(){var t=this.to;return t=t.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),t=t.replace(/^wiki:\/\/(.*)/,(function(t,e){return"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+e.replaceAll(" ","-")})),t}}});i.render=o;e["a"]=i},"3cb8":function(t,e,n){},4265:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n("d3b7");var r=n("3835"),o=(n("96cf"),n("1da1")),a=n("d4ec"),i=n("bee2"),c=n("fd0b"),s=n("8cae"),u=function(){function t(e){Object(a["a"])(this,t),this.obj=e,this.localRenderer=null,this.lastVersion=null,this.hitDetectionFallback=!1,this.renderable=!1,this.lastHq=!1,this.ready=Promise.resolve()}return Object(i["a"])(t,[{key:"updateLocalCanvas",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ready;case 2:if(n=this.canvasWidth,r=this.canvasHeight,0!==r||0!==n){t.next=7;break}return this.renderable=!1,t.abrupt("return");case 7:return this.renderable=!0,this.localRenderer=new c["a"](n,r),this.lastHq=e,t.next=12,this.localRenderer.render(this.renderLocal.bind(this));case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"needsRedraw",value:function(){return null===this.localRenderer||this.lastVersion!==this.version}},{key:"getRenderRotation",value:function(){return[this.flip?-this.rotation:this.rotation,{x:this.x,y:this.y+this.height/2}]}},{key:"render",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,n){var o,a,i,c,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=this.lastHq!==n.hq||this.needsRedraw(),!o){t.next=4;break}return t.next=4,this.updateLocalCanvas(!n.hq);case 4:if(this.lastVersion=this.version,this.renderable){t.next=7;break}return t.abrupt("return");case 7:a=this.getRenderRotation(),i=Object(r["a"])(a,2),c=i[0],s=i[1],n.drawImage({image:this.localRenderer,x:this.canvasDrawPosX,y:this.canvasDrawPosY,w:this.canvasDrawWidth,h:this.canvasDrawHeight,rotation:c,rotationAnchor:s,flip:this.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,composite:this.composite,filters:this.filters});case 9:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=this.getHitbox(),o=n.x0+(n.x1-n.x0)/2,a=n.y0+(n.y1-n.y0)/2,i=Object(s["a"])(t,e,o,a,this.flip?this.rotation:-this.rotation),c=Object(r["a"])(i,2),u=c[0],l=c[1],d=u>=n.x0&&u<=n.x1&&l>=n.y0&&l<=n.y1;if(!d)return!1;if(this.hitDetectionFallback)return!0;try{return this.pixelPerfectHitTest(t,e)}catch(f){this.hitDetectionFallback=!0}return!0}},{key:"pixelPerfectHitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=this.getRenderRotation(),o=Object(r["a"])(n,2),a=o[0],i=o[1],c=i?Object(s["a"])(t,e,i.x,i.y,-a):[t,e],u=Object(r["a"])(c,2),l=u[0],d=u[1],f=Math.round(l-this.canvasDrawPosX),h=Math.round(d-this.canvasDrawPosY),b=this.canvasDrawWidth,p=this.canvasDrawHeight;if(f>=0&&f<=b&&h>=0&&h<=p){var m=this.flip?this.canvasDrawWidth-f:f,v=this.canvasWidth/this.canvasDrawWidth,g=this.canvasHeight/this.canvasDrawHeight,j=this.localRenderer.getDataAt(Math.round(m*v),Math.round(h*g));return 0!==j[3]}return!1}},{key:"getHitbox",value:function(){return{x0:this.x-this.width/2,x1:this.x+this.width/2,y0:this.y,y1:this.y+this.height}}},{key:"updatedContent",value:function(t,e){}},{key:"id",get:function(){return this.obj.id}},{key:"x",get:function(){return this.obj.x}},{key:"y",get:function(){return this.obj.y}},{key:"version",get:function(){return this.obj.version}},{key:"flip",get:function(){return this.obj.flip}},{key:"rotation",get:function(){return this.obj.rotation/180*Math.PI}},{key:"composite",get:function(){return this.obj.composite}},{key:"filters",get:function(){return this.obj.filters}},{key:"width",get:function(){return this.obj.width}},{key:"height",get:function(){return this.obj.height}}]),t}()},"475b":function(t,e,n){},4918:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n("99af"),n("4de4"),n("7db0"),n("d81d"),n("4ec9"),n("dca8"),n("d3b7"),n("6062"),n("3ca3"),n("2ca0"),n("ddb0");var r=n("3835"),o=(n("96cf"),n("1da1")),a=n("5530"),i=n("2909"),c=n("d4ec"),s=n("bee2"),u=n("032b"),l=n("0c0f"),d=n("7a23"),f="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",h=function(){function t(e,n,r){var o=this;Object(c["a"])(this,t),this.$store=r,window.repo=this,e||(e={authors:{},packs:[]},l["h"].fire(new l["f"]("Couldn't load remote repository."))),n||(n={authors:{},packs:[]},u["a"].supports.localRepo&&l["h"].fire(new l["f"]("Couldn't load local repository."))),this.onlineRepo=Object(d["t"])(e),this.localRepo=Object(d["t"])(n),this.combinedList=Object(d["e"])((function(){var t,e,n,r,c=o.onlineRepo.value,s=null!==(t=null===c||void 0===c?void 0:c.packs)&&void 0!==t?t:[],l=(e=null===c||void 0===c?void 0:c.authors,new Map(s.map((function(t){return[t.id,t]})))),d=o.localRepo.value,f=null!==(n=null===d||void 0===d?void 0:d.packs)&&void 0!==n?n:[],h=(r=null===d||void 0===d?void 0:d.authors,new Map(f.map((function(t){return[t.id,t]})))),b=new Set(u["a"].state.autoAdd),p=o.$store.state.content.contentPacks.map((function(t){return t.packId})).filter((function(t){return!!t})),m=new Set(p),v=new Set;return[].concat(Object(i["a"])(p),Object(i["a"])(f.map((function(t){return t.id}))),Object(i["a"])(s.map((function(t){return t.id})))).filter((function(t){return!t.startsWith("dddg.buildin.")&&!t.startsWith("dddg.desktop.")&&(!v.has(t)&&(v.add(t),!0))})).map((function(t){var e,n;return Object(a["a"])(Object(a["a"])(Object(a["a"])({},null!==(e=l.get(t))&&void 0!==e?e:{characters:[],kind:[],authors:[]}),null!==(n=h.get(t))&&void 0!==n?n:{}),{},{autoloading:b.has(t),installed:h.has(t),online:l.has(t),loaded:m.has(t)})}))})),this.authors=Object(d["e"])((function(){var t,e,n=o.onlineRepo.value,r=null!==(t=null===n||void 0===n?void 0:n.authors)&&void 0!==t?t:{},i=o.localRepo.value,c=null!==(e=null===i||void 0===i?void 0:i.authors)&&void 0!==e?e:{};return Object(a["a"])(Object(a["a"])({},r),c)})),Object.freeze(this)}return Object(s["a"])(t,[{key:"reloadLocalRepo",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!u["a"].supports.localRepo){e.next=6;break}return e.next=3,t.loadRepo(u["a"].localRepositoryUrl);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=null;case 7:this.localRepo.value=e.t0;case 8:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"getPacks",value:function(){return this.combinedList.value}},{key:"getPack",value:function(t){return this.getPacks().find((function(e){return e.id===t}))}},{key:"getAuthor",value:function(t){return this.authors.value[t]||null}},{key:"getAuthors",value:function(){return this.authors.value}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=this.createInstance()),t.instance}},{key:"createInstance",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var n,o,a,i,c,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.loadRepo(f),o=u["a"].supports.localRepo?t.loadRepo(u["a"].localRepositoryUrl):null,e.next=4,Promise.all([n,o,t.$store]);case 4:return a=e.sent,i=Object(r["a"])(a,3),c=i[0],s=i[1],l=i[2],e.abrupt("return",new t(c,s,l));case 10:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()},{key:"loadRepo",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(n){var o,a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([t.fetchJSON(n+"repo.json"),t.fetchJSON(n+"people.json")]);case 3:return o=e.sent,a=Object(r["a"])(o,2),i=a[0],c=a[1],e.abrupt("return",{packs:i,authors:c});case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));function n(t){return e.apply(this,arguments)}return n}()},{key:"fetchJSON",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:if(n=t.sent,n.ok){t.next=5;break}throw new Error("Could not load json");case 5:return t.next=7,n.json();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();h.$store=new Promise((function(t,e){h.setStore=t}))},"4a6f":function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));n("99af"),n("4de4"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("96cf");var r=n("1da1"),o=n("b85c"),a=n("2909"),i=n("d4ec"),c=n("bee2"),s=n("45eb"),u=n("7e84"),l=n("262e"),d=n("2caf"),f=n("5947"),h=n("4265"),b=function(t){Object(l["a"])(n,t);var e=Object(d["a"])(n);function n(){var t;return Object(i["a"])(this,n),t=e.apply(this,arguments),t.refTextbox=null,t}return Object(c["a"])(n,[{key:"getHitbox",value:function(){var t=Object(s["a"])(Object(u["a"])(n.prototype),"getHitbox",this).call(this),e=this.width*(this.objZoom-1),r=this.height*(this.objZoom-1);return{x0:t.x0-e/2,x1:t.x1+e/2,y0:t.y0-r,y1:t.y1}}},{key:"updatedContent",value:function(t,e){var n=t.state.objects.panels[e],r=[].concat(Object(a["a"])(n.order),Object(a["a"])(n.onTopOrder));this.refTextbox=null;var i,c=Object(o["a"])(r);try{for(c.s();!(i=c.n()).done;){var s=i.value,u=t.state.objects.objects[s];if("textBox"===u.type&&u.talkingObjId===this.obj.id)return void(this.refTextbox=u)}}catch(l){c.e(l)}finally{c.f()}}},{key:"renderLocal",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.getAssetList(),t.next=3,Promise.all(n.filter((function(t){return t.assets})).map((function(t){return p(t,e.hq)})));case 3:r=t.sent,a=Object(o["a"])(r);try{for(a.s();!(i=a.n()).done;){c=i.value,s=Object(o["a"])(c.assets);try{for(s.s();!(u=s.n()).done;)l=u.value,e.drawImage({image:l,composite:c.composite,x:c.offset[0],y:c.offset[1]})}catch(d){s.e(d)}finally{s.f()}}}catch(d){a.e(d)}finally{a.f()}case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"canvasDrawWidth",get:function(){return this.width*this.objZoom}},{key:"canvasDrawHeight",get:function(){return this.height*this.objZoom}},{key:"canvasDrawPosX",get:function(){return this.x-this.width/2+(this.height-this.canvasDrawHeight)/2}},{key:"canvasDrawPosY",get:function(){return this.y+(this.height-this.canvasDrawHeight)}},{key:"objZoom",get:function(){var t=this.obj.enlargeWhenTalking&&this.refTextbox?1.05:1;return t*this.obj.zoom}}]),n}(h["a"]);function p(t,e){return m.apply(this,arguments)}function m(){return m=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!("loaded"in e)){t.next=2;break}return t.abrupt("return",e);case 2:return t.t0=e.offset,t.next=5,Promise.all(e.assets.map((function(t){return Object(f["a"])(t,n)})));case 5:return t.t1=t.sent,t.t2=e.composite,t.abrupt("return",{loaded:!0,offset:t.t0,assets:t.t1,composite:t.t2});case 8:case"end":return t.stop()}}),t)}))),m.apply(this,arguments)}},"4ad0":function(t,e,n){"use strict";n("475b")},"4e48":function(t,e,n){"use strict";n("5ab0")},"51f8":function(t,e,n){"use strict";n("13b6")},"525a":function(t,e,n){"use strict";n.r(e),n.d(e,"textboxDefaultColor",(function(){return o})),n.d(e,"controlsDefaultColor",(function(){return a})),n.d(e,"nameboxDefaultColor",(function(){return i})),n.d(e,"nameboxStrokeDefaultColor",(function(){return c})),n.d(e,"nameboxTextOutlineDelta",(function(){return s})),n.d(e,"nameboxBackgroundDelta",(function(){return u})),n.d(e,"nameboxGradientMiddleStopPosition",(function(){return l})),n.d(e,"nameboxGradientEndDelta",(function(){return d})),n.d(e,"nameboxRounding",(function(){return f})),n.d(e,"nameboxRoundingBuffer",(function(){return h})),n.d(e,"textboxRounding",(function(){return b})),n.d(e,"textboxRoundingBuffer",(function(){return p})),n.d(e,"nameColorThreshold",(function(){return m})),n.d(e,"controlColorDelta",(function(){return v})),n.d(e,"controlDisableColorDelta",(function(){return g})),n.d(e,"dotColorDelta",(function(){return j})),n.d(e,"dotRadius",(function(){return O})),n.d(e,"dotPatternSize",(function(){return k})),n.d(e,"textboxOutlineColorDelta",(function(){return x})),n.d(e,"textboxOutlineWidth",(function(){return y}));var r=n("e965"),o="#ffa8d2",a="#552222",i="#ffeef6",c="#bb5599",s=new r["a"](-.03065134099616873,-.5714285714285714,-.29607843137254897,0),u=new r["a"](.002028397565922768,0,.13725490196078438,0),l=.82,d=new r["a"](-.004901960784313708,-.8599999999999999,-.16274509803921566,0),f=12,h=1.5,b=12,p=1.5,m=.6,v=new r["a"](.08045977011494243,-.5714285714285714,-.5960784313725489,0),g=new r["a"](0,-.14285714285714296,.3,0),j=new r["a"](.004269293924466178,-.01869158878504662,-.039215686274509665,0),O=9.5,k=47,x=new r["a"](.0023347701149424305,0,.10784313725490202,0),y=3},"536a":function(t,e,n){},5520:function(t,e,n){},5523:function(t,e,n){},5947:function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return g})),n.d(e,"f",(function(){return O})),n.d(e,"g",(function(){return k}));n("99af"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d"),n("96cf");var r,o,a=n("1da1"),i=n("0c0f"),c=n("9be5"),s=n("032b");function u(){return r||(r=new Promise((function(t,e){var n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",r=document.createElement("img");r.addEventListener("load",(function(){t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){t(!1)})),r.src=n}))),r}function l(){return o||(o=new Promise((function(t,e){var n="data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",r=document.createElement("img");r.addEventListener("load",(function(){console.log("Heif no error. "+(2===r.width&&1===r.height)),t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){console.log("Heif not supported"),t(!1)})),r.src=n}))),o}var d={},f={};function h(t){return b.apply(this,arguments)}function b(){return b=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(r.length>1&&void 0!==r[1])||r[1],t.abrupt("return",p(s["a"].supports.lq&&!n?e.lq:e.hq));case 2:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function p(t){return m.apply(this,arguments)}function m(){return m=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d[e]||(d[e]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(){i["h"].fire(new i["a"](e)),d[e]=void 0,t(new c["a"])})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))),t.abrupt("return",d[e]);case 2:case"end":return t.stop()}}),t)}))),m.apply(this,arguments)}var v=".";function g(t){return j.apply(this,arguments)}function j(){return j=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!(o.length>1&&void 0!==o[1])||o[1],!f[e]){t.next=3;break}return t.abrupt("return",f[e]);case 3:return t.t0="".concat(v,"/assets/").concat(e).concat(n?"":".lq"),t.next=6,u();case 6:if(!t.sent){t.next=10;break}t.t1=".webp",t.next=11;break;case 10:t.t1=".png";case 11:return t.t2=t.t1,r=t.t0.concat.call(t.t0,t.t2).replace(/\/+/,"/"),t.abrupt("return",p(r));case 14:case"end":return t.stop()}}),t)}))),j.apply(this,arguments)}function O(t,e){var n=URL.createObjectURL(e);return f[t]=new Promise((function(t,e){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["h"].fire(new i["c"](t)),e('Failed to load "'.concat(n,'"'))})),r.crossOrigin="Anonymous",r.src=n,r.style.display="none",document.body.appendChild(r)})),n}function k(t,e){return f[t]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["h"].fire(new i["c"](t)),n('Failed to load "'.concat(e,'"'))})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))}},"5ab0":function(t,e,n){},"5b30":function(t,e,n){"use strict";n("3394")},"5c35":function(t,e,n){"use strict";n("cda6")},"5ca1":function(t,e,n){},6289:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("8f12");function o(){return{flip:!1,rotation:0,version:0,opacity:100,x:Object(r["a"])().Base.screenWidth/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null,zoom:1}}},6307:function(t,e,n){"use strict";n("a2a0")},"632f":function(t,e,n){},6662:function(t,e,n){},6700:function(t,e,n){},"67fb":function(t,e,n){},"6a18":function(t,e,n){"use strict";n("9993")},"6ae4":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n("99af"),n("cb29"),n("4de4"),n("a15b"),n("96cf");var r=n("1da1"),o=n("b85c"),a=n("5530"),i=n("d4ec"),c=n("bee2"),s=n("73e5"),u=n("fd0b"),l=n("9be5"),d=function(){function t(e,n,r,o){Object(i["a"])(this,t),this.canvas=e,this.fsCtx=n,this.hq=r,this.preview=o,this.aborted=!1}return Object(c["a"])(t,[{key:"drawText",value:function(t){if(this.aborted)throw new s["a"];this.fsCtx.save();var e=Object(a["a"])(Object(a["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,o=e.x,i=void 0===o?0:o,c=e.y,u=void 0===c?0:c,l=e.text,d=void 0===l?"":l;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(d,i,u)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(d,i,u)),this.fsCtx.restore()}},{key:"measureText",value:function(t){if(this.aborted)throw new s["a"];this.fsCtx.save();var e=Object(a["a"])(Object(a["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,o=e.text,i=void 0===o?"":o;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);var c=this.fsCtx.measureText(i);return this.fsCtx.restore(),c}},{key:"drawImage",value:function(t){if(this.aborted)throw new s["a"];if(!(t.image instanceof l["a"])){var e=Object(a["a"])({flip:!1,w:t.image.width,h:t.image.height,composite:"source-over"},t),n=e.image,r=e.flip,i=e.x,c=e.y,d=e.w,f=e.h,h=e.filters,b=e.composite;if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=b,h)if("filter"in this.fsCtx){var p,m=[],v=Object(o["a"])(h);try{for(v.s();!(p=v.n()).done;){var g=p.value;"drop-shadow"===g.type?m.push("drop-shadow(".concat(g.offsetX,"px ").concat(g.offsetY,"px ").concat(g.blurRadius,"px ").concat(g.color,")")):"hue-rotate"===g.type?m.push("hue-rotate(".concat(g.value,"deg)")):"blur"===g.type?m.push("blur(".concat(g.value,"px)")):m.push("".concat(g.type,"(").concat(100*g.value,"%)"))}}catch(S){v.e(S)}finally{v.f()}this.fsCtx.filter=m.join(" ")}else{var j,O=1,k=Object(o["a"])(h);try{for(k.s();!(j=k.n()).done;){var x=j.value;"opacity"===x.type&&(O*=x.value)}}catch(S){k.e(S)}finally{k.f()}this.fsCtx.globalAlpha=O}if(t.shadow){var y=t.shadow;y.color&&(this.fsCtx.shadowColor=y.color),y.blur&&(this.fsCtx.shadowBlur=y.blur),y.offsetX&&(this.fsCtx.shadowOffsetX=y.offsetX),y.offsetY&&(this.fsCtx.shadowOffsetY=y.offsetY)}if(t.rotation){var w=t.rotationAnchor?t.rotationAnchor.x:0,C=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(w,C),this.fsCtx.fillRect(-10,-1,21,3),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-w,-C)}this.fsCtx.translate(i+d/2,c+f/2),this.fsCtx.scale(r?-1:1,1),n instanceof u["a"]?n.paintOnto(this.fsCtx,{x:-d/2,y:-f/2,w:d,h:f}):this.fsCtx.drawImage(n,-d/2,-f/2,d,f),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}}},{key:"drawRect",value:function(t){var e=t.x,n=t.y,r=t.w,o=t.h,a=t.outline,i=t.fill,c=t.composition;if(this.aborted)throw new s["a"];this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(e,n,r,o),c&&(this.fsCtx.globalCompositeOperation=c),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),a&&(this.fsCtx.strokeStyle=a.style,this.fsCtx.lineWidth=a.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"drawPath",value:function(t){var e=t.outline,n=t.fill,r=t.path;if(this.aborted)throw new s["a"];this.fsCtx.save(),this.fsCtx.beginPath(),r(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"patternFrom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"repeat";return t instanceof u["a"]&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}},{key:"customTransform",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.fsCtx.save(),t.next=3,e(this.fsCtx);case 3:return t.next=5,n(this);case 5:this.fsCtx.restore();case 6:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"linearGradient",value:function(t,e,n,r){return this.fsCtx.createLinearGradient(t,e,n,r)}},{key:"applyFilters",value:function(t){if(0!==t.length){this.fsCtx.save();var e,n=1,r=Object(o["a"])(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;"opacity"===a.type&&(n*=a.value)}}catch(l){r.e(l)}finally{r.f()}if("filter"in this.fsCtx){var i,c=[],s=Object(o["a"])(t);try{for(s.s();!(i=s.n()).done;){var u=i.value;"opacity"!==u.type&&("drop-shadow"===u.type?c.push("drop-shadow(".concat(u.offsetX,"px ").concat(u.offsetY,"px ").concat(u.blurRadius,"px ").concat(u.color,")")):"hue-rotate"===u.type?c.push("hue-rotate(".concat(u.value,"deg)")):"blur"===u.type?c.push("blur(".concat(u.value,"px)")):c.push("".concat(u.type,"(").concat(100*u.value,"%)")))}}catch(l){s.e(l)}finally{s.f()}this.fsCtx.filter=c.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),1!==n&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle="rgba(0,0,0,".concat(n,")"),this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}}},{key:"abort",value:function(){this.aborted=!0}}],[{key:"make",value:function(e,n,r){return new t(e,e.getContext("2d"),n,r)}},{key:"makeWithContext",value:function(e,n,r,o){return new t(e,n,r,o)}}]),t}()},"6f08":function(t,e,n){"use strict";n("1adc")},7134:function(t,e,n){"use strict";n.r(e),n.d(e,"textboxDefaultColor",(function(){return o})),n.d(e,"controlsDefaultColor",(function(){return a})),n.d(e,"nameboxDefaultColor",(function(){return i})),n.d(e,"nameboxStrokeDefaultColor",(function(){return c})),n.d(e,"nameboxTextOutlineDelta",(function(){return s})),n.d(e,"nameboxBackgroundDelta",(function(){return u})),n.d(e,"nameboxGradientMiddleStopPosition",(function(){return l})),n.d(e,"nameboxGradientEndDelta",(function(){return d})),n.d(e,"nameboxRounding",(function(){return f})),n.d(e,"nameboxRoundingBuffer",(function(){return h})),n.d(e,"textboxRounding",(function(){return b})),n.d(e,"textboxRoundingBuffer",(function(){return p})),n.d(e,"nameColorThreshold",(function(){return m})),n.d(e,"controlColorDelta",(function(){return v})),n.d(e,"controlDisableColorDelta",(function(){return g})),n.d(e,"dotColorDelta",(function(){return j})),n.d(e,"dotRadius",(function(){return O})),n.d(e,"dotPatternSize",(function(){return k})),n.d(e,"textboxOutlineColorDelta",(function(){return x})),n.d(e,"textboxOutlineWidth",(function(){return y}));var r=n("e965"),o="#ffa8d2",a="#552222",i="#ffeef6",c="#bb5599",s=new r["a"](-.03065134099616873,-.5714285714285714,-.29607843137254897,0),u=new r["a"](.002028397565922768,0,.13725490196078438,0),l=.82,d=new r["a"](-.004901960784313708,-.8599999999999999,-.16274509803921566,0),f=15,h=1.5,b=19,p=1.5,m=.6,v=new r["a"](.08045977011494243,-.5714285714285714,-.5960784313725489,0),g=new r["a"](0,-.14285714285714296,.3,0),j=new r["a"](.004269293924466178,-.01869158878504662,-.039215686274509665,0),O=14.25,k=70.5,x=new r["a"](.0023347701149424305,0,.10784313725490202,0),y=5},"71ca":function(t,e,n){"use strict";n("7766")},"73e5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("d4ec"),o=function t(){Object(r["a"])(this,t)}},7766:function(t,e,n){},"7b2f":function(t,e,n){"use strict";n("5523")},"7dc9":function(t,e,n){},"7f2d":function(t,e,n){},"80a6":function(t,e,n){"use strict";n("ba79")},"835e":function(t,e,n){"use strict";n("f6f2")},"85e7":function(t,e,n){"use strict";n("3cb8")},"895e":function(t,e,n){},"8c48":function(t,e,n){},"8cae":function(t,e,n){"use strict";function r(t,e,n,r,o){var a=Math.cos(o),i=Math.sin(o),c=t-n,s=e-r,u=a*c-i*s+n,l=i*c+a*s+r;return[u,l]}n.d(e,"a",(function(){return r}))},"8f12":function(t,e,n){"use strict";n.d(e,"a",(function(){return jt}));var r={};n.r(r),n.d(r,"nameboxTextOutlineDelta",(function(){return d})),n.d(r,"ChoiceButtonColor",(function(){return f})),n.d(r,"ChoiceButtonBorderColor",(function(){return h})),n.d(r,"ChoiceButtonWidth",(function(){return b})),n.d(r,"ChoiceSpacing",(function(){return p})),n.d(r,"ChoiceX",(function(){return m})),n.d(r,"ChoiceYOffset",(function(){return v})),n.d(r,"ChoicePadding",(function(){return g})),n.d(r,"Outline",(function(){return j})),n.d(r,"ChoiceY",(function(){return O})),n.d(r,"ChoiceTextStyle",(function(){return k}));var o={};n.r(o),n.d(o,"NotificationBackgroundColor",(function(){return C})),n.d(o,"NotificationBorderColor",(function(){return S})),n.d(o,"NotificationBackdropColor",(function(){return R})),n.d(o,"NotificationPadding",(function(){return P})),n.d(o,"NotificationSpacing",(function(){return T})),n.d(o,"NotificationOkTextStyle",(function(){return B})),n.d(o,"NotificationTextStyle",(function(){return I}));var a={};n.r(a),n.d(a,"nameboxTextOutlineDelta",(function(){return _})),n.d(a,"ChoiceButtonColor",(function(){return $})),n.d(a,"ChoiceButtonBorderColor",(function(){return F})),n.d(a,"ChoiceButtonWidth",(function(){return N})),n.d(a,"ChoiceSpacing",(function(){return E})),n.d(a,"ChoiceX",(function(){return W})),n.d(a,"ChoiceYOffset",(function(){return M})),n.d(a,"ChoicePadding",(function(){return V})),n.d(a,"Outline",(function(){return L})),n.d(a,"ChoiceY",(function(){return U})),n.d(a,"ChoiceTextStyle",(function(){return z}));var i={};n.r(i),n.d(i,"NotificationBackgroundColor",(function(){return Y})),n.d(i,"NotificationBorderColor",(function(){return X})),n.d(i,"NotificationBackdropColor",(function(){return K})),n.d(i,"NotificationPadding",(function(){return J})),n.d(i,"NotificationSpacing",(function(){return Z})),n.d(i,"NotificationOkTextStyle",(function(){return Q})),n.d(i,"NotificationTextStyle",(function(){return tt}));var c={};n.r(c),n.d(c,"poemBackgrounds",(function(){return et})),n.d(c,"defaultPoemBackground",(function(){return nt})),n.d(c,"defaultPoemStyle",(function(){return rt})),n.d(c,"defaultX",(function(){return ot})),n.d(c,"defaultY",(function(){return at})),n.d(c,"poemTopPadding",(function(){return it})),n.d(c,"poemBottomPadding",(function(){return ct})),n.d(c,"poemPadding",(function(){return st})),n.d(c,"defaultPoemWidth",(function(){return ut})),n.d(c,"defaultPoemHeight",(function(){return lt})),n.d(c,"consoleBackgroundColor",(function(){return dt})),n.d(c,"consoleWidth",(function(){return ft})),n.d(c,"consoleHeight",(function(){return ht})),n.d(c,"defaultConsoleBackground",(function(){return bt})),n.d(c,"defaultConsoleStyle",(function(){return pt})),n.d(c,"poemTextStyles",(function(){return vt}));var s=n("032b"),u=n("e14c"),l=n("e965"),d=new l["a"](-.03065134099616873,-.5714285714285714,-.29607843137254897,0),f="#ffe6f4",h="#ffbde1",b=420,p=22,m=640,v=270,g=7,j=3,O=(u["screenHeight"]-v)/2,k={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},x=n("5530"),y=n("d206"),w=n("525a"),C="#ffe6f4",S="#ffbde1",R="rgba(255,255,255,0.6)",P=40,T=30,B=Object(x["a"])(Object(x["a"])({},y["BaseTextStyle"]),{},{fontName:"riffic",fontSize:24,strokeColor:w["nameboxStrokeDefaultColor"],strokeWidth:8,letterSpacing:1,color:"white"}),I={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},D=n("f70f"),A={Base:u,Choices:r,Notification:o,Poem:D,TextBox:y,TextBoxCustom:w},H=n("3048"),_=new l["a"](-.03065134099616873,-.5714285714285714,-.29607843137254897,0),$="#ffe6f4",F="#ffbde1",N=630,E=33,W=960,M=405,V=10.5,L=4.5,U=(H["screenHeight"]-M)/2,z={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},G=n("caeb"),q=n("7134"),Y="#ffe6f4",X="#ffbde1",K="rgba(255,255,255,0.6)",J=60,Z=45,Q=Object(x["a"])(Object(x["a"])({},G["BaseTextStyle"]),{},{fontName:"riffic",fontSize:36,strokeColor:q["nameboxStrokeDefaultColor"],strokeWidth:12,letterSpacing:1,color:"white"}),tt={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},et=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],nt=0,rt=0,ot=H["screenWidth"]/2,at=H["screenHeight"]/2,it=33,ct=100,st=30,ut=800,lt=720,dt="rgba(51,51,51,0.75)",ft=480,ht=180,bt=3,pt=7,mt={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},vt=[Object(x["a"])(Object(x["a"])({},mt),{},{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),Object(x["a"])(Object(x["a"])({},mt),{},{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),Object(x["a"])(Object(x["a"])({},mt),{},{name:"Monika",fontName:"journal",fontSize:34}),Object(x["a"])(Object(x["a"])({},mt),{},{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),Object(x["a"])(Object(x["a"])({},mt),{},{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),Object(x["a"])(Object(x["a"])({},mt),{},{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),Object(x["a"])(Object(x["a"])({},mt),{},{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),Object(x["a"])(Object(x["a"])({},mt),{},{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],gt={Base:H,Choices:a,Notification:i,Poem:c,TextBox:G,TextBoxCustom:q};function jt(){return"ddlc_plus"===s["a"].gameMode?gt:A}},9993:function(t,e,n){},"9be5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("d4ec"),o=function t(){Object(r["a"])(this,t)}},"9be8":function(t,e,n){"use strict";n("5520")},"9d12":function(t,e,n){},"9e3d":function(t,e,n){"use strict";n("7f2d")},a2a0:function(t,e,n){},a319:function(t,e,n){"use strict";n("6662")},aacd:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=25,o={methods:{verticalScrollRedirect:function(t){if("wheel"===t.type&&t.currentTarget){var e=t.currentTarget,n=getComputedStyle(e),o=t;if(0!==o.deltaY){if("auto"===n.overflowY)if(o.deltaY>0){if(e.scrollHeight>e.scrollTop+e.clientHeight)return void t.stopPropagation()}else if(e.scrollTop>0)return void t.stopPropagation();var a=e.scrollLeft;o.mozInputSource?e.scrollLeft+=o.deltaY*r:e.scrollLeft+=o.deltaY,e.scrollLeft!==a&&t.stopPropagation()}}}}}},acb5:function(t,e,n){},ae6d:function(t,e,n){"use strict";n("7dc9")},b35b:function(t,e,n){"use strict";n("67fb")},b3d7:function(t,e,n){"use strict";var r=n("7a23"),o=Object(r["F"])("data-v-36ffea9a");Object(r["r"])("data-v-36ffea9a");var a={class:"fieldset_wrapper"},i={key:0},c={class:"fieldset_contents"};Object(r["q"])();var s=o((function(t,e,n,o,s,u){return Object(r["p"])(),Object(r["g"])("div",a,[Object(r["k"])("fieldset",null,[t.title>""?(Object(r["p"])(),Object(r["g"])("legend",i,Object(r["x"])(t.title),1)):Object(r["h"])("",!0),Object(r["k"])("div",c,[Object(r["v"])(t.$slots,"default",{},void 0,!0)])])])})),u=Object(r["m"])({props:{title:{required:!0,type:String}}});n("25d4");u.render=s,u.__scopeId="data-v-36ffea9a";e["a"]=u},b8e2:function(t,e,n){"use strict";n("9d12")},ba37:function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"h",(function(){return h})),n.d(e,"g",(function(){return b})),n.d(e,"f",(function(){return p})),n.d(e,"c",(function(){return m})),n.d(e,"a",(function(){return g})),n.d(e,"d",(function(){return j}));n("99af"),n("4de4"),n("7db0"),n("c740"),n("5db7"),n("c975"),n("d81d"),n("73d9"),n("b64b"),n("d3b7"),n("ddb0"),n("96cf");var r=n("1da1"),o=n("ade3"),a=n("2909"),i=n("5530"),c=n("c837"),s=n("6289"),u=n("8f12"),l={setPose:function(t,e){var n=t.objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup:function(t,e){var n=e.id,r=e.styleGroupId,o=t.objects[n];o.styleGroupId=r,++o.version},setCharStyle:function(t,e){var n=e.id,r=e.styleId,o=t.objects[n];o.styleId=r,++o.version},setPosePosition:function(t,e){var n=t.objects[e.id];n.posePositions=Object(i["a"])(Object(i["a"])({},n.posePositions),e.posePositions),++n.version},setClose:function(t,e){var n=t.objects[e.id];n.close=e.close,++n.version},setFreeMove:function(t,e){var n=t.objects[e.id];if(n.freeMove=e.freeMove,!n.freeMove){var r=Object(u["a"])();n.x=r.Base.characterPositions[m(n.x)],n.y=r.Base.BaseCharacterYPos}}};function d(t,e){var n=t.getters["content/getCharacters"];return n.get(e.characterType)}function f(t,e){var n=t["content/getCharacters"];return n.get(e)}function h(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function b(t,e){var n=h(t,e),r=Object(a["a"])(Object.keys(n.positions).filter((function(t){return n.positions[t].length>1})));return n.compatibleHeads.length>0&&r.unshift("head"),r}function p(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.posePositions.headType||0,r=h(t,e).compatibleHeads;if(!r||0===r.length)return null;var o=t.heads[r[n]];return o}function m(t){var e=Object(u["a"])(),n=e.Base.characterPositions.map((function(e,n){return{pos:Math.abs(t-e),idx:n}})).sort((function(t,e){return t.pos-e.pos}));return n[0].idx}var v=0,g={createCharacters:function(t,e){var n=t.rootState,r=t.rootGetters,o=t.commit,a=Object(u["a"])(),c=f(r,e.characterType),l=c.hd?a.Base.hdCharacterScaleFactor:a.Base.sdCharacterScaleFactor;o("create",{object:Object(i["a"])(Object(i["a"])({},Object(s["a"])()),{},{id:"characters_"+ ++v,panelId:n.panels.currentPanel,onTop:!1,type:"character",y:a.Base.BaseCharacterYPos,preserveRatio:!0,ratio:1,width:c.size[0]*c.defaultScale[0]*l,height:c.size[1]*c.defaultScale[1]*l,characterType:e.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:c.label||c.id,enlargeWhenTalking:n.ui.defaultCharacterTalkingZoom})})},seekPart:function(t,e){var n=t.state,r=t.commit,a=t.dispatch,i=t.rootGetters,s=e.delta,u=e.id,l=e.part;if("head"!==l){var d=n.objects[u],b=h(f(i,d.characterType),d);b.positions[l]&&r("setPosePosition",{id:u,posePositions:Object(o["a"])({},l,Object(c["a"])(b.positions[l],d.posePositions[l]||0,s))})}else a("seekHead",{id:u,delta:s})},seekPose:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,s=n.objects[a],u=f(o,s.characterType),l=u.styleGroups[s.styleGroupId].styles[s.styleId].poses;y(r,s,u,(function(t){t.poseId=Object(c["a"])(l,t.poseId,i)}))},seekStyle:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,s=n.objects[a],u=f(o,s.characterType),l=u.styleGroups.flatMap((function(t,e){return t.styles.map((function(t,n){return{styleGroupIdx:e,styleIdx:n,styleGroupJson:JSON.stringify(t.components)}}))})).sort((function(t,e){return t.styleGroupJson.localeCompare(e.styleGroupJson)})),d=l.findIndex((function(t){return t.styleGroupIdx===s.styleGroupId&&t.styleIdx===s.styleId}));y(r,s,u,(function(t){var e=Object(c["a"])(l,d,i),n=l[e];t.styleGroupId=n.styleGroupIdx,t.styleId=n.styleIdx}))},seekHead:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,s=n.objects[a],u=f(o,s.characterType),l=h(u,s),d=p(u,s);if(d){var b=(s.posePositions.head||0)+i,m=s.posePositions.headType||0;(b<0||b>=d.variants.length)&&(m=Object(c["a"])(l.compatibleHeads.map((function(t){return u.heads[t]})),m,i),d=p(u,s,m),b=1===i?0:d.variants.length-1),r("setPosePosition",{id:a,posePositions:{head:b,headType:m}})}},setPart:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.part,c=e.val,s=n.objects[a],u=f(o,s.characterType);y(r,s,u,"pose"===i?function(t){t.poseId=c}:"style"===i?function(t){t.styleId=c}:function(t){t.posePositions[i]=c})},setCharStyle:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.styleGroupId,c=e.styleId,s=n.objects[a],u=f(o,s.characterType);y(r,s,u,(function(t){t.styleGroupId=i,t.styleId=c}))},setCharacterPosition:function(t,e){var n=t.state,r=t.commit,o=e.id,a=e.x,i=e.y,c=n.objects[o];if(c.freeMove)r("setPosition",{id:o,x:a,y:i});else{var s=Object(u["a"])();r("setPosition",{id:o,x:s.Base.characterPositions[m(a)],y:s.Base.BaseCharacterYPos+(c.close?s.Base.CloseUpYOffset:0)})}},shiftCharacterSlot:function(t,e){var n=t.state,r=t.commit,o=e.id,a=e.delta,i=n.objects[o],c=Object(u["a"])(),s=m(i.x),l=s+a;l<0&&(l=0),l>=c.Base.characterPositions.length&&(l=c.Base.characterPositions.length-1),r("setPosition",{id:o,x:c.Base.characterPositions[l],y:i.y})}};function j(t,e,n){return O.apply(this,arguments)}function O(){return O=Object(r["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i,c,s,u,l,d,f,h,b,p,m,v,g,j,O,y,w,C,S,R;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=e.state.objects[n],a=r.characters.find((function(t){return t.id===o.characterType})),a){t.next=6;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 6:if(i=k(o),c=a.styleGroups[o.styleGroupId],s=c.styles[i.styleId],u=s.poses[i.poseId],l=e.rootState.content.current.characters.find((function(t){return t.id===a.id})),l){t.next=15;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 15:d=l.styleGroups.findIndex((function(t){return t.id===c.id})),i.styleGroupId=-1===d?0:d,f=l.styleGroups[i.styleGroupId],h=JSON.stringify(s.components),b=f.styles.findIndex((function(t){return JSON.stringify(t.components)===h})),i.styleId=-1===b?0:b,p=f.styles[i.styleId],m=p.poses.findIndex((function(t){return t.id===u.id})),i.poseId=-1===m?0:m,v=p.poses[i.poseId],g={},t.t0=regeneratorRuntime.keys(v.positions);case 27:if((t.t1=t.t0()).done){t.next=35;break}if(j=t.t1.value,v.positions.hasOwnProperty(j)){t.next=31;break}return t.abrupt("continue",27);case 31:O=v.positions[j],u.positions[j]?(y=i.posePositions[j],y>=0&&y<O.length?g[j]=y:g[j]=0):g[j]=0,t.next=27;break;case 35:w=u.compatibleHeads[o.posePositions.headType],C=v.compatibleHeads.indexOf(w),-1===C?(i.posePositions.headType=0,i.posePositions.head=0):(C!==o.posePositions.headType&&(i.posePositions.headType=C),S=JSON.stringify(a.heads[w].variants[o.posePositions.head]),R=l.heads[w].variants.findIndex((function(t){return JSON.stringify(t)===S})),i.posePositions.head=-1===R?0:R),x(e.commit,o,i);case 39:case"end":return t.stop()}}),t)}))),O.apply(this,arguments)}function k(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:Object(i["a"])({},t.posePositions)}}function x(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log("Setting style of ".concat(e.id," to ").concat(n.styleId)),t("setCharStyle",{id:e.id,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,posePositions:n.posePositions})}function y(t,e,n,r){var o=k(e);r(o),n.styleGroups[o.styleGroupId]||(o.styleGroupId=0);var a=n.styleGroups[o.styleGroupId];a.styles[o.styleId]||(o.styleId=0);var i=a.styles[o.styleId];i.poses[o.poseId]||(o.poseId=0);var c=i.poses[o.poseId];for(var s in c.positions)c.positions[s]&&(c.positions[s][o.posePositions[s]]||(o.posePositions[s]=0));var u=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId],l=u.compatibleHeads[e.posePositions.headType||0],d=c.compatibleHeads.indexOf(l);d>=0?o.posePositions.headType=d:(o.posePositions.headType=0,o.posePositions.head=0),x(t,e,o)}},ba79:function(t,e,n){},c02d:function(t,e,n){"use strict";n("895e")},c185:function(t,e,n){"use strict";n("5ca1")},c4e5:function(t,e,n){"use strict";var r=n("7a23"),o={class:"toggle_box"};function a(t,e,n,a,i,c){return Object(r["p"])(),Object(r["g"])("div",o,[Object(r["D"])(Object(r["k"])("input",{id:t._.uid,type:"checkbox",ref:"checkbox","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.value=e})},null,8,["id"]),[[r["y"],t.value]]),Object(r["k"])("label",{for:t._.uid,class:"switch"},null,8,["for"]),Object(r["k"])("label",{for:t._.uid,class:"toggle_label"},Object(r["x"])(t.label),9,["for"])])}var i=Object(r["m"])({props:{label:String,modelValue:{type:Boolean,default:!1}},computed:{value:{get:function(){return this.modelValue},set:function(t){this.$emit("update:modelValue",t)}},checkbox:function(){return this.$refs.checkbox}}});n("85e7");i.render=a;e["a"]=i},c837:function(t,e,n){"use strict";function r(t,e,n){var r=e+n,o=t.length;return r<0&&(r+=o),r>=o&&(r-=o),r}n.d(e,"a",(function(){return r}))},caeb:function(t,e,n){"use strict";n.r(e),n.d(e,"TextBoxWidth",(function(){return i})),n.d(e,"TextBoxCorruptedWidth",(function(){return c})),n.d(e,"TextBoxHeight",(function(){return s})),n.d(e,"TextBoxKerning",(function(){return u})),n.d(e,"TextBoxLineHeight",(function(){return l})),n.d(e,"TextBoxCorruptedKerning",(function(){return d})),n.d(e,"TextBoxTextXOffset",(function(){return f})),n.d(e,"TextBoxTextYOffset",(function(){return h})),n.d(e,"TextBoxBottomSpacing",(function(){return b})),n.d(e,"TextBoxTextCorruptedXOffset",(function(){return p})),n.d(e,"TextBoxTextCorruptedYOffset",(function(){return m})),n.d(e,"NameboxHeight",(function(){return v})),n.d(e,"NameboxWidth",(function(){return g})),n.d(e,"NameboxXOffset",(function(){return j})),n.d(e,"NameboxTextYOffset",(function(){return O})),n.d(e,"ControlsYBottomOffset",(function(){return k})),n.d(e,"ControlsXHistoryOffset",(function(){return x})),n.d(e,"ControlsXSkipOffset",(function(){return y})),n.d(e,"ControlsXStuffOffset",(function(){return w})),n.d(e,"ArrowXRightOffset",(function(){return C})),n.d(e,"ArrowYBottomOffset",(function(){return S})),n.d(e,"GlowRX",(function(){return R})),n.d(e,"GlowRY",(function(){return P})),n.d(e,"BaseTextStyle",(function(){return T})),n.d(e,"NameboxTextStyle",(function(){return B})),n.d(e,"ControlsTextStyle",(function(){return I})),n.d(e,"ControlsTextDisabledStyle",(function(){return D})),n.d(e,"TextBoxStyle",(function(){return A})),n.d(e,"TextBoxCorruptedStyle",(function(){return H})),n.d(e,"TextBoxX",(function(){return _})),n.d(e,"TextBoxCorruptedX",(function(){return $})),n.d(e,"TextBoxTextX",(function(){return F})),n.d(e,"NameboxX",(function(){return N})),n.d(e,"NameboxTextX",(function(){return E})),n.d(e,"ControlsXHistory",(function(){return W})),n.d(e,"ControlsXSkip",(function(){return M})),n.d(e,"ControlsXStuff",(function(){return V})),n.d(e,"DefaultTextboxStyle",(function(){return L}));var r=n("5530"),o=n("3048"),a=n("7134"),i=1220,c=900,s=219,u=0,l=29,d=8,f=57,h=68,b=54,p=9,m=9,v=59,g=252,j=49,O=43,k=18,x=-189,y=-108,w=-57,C=46.125,S=39,R=639,P=87,T={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},B=Object(r["a"])(Object(r["a"])({},T),{},{fontName:"riffic",fontSize:36,strokeColor:a["nameboxStrokeDefaultColor"],strokeWidth:9,color:"white",letterSpacing:2}),I={align:"left",font:"24px aller",fill:{style:"#522"}},D=Object(r["a"])(Object(r["a"])({},I),{},{fill:{style:"#a66"}}),A={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},H={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},_=o["screenWidth"]/2-i/2,$=o["screenWidth"]/2-c/2,F=_+f,N=_+j,E=N+g/2,W=_+x,M=_+y,V=_+w,L="custom_plus"},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o={key:0},a={key:1,id:"app"},i={id:"container"},c=Object(r["k"])("div",{id:"modal-messages"},null,-1);function s(t,e,n,s,u,l){var d=Object(r["w"])("render"),f=Object(r["w"])("message-console"),h=Object(r["w"])("tool-box"),b=Object(r["w"])("single-box"),p=Object(r["w"])("modal-dialog"),m=Object(r["w"])("expression-builder");return Object(r["p"])(),Object(r["g"])(r["a"],null,[t.canvasTooSmall&&t.isSafari?(Object(r["p"])(),Object(r["g"])("div",o," Protrait mode is not supported by safari. Please turn the device sideways. ")):(Object(r["p"])(),Object(r["g"])("div",a,[Object(r["k"])("div",i,[Object(r["k"])(d,{ref:"render",canvasWidth:t.canvasWidth,canvasHeight:t.canvasHeight,preLoading:t.preLoading},null,8,["canvasWidth","canvasHeight","preLoading"])]),Object(r["k"])(f),Object(r["k"])(h,{onShowPrevRender:t.drawLastDownload,onDownload:e[1]||(e[1]=function(e){return t.$refs.render.download()}),onShowDialog:t.showDialog,onShowExpressionDialog:t.showExpressionDialog},null,8,["onShowPrevRender","onShowDialog","onShowExpressionDialog"]),(Object(r["p"])(),Object(r["g"])(r["b"],null,[t.dialogVisable?(Object(r["p"])(),Object(r["g"])(p,{key:0,ref:"dialog",onLeave:e[3]||(e[3]=function(e){return t.dialogVisable=!1})},{default:Object(r["C"])((function(){return[Object(r["k"])(b,{ref:"packDialog",onLeave:e[2]||(e[2]=function(e){return t.dialogVisable=!1})},null,512)]})),_:1},512)):Object(r["h"])("",!0)],1024)),t.expressionBuilderVisible?(Object(r["p"])(),Object(r["g"])(p,{key:0,ref:"dialog",onLeave:e[5]||(e[5]=function(e){return t.expressionBuilderVisible=!1})},{default:Object(r["C"])((function(){return[Object(r["k"])(m,{character:t.expressionBuilderCharacter,initHeadGroup:t.expressionBuilderHeadGroup,onLeave:e[4]||(e[4]=function(e){return t.expressionBuilderVisible=!1})},null,8,["character","initHeadGroup"])]})),_:1},512)):Object(r["h"])("",!0)])),c],64)}n("b64b"),n("d3b7"),n("07ac"),n("6062"),n("3ca3"),n("ddb0"),n("96cf");var u=n("1da1"),l=n("3835"),d={id:"toolbar"},f=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"add_box",-1),h=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"panorama",-1),b=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"view_module",-1),p=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"settings_applications",-1),m={id:"toolbar-end"},v=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"help",-1),g=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"extension",-1),j=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"flip_to_back",-1),O=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"photo_camera",-1);function k(t,e,n,o,a,i){var c=Object(r["w"])("settings-panel"),s=Object(r["w"])("content-packs-panel"),u=Object(r["w"])("backgrounds-panel"),l=Object(r["w"])("credits-panel"),k=Object(r["w"])("character-panel"),x=Object(r["w"])("sprite-panel"),y=Object(r["w"])("text-box-panel"),w=Object(r["w"])("choice-panel"),C=Object(r["w"])("panels-panel"),S=Object(r["w"])("notification-panel"),R=Object(r["w"])("poem-panel"),P=Object(r["w"])("add-panel");return Object(r["p"])(),Object(r["g"])("div",{id:"panels",class:{vertical:t.vertical}},[Object(r["k"])("div",d,[Object(r["k"])("button",{class:{active:"add"===t.panel},onClick:e[1]||(e[1]=function(e){return t.setPanel("add")}),title:"Add new objects to the scene","aria-label":"Add new objects to the scene"},[f],2),Object(r["k"])("button",{class:{active:"backgrounds"===t.panel},onClick:e[2]||(e[2]=function(e){return t.setPanel("backgrounds")}),"aria-label":"Change the current background",title:"Change the current background"},[h],2),Object(r["k"])("button",{class:{active:"panels"===t.panel},title:"Panels","aria-label":"Panels",onClick:e[3]||(e[3]=function(e){return t.setPanel("panels")})},[b],2),Object(r["k"])("button",{class:{active:"settings"===t.panel},title:"Settings","aria-label":"Settings",onClick:e[4]||(e[4]=function(e){return t.setPanel("settings")})},[p],2)]),"settings"===t.panel?(Object(r["p"])(),Object(r["g"])(c,{key:0})):"packs"===t.panel?(Object(r["p"])(),Object(r["g"])(s,{key:1})):"backgrounds"===t.panel?(Object(r["p"])(),Object(r["g"])(u,{key:2,onShowDialog:e[5]||(e[5]=function(e){return t.$emit("show-dialog",e)})})):"help_credits"===t.panel?(Object(r["p"])(),Object(r["g"])(l,{key:3})):"character"===t.panel?(Object(r["p"])(),Object(r["g"])(k,{key:4,onShowDialog:e[6]||(e[6]=function(e){return t.$emit("show-dialog",e)}),onShowExpressionDialog:e[7]||(e[7]=function(e){return t.$emit("show-expression-dialog",e)})})):"sprite"===t.panel?(Object(r["p"])(),Object(r["g"])(x,{key:5})):"textBox"===t.panel?(Object(r["p"])(),Object(r["g"])(y,{key:6})):"choice"===t.panel?(Object(r["p"])(),Object(r["g"])(w,{key:7})):"panels"===t.panel?(Object(r["p"])(),Object(r["g"])(C,{key:8})):"notification"===t.panel?(Object(r["p"])(),Object(r["g"])(S,{key:9})):"poem"===t.panel?(Object(r["p"])(),Object(r["g"])(R,{key:10})):(Object(r["p"])(),Object(r["g"])(P,{key:11,onShowDialog:e[8]||(e[8]=function(e){return t.$emit("show-dialog",e)})})),Object(r["k"])("div",m,[Object(r["k"])("button",{class:{active:"help_credits"===t.panel},onClick:e[9]||(e[9]=function(e){return t.setPanel("help_credits")}),title:"Help & Credits","aria-label":"Help & Credits"},[v],2),Object(r["k"])("button",{class:{active:"packs"===t.panel},onClick:e[10]||(e[10]=function(e){return t.$emit("show-dialog")}),title:"Content packs","aria-label":"Content packs"},[g],2),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(e){return t.$emit("show-prev-render")}),title:"Show last downloaded panel","aria-label":"Show last downloaded panel",disabled:!t.hasPrevRender},[j],8,["disabled"]),Object(r["k"])("button",{title:"Take a screenshot of the current scene","aria-label":"Take a screenshot of the current scene",onClick:e[12]||(e[12]=function(e){return t.$emit("download")})},[O])])],2)}var x=Object(r["F"])("data-v-82bbca46");Object(r["r"])("data-v-82bbca46");var y={class:"panel"},w=Object(r["k"])("h1",null,"Settings",-1),C={class:"modal-scroll-area"},S=Object(r["k"])("p",null," Do you want to allow DDDG to save settings on your device? ",-1),R=Object(r["k"])("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1),P=Object(r["k"])("p",null," You can revoke this permission at any time. ",-1),T=Object(r["j"])(" Our usual "),B=Object(r["j"])("privacy policy"),I=Object(r["j"])(" still applies. "),D={class:"modal-scroll-area"},A=Object(r["k"])("p",null," Do you want to deny DDDG from saving settings on your device? ",-1),H=Object(r["k"])("p",null," This will cause all your settings to reset when leaving the page. ",-1),_=Object(r["j"])(" Our usual "),$=Object(r["j"])("privacy policy"),F=Object(r["j"])(" still applies. "),N=Object(r["k"])("div",{class:"modal-scroll-area"},[Object(r["k"])("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1),E={key:0,disabled:""},W=Object(r["j"])(" Enter Classic Mode "),M=Object(r["j"])(" Enter DDLC Plus Mode "),V=Object(r["k"])("td",null,[Object(r["k"])("label",null,"Theme:")],-1),L=Object(r["k"])("option",{value:null},"System",-1),U=Object(r["k"])("option",{value:!1},"Light",-1),z=Object(r["k"])("option",{value:!0},"Dark",-1),G={key:4,class:"downloadTable"},q=Object(r["k"])("td",null,[Object(r["k"])("label",null,"Download folder:")],-1);Object(r["q"])();var Y=x((function(t,e,n,o,a,i){var c=Object(r["w"])("l"),s=Object(r["w"])("modal-dialog"),u=Object(r["w"])("toggle");return Object(r["p"])(),Object(r["g"])("div",y,[w,(Object(r["p"])(),Object(r["g"])(r["c"],{to:"#modal-messages"},[t.allowSavesModal?(Object(r["p"])(),Object(r["g"])(s,{key:0,options:["Allow","Deny"],onLeave:e[1]||(e[1]=function(e){return t.allowSaves("Deny")}),onOption:t.allowSaves,"no-base-size":""},{default:x((function(){return[Object(r["k"])("div",C,[S,R,P,Object(r["k"])("p",null,[T,Object(r["k"])(c,{to:"wiki://Privacy Statement"},{default:x((function(){return[B]})),_:1}),I])])]})),_:1},8,["onOption"])):Object(r["h"])("",!0),t.denySavesModal?(Object(r["p"])(),Object(r["g"])(s,{key:1,options:["Deny","Cancle"],onLeave:e[2]||(e[2]=function(e){return t.denySaves("Cancle")}),onOption:t.denySaves,"no-base-size":""},{default:x((function(){return[Object(r["k"])("div",D,[A,H,Object(r["k"])("p",null,[_,Object(r["k"])(c,{to:"wiki://Privacy Statement"},{default:x((function(){return[$]})),_:1}),F])])]})),_:1},8,["onOption"])):Object(r["h"])("",!0),t.showModeDialog?(Object(r["p"])(),Object(r["g"])(s,{key:2,options:[t.inPlusMode?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:e[3]||(e[3]=function(e){return t.showModeDialog=!1}),onOption:t.modeChange,"no-base-size":""},{default:x((function(){return[N]})),_:1},8,["options","onOption"])):Object(r["h"])("",!0)])),t.waitOnSaveChange?(Object(r["p"])(),Object(r["g"])("button",E," Applying... ")):!t.savesAllowed&&t.savesEnabledInEnv?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[4]||(e[4]=function(e){return t.allowSavesModal=!0})}," Allow saving options ")):t.savesAllowed&&t.savesEnabledInEnv?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[5]||(e[5]=function(e){return t.denySavesModal=!0})}," Deny saving options ")):Object(r["h"])("",!0),Object(r["k"])("button",{onClick:e[6]||(e[6]=function(e){return t.showModeDialog=!0})},[t.inPlusMode?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[W],64)):(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[M],64))]),t.lqAllowed?(Object(r["p"])(),Object(r["g"])(u,{key:3,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:t.lqRendering,"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.lqRendering=e})},null,8,["modelValue"])):Object(r["h"])("",!0),Object(r["k"])(u,{label:"NSFW Mode?",modelValue:t.nsfw,"onUpdate:modelValue":e[8]||(e[8]=function(e){return t.nsfw=e})},null,8,["modelValue"]),Object(r["k"])(u,{label:"Enlarge talking objects? (Default value)",modelValue:t.defaultCharacterTalkingZoom,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.defaultCharacterTalkingZoom=e})},null,8,["modelValue"]),Object(r["k"])("table",null,[Object(r["k"])("tr",null,[V,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.theme=e})},[L,U,z],512),[[r["z"],t.theme]])])])]),t.showDownloadFolder?(Object(r["p"])(),Object(r["g"])("table",G,[Object(r["k"])("tr",null,[q,Object(r["k"])("td",null,Object(r["x"])(t.downloadFolder),1),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[11]||(e[11]=function(){return t.setDownloadFolder&&t.setDownloadFolder.apply(t,arguments)})}," Set "),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(){return t.openDownloadFolder&&t.openDownloadFolder.apply(t,arguments)})}," Open ")])])])):Object(r["h"])("",!0)])})),X=(n("99af"),n("c4e5")),K=n("aacd"),J={mixins:[K["a"]],computed:{vertical:function(){return this.$store.state.ui.vertical}},mounted:function(){var t=this;this.updateVertical(),this.$el.addEventListener("wheel",(function(e){t.vertical||t.verticalScrollRedirect(e)}),{passive:!0})},methods:{updateVertical:function(){this.$el&&(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}},watch:{vertical:function(){this.updateVertical()}}},Z=n("032b"),Q=Object(r["F"])("data-v-64aeb4c5");Object(r["r"])("data-v-64aeb4c5");var tt={key:0,id:"submit-options"};Object(r["q"])();var et=Q((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:"dialog-wrapper",onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},[Object(r["k"])("dialog",{open:"",class:{"base-size":!t.noBaseSize},onClick:e[1]||(e[1]=Object(r["E"])((function(){}),["stop"]))},[Object(r["v"])(t.$slots,"default",{},void 0,!0),t.options.length>0?(Object(r["p"])(),Object(r["g"])("div",tt,[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.options,(function(e){return Object(r["p"])(),Object(r["g"])("button",{key:e,class:"option",onClick:function(n){return t.$emit("option",e)}},Object(r["x"])(e),9,["onClick"])})),128))])):Object(r["h"])("",!0)],2)])})),nt=Object(r["m"])({props:{noBaseSize:Boolean,options:{type:Array,default:[]}}});n("c02d");nt.render=et,nt.__scopeId="data-v-64aeb4c5";var rt=nt,ot=n("39b7"),at=(n("caad"),n("b0c0"),n("ac1f"),n("2532"),n("1276"),n("0c0f"));function it(t,e){return ct.apply(this,arguments)}function ct(){return ct=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n();case 3:t.next=9;break;case 5:t.prev=5,t.t0=t["catch"](0),console.error("Error in promise",e,t.t0),at["h"].fire(new at["d"]("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+e+'", '+st(t.t0)));case 9:case"end":return t.stop()}}),t,null,[[0,5]])}))),ct.apply(this,arguments)}function st(t){if(t instanceof Error){if(t.stack){var e=t.stack.split("\n");return e[0].includes(t.name)&&e[0].includes(t.message)?e[0]+"\n<br />"+e[1]:t.name+": "+t.message+"\n<br />"+e[0]}return t.name+": "+t.message}return t instanceof Object?JSON.stringify(t):""+t}var ut=Object(r["m"])({mixins:[J],components:{Toggle:X["a"],ModalDialog:rt,L:ot["a"]},data:function(){return{allowSavesModal:!1,denySavesModal:!1,waitOnSaveChange:!1,showModeDialog:!1}},computed:{savesAllowed:{get:function(){return Z["a"].savingEnabled},set:function(t){this.waitOnSaveChange=!0,Z["a"].savingEnabled=t,this.saveSettings()}},inPlusMode:function(){return"ddlc_plus"===Z["a"].gameMode},savesEnabledInEnv:function(){return Z["a"].supports.optionalSaving},lqAllowed:function(){return Z["a"].supports.lq},lqRendering:{get:function(){return this.$store.state.ui.lqRendering},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setLqRendering",t);case 2:case"end":return n.stop()}}),n)})))),this.saveSettings()}},nsfw:{get:function(){return!!this.$store.state.ui.nsfw},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setNsfw",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}},defaultCharacterTalkingZoom:{get:function(){return!!this.$store.state.ui.defaultCharacterTalkingZoom},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setDefaultCharacterTalkingZoom",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}},theme:{get:function(){return this.$store.state.ui.useDarkTheme},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setDarkTheme",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}},showDownloadFolder:function(){return Z["a"].supports.setDownloadFolder},downloadFolder:function(){return Z["a"].state.downloadLocation}},watch:{savesAllowed:function(){this.waitOnSaveChange=!1}},methods:{allowSaves:function(t){this.allowSavesModal=!1,"Allow"===t&&(this.savesAllowed=!0)},denySaves:function(t){this.denySavesModal=!1,"Deny"===t&&(this.savesAllowed=!1)},modeChange:function(t){it("changing modes",Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n="".concat(location.protocol,"//").concat(location.host).concat(location.pathname),"Enter Classic Mode"!==t){e.next=7;break}return e.next=4,Z["a"].saveGameMode("ddlc");case 4:location.href="".concat(n,"?mode=ddlc"),e.next=11;break;case 7:if("Enter Plus mode"!==t){e.next=11;break}return e.next=10,Z["a"].saveGameMode("ddlc_plus");case 10:location.href="".concat(n,"?mode=ddlc_plus");case 11:case"end":return e.stop()}}),e)}))))},saveSettings:function(){var t;Z["a"].saveSettings({lq:this.$store.state.ui.lqRendering,nsfw:this.$store.state.ui.nsfw,darkMode:null!==(t=this.$store.state.ui.useDarkTheme)&&void 0!==t?t:void 0,defaultCharacterTalkingZoom:this.$store.state.ui.defaultCharacterTalkingZoom})},setDownloadFolder:function(){Z["a"].updateDownloadFolder()},openDownloadFolder:function(){Z["a"].openFolder("downloads")}}});n("4e48");ut.render=Y,ut.__scopeId="data-v-82bbca46";var lt=ut,dt=Object(r["F"])("data-v-32ed20c5");Object(r["r"])("data-v-32ed20c5");var ft=Object(r["j"])("Drop here to add as a new sprite"),ht=Object(r["k"])("h1",null,"Add",-1),bt=Object(r["j"])(" Char­acters "),pt=Object(r["j"])(" Sprites "),mt=Object(r["j"])(" UI "),vt=Object(r["j"])(" Search in content packs "),gt=Object(r["j"])(" Upload new sprite "),jt=Object(r["j"])(" New sprite from URL "),Ot=Object(r["j"])(" Search in content packs "),kt=Object(r["j"])(" Open sprites folder ");Object(r["q"])();var xt=dt((function(t,e,n,o,a,i){var c=Object(r["w"])("drop-target"),s=Object(r["w"])("d-button");return void 0!==t.isWebPSupported?(Object(r["p"])(),Object(r["g"])("div",{key:0,class:"panel",onDragenter:e[14]||(e[14]=function(){return t.showDropTarget&&t.showDropTarget.apply(t,arguments)}),onMouseleave:e[15]||(e[15]=function(){return t.hideDropTarget&&t.hideDropTarget.apply(t,arguments)})},[Object(r["k"])(c,{ref:"spriteDt",class:"drop-target",onDrop:t.addCustomSpriteFile},{default:dt((function(){return[ft]})),_:1},8,["onDrop"]),ht,Object(r["k"])("div",{class:{"group-selector":!0,vertical:t.vertical}},[Object(r["k"])(s,{class:{active:"characters"===t.group},"icon-pos":"top",icon:"emoji_people",onClick:e[1]||(e[1]=function(e){return t.group="characters"})},{default:dt((function(){return[bt]})),_:1},8,["class"]),Object(r["k"])(s,{class:{active:"sprites"===t.group},"icon-pos":"top",icon:"change_history",onClick:e[2]||(e[2]=function(e){return t.group="sprites"})},{default:dt((function(){return[pt]})),_:1},8,["class"]),Object(r["k"])(s,{class:{active:"ui"===t.group},"icon-pos":"top",icon:"view_quilt",onClick:e[3]||(e[3]=function(e){return t.group="ui"})},{default:dt((function(){return[mt]})),_:1},8,["class"])],2),Object(r["k"])("div",{class:{"item-grid":!0,vertical:t.vertical}},["characters"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.characters,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:"character",key:e.id,title:e.label,onClick:function(n){return t.onChosen(e.id.toLowerCase())}},[Object(r["k"])("img",{src:t.assetPath(e),alt:e.label},null,8,["src","alt"])],8,["title","onClick"])})),128)),Object(r["k"])(s,{class:"custom-sprite",icon:"extension",onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Characters")})},{default:dt((function(){return[vt]})),_:1})],64)):Object(r["h"])("",!0),"sprites"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.sprites,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:"sprite",key:e.label,title:e.label,style:{background:t.assetSpriteBackground(e)},onClick:function(n){return t.addSpriteToScene(e)}},Object(r["x"])(e.label),13,["title","onClick"])})),128)),Object(r["k"])(s,{class:"custom-sprite",icon:"publish",onClick:e[6]||(e[6]=function(e){return t.$refs.spriteUpload.click()})},{default:dt((function(){return[gt,Object(r["k"])("input",{type:"file",ref:"spriteUpload",onChange:e[5]||(e[5]=function(){return t.onSpriteFileUpload&&t.onSpriteFileUpload.apply(t,arguments)})},null,544)]})),_:1}),Object(r["k"])(s,{icon:"insert_link",onClick:t.uploadFromURL},{default:dt((function(){return[jt]})),_:1},8,["onClick"]),Object(r["k"])(s,{icon:"extension",onClick:e[7]||(e[7]=function(e){return t.$emit("show-dialog","type: Sprites")})},{default:dt((function(){return[Ot]})),_:1}),t.showSpritesFolder?(Object(r["p"])(),Object(r["g"])(s,{key:0,icon:"folder",onClick:t.openSpritesFolder},{default:dt((function(){return[kt]})),_:1},8,["onClick"])):Object(r["h"])("",!0)],64)):Object(r["h"])("",!0),"ui"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("button",{onClick:e[8]||(e[8]=function(){return t.addTextBox&&t.addTextBox.apply(t,arguments)})},"Textbox"),Object(r["k"])("button",{onClick:e[9]||(e[9]=function(){return t.addPoem&&t.addPoem.apply(t,arguments)})},"Poem"),Object(r["k"])("button",{onClick:e[10]||(e[10]=function(){return t.addDialog&&t.addDialog.apply(t,arguments)})},"Notification"),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(){return t.addChoice&&t.addChoice.apply(t,arguments)})},"Choice"),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(){return t.addConsole&&t.addConsole.apply(t,arguments)})},"Console")],64)):Object(r["h"])("",!0),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(){return t.paste&&t.paste.apply(t,arguments)}),disabled:!t.hasClipboardContent}," Paste ",8,["disabled"])],2)],32)):Object(r["h"])("",!0)})),yt=(n("7db0"),n("a630"),n("a15b"),n("d81d"),n("fb6a"),n("466d"),n("2b3d"),n("b85c")),wt=n("5947"),Ct=n("dc61"),St=Object(r["F"])("data-v-465f5994");Object(r["r"])("data-v-465f5994");var Rt={class:"material-icons","aria-hidden":"true"},Pt={class:"content"};Object(r["q"])();var Tt=St((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("button",{class:[t.iconPos],disabled:t.disabled},[Object(r["k"])("div",Rt,Object(r["x"])(t.icon),1),Object(r["k"])("div",Pt,[Object(r["v"])(t.$slots,"default",{},void 0,!0)])],10,["disabled"])})),Bt=Object(r["m"])({props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1}}});n("4ad0");Bt.render=Tt,Bt.__scopeId="data-v-465f5994";var It=Bt,Dt={packId:"dddg.buildin.uploadedSprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},At=Object(r["m"])({mixins:[J],components:{DropTarget:Ct["a"],DButton:It},data:function(){return{isWebPSupported:null,customAssetCount:0,group:"characters"}},computed:{characters:function(){return this.$store.state.content.current.characters},sprites:function(){return this.$store.state.content.current.sprites},hasClipboardContent:function(){return!!this.$store.state.ui.clipboard},showSpritesFolder:function(){return Z["a"].supports.openableFolders.has("sprites")}},methods:{assetSpriteBackground:function(t){return t.variants[0].map((function(t){return"url('".concat(t.lq,"')")})).join(",")},assetPath:function(t){return t.chibi?Z["a"].supports.lq?t.chibi.lq:t.chibi.hq:""},showDropTarget:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link","sprites"===this.group&&this.$refs.spriteDt.show()))},hideDropTarget:function(){"sprites"===this.group&&this.$refs.spriteDt.hide()},onSpriteFileUpload:function(){var t=this.$refs.spriteUpload;if(t.files){var e,n=Object(yt["a"])(t.files);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.addCustomSpriteFile(r)}}catch(o){n.e(o)}finally{n.f()}}},uploadFromURL:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=prompt("Enter the URL of the image"),n){e.next=3;break}return e.abrupt("return");case 3:r=n.split("/").slice(-1)[0],t.addNewCustomSprite(r,n);case 5:case"end":return e.stop()}}),e)})))()},addSpriteToScene:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.dispatch("objects/createSprite",{assets:t.variants[0]});case 2:case"end":return n.stop()}}),n)}))));case 1:case"end":return n.stop()}}),n)})))()},addTextBox:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createTextBox",{});case 1:case"end":return e.stop()}}),e)}))))},addChoice:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createChoice",{});case 1:case"end":return e.stop()}}),e)}))))},addDialog:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createNotification",{});case 1:case"end":return e.stop()}}),e)}))))},addPoem:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createPoem",{});case 1:case"end":return e.stop()}}),e)}))))},addConsole:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createConsole",{});case 1:case"end":return e.stop()}}),e)}))))},paste:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/pasteObjectFromClipboard",{});case 1:case"end":return e.stop()}}),e)}))))},onChosen:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.dispatch("objects/createCharacters",{characterType:t});case 1:case"end":return n.stop()}}),n)}))))},addCustomSpriteFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomSprite(t.name,e)},addNewCustomSprite:function(t,e){var n=this;Dt.sprites.push({id:e,label:t,variants:[[e]],defaultScale:[1,1],hd:null}),this.vuexHistory.transaction((function(){n.$store.dispatch("content/replaceContentPack",{contentPack:Dt,processed:!1})}))},openSpritesFolder:function(){Z["a"].openFolder("sprites")}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(wt["e"])();case 2:t.isWebPSupported=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("f3c1");At.render=xt,At.__scopeId="data-v-32ed20c5";var Ht=At,_t=Object(r["F"])("data-v-47403597");Object(r["r"])("data-v-47403597");var $t={key:0},Ft={class:"arrow-col"},Nt={class:"arrow-col"},Et={key:1},Wt={class:"arrow-col"},Mt={class:"arrow-col"},Vt={class:"arrow-col"},Lt={class:"arrow-col"};Object(r["q"])();var Ut=_t((function(t,e,n,o,a,i){var c=Object(r["w"])("parts"),s=Object(r["w"])("d-fieldset"),u=Object(r["w"])("toggle"),l=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(l,{object:t.object,title:t.label,showAltPanel:t.panelForParts},{"alt-panel":_t((function(){return[t.panelForParts?(Object(r["p"])(),Object(r["g"])(c,{key:0,character:t.object,part:t.panelForParts,onLeave:e[1]||(e[1]=function(e){return t.panelForParts=null}),onShowDialog:e[2]||(e[2]=function(e){return t.$emit("show-dialog",e)}),onShowExpressionDialog:e[3]||(e[3]=function(e){return t.$emit("show-expression-dialog",e)})},null,8,["character","part"])):Object(r["h"])("",!0)]})),default:_t((function(){return[t.hasMultiplePoses||t.parts.length>0?(Object(r["p"])(),Object(r["g"])(s,{key:0,class:"pose-list",title:"Pose:"},{default:_t((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tbody",null,[t.hasMultipleStyles?(Object(r["p"])(),Object(r["g"])("tr",$t,[Object(r["k"])("td",Ft,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return t.seekStyle(-1)})},"<")]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:e[5]||(e[5]=function(e){return t.panelForParts="style"})}," Style ")]),Object(r["k"])("td",Nt,[Object(r["k"])("button",{onClick:e[6]||(e[6]=function(e){return t.seekStyle(1)})},">")])])):Object(r["h"])("",!0),t.hasMultiplePoses?(Object(r["p"])(),Object(r["g"])("tr",Et,[Object(r["k"])("td",Wt,[Object(r["k"])("button",{onClick:e[7]||(e[7]=function(e){return t.seekPose(-1)})},"<")]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:e[8]||(e[8]=function(e){return t.panelForParts="pose"})}," Pose ")]),Object(r["k"])("td",Mt,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(e){return t.seekPose(1)})},">")])])):Object(r["h"])("",!0),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.parts,(function(e){return Object(r["p"])(),Object(r["g"])("tr",{key:e},[Object(r["k"])("td",Vt,[Object(r["k"])("button",{onClick:function(n){return t.seekPart(e,-1)}},"<",8,["onClick"])]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:function(n){return t.panelForParts=e}},Object(r["x"])(t.captialize(e)),9,["onClick"])]),Object(r["k"])("td",Lt,[Object(r["k"])("button",{onClick:function(n){return t.seekPart(e,1)}},">",8,["onClick"])])])})),128))])])]})),_:1})):Object(r["h"])("",!0)]})),options:_t((function(){return[Object(r["k"])(u,{modelValue:t.closeUp,"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.closeUp=e}),label:"Close up?"},null,8,["modelValue"])]})),_:1},8,["object","title","showAltPanel"])})),zt=n("ba37"),Gt=n("b3d7"),qt=Object(r["F"])("data-v-47f2e1e8");Object(r["r"])("data-v-47f2e1e8");var Yt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Xt=Object(r["k"])("span",{class:"text-block"},"Create new expressions",-1),Kt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Jt=Object(r["k"])("span",{class:"text-block"},"Search in content packs",-1),Zt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Qt=Object(r["k"])("span",null,"Search in content packs",-1),te=Object(r["k"])("i",{class:"material-icons"},"extension",-1),ee=Object(r["k"])("span",null,"Search in content packs",-1);Object(r["q"])();var ne=qt((function(t,e,n,o,a,i){var c=Object(r["w"])("part-button"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{"no-wraping":""},{default:qt((function(){return[Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"Back"),"head"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:0,onClick:e[2]||(e[2]=function(e){return t.$emit("show-expression-dialog",{character:t.character.characterType})}),class:"icon-button"},[Yt,Xt])):Object(r["h"])("",!0),"head"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(e){return t.$emit("show-dialog","type: Expressions character: "+t.charData.label)}),class:"icon-button"},[Kt,Jt])):"style"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Styles character: "+t.charData.label)}),class:"icon-button"},[Zt,Qt])):(Object(r["p"])(),Object(r["g"])("button",{key:3,onClick:e[5]||(e[5]=function(e){return t.$emit("show-dialog","type: Poses character: "+t.charData.label)}),class:"icon-button"},[te,ee])),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.parts,(function(e,n){return Object(r["p"])(),Object(r["g"])(c,{key:n,value:n,part:e,onClick:function(e){t.choose(n),t.$emit("leave")}},null,8,["value","part","onClick"])})),128)),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.styleComponents,(function(e){return Object(r["p"])(),Object(r["g"])(u,{key:e.name,title:e.label},{default:qt((function(){return[Object(r["k"])(s,{noWraping:""},{default:qt((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(e.buttons,(function(n,o){return Object(r["p"])(),Object(r["g"])(c,{size:130,key:o,value:o,part:n,onClick:function(n){return t.choose_component(e.name,o)}},null,8,["value","part","onClick"])})),128))]})),_:2},1024)]})),_:2},1032,["title"])})),128))]})),_:1})})),re=(n("4de4"),n("c740"),n("c975"),n("a434"),Object(r["F"])("data-v-7d67a652")),oe=re((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:{part:!0,active:!1},style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("click")})},null,4)})),ae=(n("a9e3"),n("5319"),960),ie=Object(r["m"])({props:{part:{required:!0},value:{required:!0},size:{type:Number,default:150}},data:function(){return{lookups:[],loaded:!1}},computed:{scaleX:function(){return this.size/this.part.size[0]},scaleY:function(){return this.size/this.part.size[1]},backgroundSize:function(){return"".concat(Math.floor(ae*this.scaleX),"px ").concat(Math.floor(ae*this.scaleY),"px")},backgroundPosition:function(){return"".concat(Math.floor(this.part.offset[0]*-this.scaleX),"px ")+"".concat(Math.floor(this.part.offset[1]*-this.scaleY),"px")},style:function(){var t=this.lookups.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src.replace("'","\\'"),"')")}));return{backgroundImage:t.join(","),height:this.size+"px",width:this.size+"px",backgroundPosition:this.backgroundPosition,backgroundSize:this.backgroundSize}}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.part.images.map((function(t){return"string"===typeof t.asset?Object(wt["b"])(t.asset,!1):Object(wt["a"])(t.asset,!1)})));case 2:t.lookups=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("ddde");ie.render=oe,ie.__scopeId="data-v-7d67a652";var ce=ie,se=n("ade3"),ue=n("5530"),le=Object(r["m"])({mixins:[K["a"]],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection:function(){return"global"===this.direction?this.$store.state.ui.vertical?"vertical":"horizontal":"inverted"===this.direction?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render:function(){var t=this.noWraping?"no-wraping":"wraping",e={},n=Object(r["n"])("div",Object(ue["a"])(Object(ue["a"])({},e),{},{class:["d-flow",this.finalDirection,t],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize){var o=this.maxSize instanceof Array?this.maxSize["horizontal"===this.finalDirection?0:1]:this.maxSize;return Object(r["n"])("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:Object(se["a"])({},"horizontal"===this.finalDirection?"maxWidth":"maxHeight",o)},[n])}return n},mounted:function(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}});n("9e3d");le.__scopeId="data-v-64adfc9c";var de=le,fe=Object(r["m"])({components:{PartButton:ce,DFieldset:Gt["a"],DFlow:de},props:{character:{type:Object,required:!0},part:{required:!0,type:String}},data:function(){return{isWebPSupported:null,stylePriorities:[]}},computed:{vertical:function(){return this.$store.state.ui.vertical},styleComponents:function(){if("style"!==this.part)return[];var t=this.charData.styleGroups[this.character.styleGroupId];return t.styleComponents.map((function(e){var n={};for(var r in e.variants)if(e.variants.hasOwnProperty(r)){var o=e.variants[r];n[r]={size:t.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:o}]}}return{label:e.label,name:e.id,buttons:n}}))},parts:function(){var t,e,n,r={},o=this.charData,a=Object(zt["h"])(o,this.character);switch(this.part){case"head":for(var i=0;i<a.compatibleHeads.length;++i)for(var c=a.compatibleHeads[i],s=o.heads[c],u=0;u<s.variants.length;++u){var l=s.variants[u];r["".concat(i,"_").concat(u)]={size:s.previewSize,offset:s.previewOffset,images:l.map((function(t){return{asset:t,offset:[0,0]}}))}}return r;case"pose":for(var d=o.styleGroups[this.character.styleGroupId].styles[this.character.styleId],f=0;f<d.poses.length;++f){var h=d.poses[f];r[f]=this.generatePosePreview(h)}return r;case"style":var b,p=Object(yt["a"])(o.styleGroups);try{for(p.s();!(b=p.n()).done;){var m=b.value;r[m.id]=this.generatePosePreview(m.styles[0].poses[0])}}catch(j){p.e(j)}finally{p.f()}return r;default:t=a.positions[this.part],n=a.previewSize,e=a.previewOffset;break}for(var v=0;v<t.length;++v){var g=t[v];r[v]={images:g.map((function(t){return{offset:[0,0],asset:t}})),size:n,offset:e}}return r},charData:function(){return Object(zt["e"])(this.$store,this.character)}},methods:{updateStyleData:function(){var t=this.charData.styleGroups[this.character.styleGroupId].styles[this.character.styleId];this.stylePriorities=Object.keys(t.components).map((function(e){return[e,t.components[e]]}))},generatePosePreview:function(t){var e,n=this.charData,r=n.heads[t.compatibleHeads[0]],o=r?r.variants[0]:null,a=[],i=Object(yt["a"])(t.renderCommands);try{for(i.s();!(e=i.n()).done;){var c=e.value;switch(c.type){case"pose-part":var s=t.positions[c.part];if(!s||0===s.length)break;a=a.concat(s[0]);break;case"head":o&&(a=a.concat(o));break;case"image":a=a.concat(c.images);break}}}catch(u){i.e(u)}finally{i.f()}return{images:a.map((function(t){return{asset:t,offset:[0,0]}})),size:t.previewSize,offset:t.previewOffset}},updatePose:function(t){var e=this;void 0===t&&(t=this.character.styleGroupId);var n,r=this.charData,o=r.styleGroups[t],a=o.styles,i=Object(yt["a"])(this.stylePriorities);try{var c=function(){var t=n.value,e=a.filter((function(e){return e.components[t[0]]===t[1]}));e.length>0&&(a=e)};for(i.s();!(n=i.n()).done;)c()}catch(s){i.e(s)}finally{i.f()}this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setCharStyle",{id:e.character.id,styleGroupId:t,styleId:o.styles.indexOf(a[0])})}))},choose:function(t){if("style"===this.part)this.updatePose(this.charData.styleGroups.findIndex((function(e){return e.id===t})));else if("head"===this.part){var e=t.split("_",2).map((function(t){return parseInt(t,10)})),n=Object(l["a"])(e,2),r=n[0],o=n[1];this.$store.commit("objects/setPosePosition",{id:this.character.id,posePositions:{headType:r,head:o}})}else this.setPart(this.part,parseInt(t,10))},choose_component:function(t,e){var n=this.stylePriorities.findIndex((function(e){return e[0]===t}));this.stylePriorities.splice(n,1),this.stylePriorities.unshift([t,e]),this.updatePose()},setPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/setPart",{id:n.character.id,part:t,val:e})}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateStyleData(),e.next=3,Object(wt["e"])();case 3:t.isWebPSupported=e.sent;case 4:case"end":return e.stop()}}),e)})))()},watch:{character:function(){this.updateStyleData()}}});n("1c59");fe.render=ne,fe.__scopeId="data-v-47f2e1e8";var he=fe;function be(){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object[t]},set:function(r){var o=this;this.vuexHistory.transaction((function(){o.$store[n?"dispatch":"commit"](e,Object(se["a"])({id:o.object.id},t,r))}))}}}}var pe=Object(r["F"])("data-v-16d40063");Object(r["r"])("data-v-16d40063");var me={class:"panel"},ve=Object(r["k"])("span",{class:"icon material-icons"},"edit",-1),ge=Object(r["k"])("p",{class:"modal-text"}," Enter the new name ",-1),je={class:"modal-text"},Oe={class:"input-table"},ke=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"rotation"},"Rotation: °")],-1),xe={key:0},ye=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"zoom"},"Zoom: ")],-1),we={key:0},Ce=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"textbox_color"},"Color:")],-1),Se=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"namebox_width"},"Namebox width:")],-1);Object(r["q"])();var Re=pe((function(t,e,n,o,a,i){var c=Object(r["w"])("modal-dialog"),s=Object(r["w"])("text-editor"),u=Object(r["w"])("color"),l=Object(r["w"])("image-options"),d=Object(r["w"])("position-and-size"),f=Object(r["w"])("layers"),h=Object(r["w"])("toggle"),b=Object(r["w"])("d-fieldset"),p=Object(r["w"])("delete");return Object(r["p"])(),Object(r["g"])("div",me,[Object(r["k"])("h1",{style:{fontStyle:t.hasLabel?"italic":"normal"},onClick:e[1]||(e[1]=function(){return t.enableNameEdit&&t.enableNameEdit.apply(t,arguments)})},[Object(r["j"])(Object(r["x"])(t.heading)+" ",1),ve],4),(Object(r["p"])(),Object(r["g"])(r["c"],{to:"#modal-messages"},[t.showRename?(Object(r["p"])(),Object(r["g"])(c,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:t.renameOption,onLeave:e[3]||(e[3]=function(e){return t.renameOption("Cancel")})},{default:pe((function(){return[ge,Object(r["k"])("p",je,[Object(r["D"])(Object(r["k"])("input",{"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.modalNameInput=e}),style:{width:"100%"}},null,512),[[r["A"],t.modalNameInput]])])]})),_:1},8,["onOption"])):Object(r["h"])("",!0)])),t.textHandler?(Object(r["p"])(),Object(r["g"])(s,{key:0,title:t.textHandler.title,modelValue:t.textHandler.get(),"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.textHandler.set(e)}),onLeave:e[5]||(e[5]=function(e){return t.textHandler.leave()})},null,8,["title","modelValue"])):t.finalColorHandler?(Object(r["p"])(),Object(r["g"])(u,{key:1,title:t.finalColorHandler.title,modelValue:t.finalColorHandler.get(),"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.finalColorHandler.set(e)}),onLeave:e[7]||(e[7]=function(e){return t.finalColorHandler.leave()})},null,8,["title","modelValue"])):t.imageOptionsOpen?(Object(r["p"])(),Object(r["g"])(l,{key:2,type:"object",id:t.object.id,onLeave:e[8]||(e[8]=function(e){return t.imageOptionsOpen=!1})},null,8,["id"])):t.showAltPanel?Object(r["v"])(t.$slots,"alt-panel",{key:3},void 0,!0):(Object(r["p"])(),Object(r["g"])(r["a"],{key:4},[Object(r["v"])(t.$slots,"default",{},void 0,!0),Object(r["k"])(d,{obj:t.object},null,8,["obj"]),Object(r["k"])(f,{object:t.object},null,8,["object"]),Object(r["k"])(h,{modelValue:t.flip,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["k"])("table",Oe,[Object(r["k"])("tr",null,[ke,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"rotation",class:"smol",type:"number","onUpdate:modelValue":e[10]||(e[10]=function(e){return t.rotation=e}),onKeydown:e[11]||(e[11]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.rotation]])])]),"character"===t.object.type||"sprite"===t.object.type?(Object(r["p"])(),Object(r["g"])("tr",xe,[ye,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"zoom",type:"number",class:"smol",step:"1",min:"0","onUpdate:modelValue":e[12]||(e[12]=function(e){return t.zoom=e}),onKeydown:e[13]||(e[13]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.zoom]])])])):Object(r["h"])("",!0)]),Object(r["v"])(t.$slots,"options",{},void 0,!0),t.hasLabel?(Object(r["p"])(),Object(r["g"])(b,{key:0,title:"Textbox settings"},{default:pe((function(){return["character"===t.object.type||"sprite"===t.object.type?(Object(r["p"])(),Object(r["g"])(h,{key:0,label:"Enlarge when talking",modelValue:t.enlargeWhenTalking,"onUpdate:modelValue":e[14]||(e[14]=function(e){return t.enlargeWhenTalking=e})},null,8,["modelValue"])):Object(r["h"])("",!0),Object(r["k"])(h,{label:"Use custom textbox color",modelValue:t.useCustomTextboxColor,"onUpdate:modelValue":e[15]||(e[15]=function(e){return t.useCustomTextboxColor=e})},null,8,["modelValue"]),Object(r["k"])("table",null,[t.useCustomTextboxColor?(Object(r["p"])(),Object(r["g"])("tr",we,[Ce,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"textbox_color",class:"color-button",style:{background:t.object.textboxColor},onClick:e[16]||(e[16]=function(){return t.selectTextboxColor&&t.selectTextboxColor.apply(t,arguments)})},null,4)])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[Se,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"namebox_width",type:"number",placeholder:t.defaultNameboxWidth,"onUpdate:modelValue":e[17]||(e[17]=function(e){return t.nameboxWidth=e})},null,8,["placeholder"]),[[r["A"],t.nameboxWidth,void 0,{lazy:!0}]])])])])]})),_:1})):Object(r["h"])("",!0),Object(r["k"])("button",{onClick:e[18]||(e[18]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["k"])("button",{onClick:e[19]||(e[19]=function(){return t.copy&&t.copy.apply(t,arguments)})},"Copy"),Object(r["k"])(p,{obj:t.object},null,8,["obj"])],64))])})),Pe=(n("498a"),Object(r["F"])("data-v-3e1f568a"));Object(r["r"])("data-v-3e1f568a");var Te={colspan:"2"},Be={key:0},Ie={colspan:"2"},De={class:"arrow-col"},Ae={class:"arrow-col"},He=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_x"},"X:")],-1),_e=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_y"},"Y:")],-1),$e=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_w"},"Width:")],-1),Fe=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_h"},"Height:")],-1),Ne={colspan:"2"};Object(r["q"])();var Ee=Pe((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{title:"Position"+(t.allowSize?"/Size":"")},{default:Pe((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",Te,[t.allowStepMove?(Object(r["p"])(),Object(r["g"])(c,{key:0,modelValue:t.freeMove,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.freeMove=e}),label:"Move freely?"},null,8,["modelValue"])):Object(r["h"])("",!0)])]),t.allowStepMove&&!t.freeMove?(Object(r["p"])(),Object(r["g"])("tr",Be,[Object(r["k"])("td",Ie,[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",De,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return--t.pos}),disabled:t.isFirstPos},"<",8,["disabled"])]),Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"current_talking","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.pos=e})},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.positionNames,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{key:e,value:e},Object(r["x"])(t),9,["value"])})),128))],512),[[r["z"],t.pos,void 0,{number:!0}]])]),Object(r["k"])("td",Ae,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return++t.pos}),disabled:t.isLastPos},">",8,["disabled"])])])])])])):(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])("tr",null,[He,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_x",type:"number","onUpdate:modelValue":e[5]||(e[5]=function(e){return t.x=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.x,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[_e,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_y",type:"number","onUpdate:modelValue":e[7]||(e[7]=function(e){return t.y=e}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.y,void 0,{number:!0}]])])])],64)),t.allowSize?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[$e,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":e[9]||(e[9]=function(e){return t.width=e}),onKeydown:e[10]||(e[10]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.width,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Fe,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":e[11]||(e[11]=function(e){return t.height=e}),onKeydown:e[12]||(e[12]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.height,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",Ne,[Object(r["k"])(c,{modelValue:t.preserveRatio,"onUpdate:modelValue":e[13]||(e[13]=function(e){return t.preserveRatio=e}),label:"Lock ratio?"},null,8,["modelValue"])])])],64)):Object(r["h"])("",!0)])]})),_:1},8,["title"])})),We=n("8f12"),Me=n("d4ec"),Ve=n("bee2"),Le=n("45eb"),Ue=n("7e84"),ze=n("262e"),Ge=n("2caf"),qe=(n("4ec9"),5),Ye=function(){function t(e){Object(Me["a"])(this,t),this.str=e,this.i=0}return Object(Ve["a"])(t,[{key:"current",value:function(){return this.str[this.i]}},{key:"next",value:function(){return++this.i,this.current()}},{key:"pos",get:function(){return this.i}},{key:"around",get:function(){return this.str.slice(Math.max(0,this.i-qe),this.i+qe)}},{key:"ahead",get:function(){return this.str[this.i+1]}},{key:"behind",get:function(){return this.str[this.i+1]}}]),t}();function Xe(t){var e=[],n=new Ye(t),r=Ke;while(r!==Je)r=r(e,n);return e}function Ke(t,e){return void 0===e.current()?Je:"{"===e.current()?tn:"\n"===e.current()?en:Ze}function Je(){return Je}function Ze(t,e){var n,r=e.pos,o="",a=!1;while(1){if(void 0===e.current()){n=Je;break}if(a)o+=e.current(),a=!1;else if("\\"===e.current())a=!0;else{if("{"===e.current()||"\n"===e.current()){n=Ke;break}o+=e.current()}e.next()}return t.push({type:"text",pos:r,content:o}),n}function Qe(t,e){throw new Error("Error at position ".concat(t.pos,": (around: ").concat(t.around,") ").concat(e))}function tn(t,e){var n=e.pos;if("{"!==e.current())throw new Error("Parser error: Command does not start with {");var r="/"===e.next();r&&e.next();var o="",a="",i=!1;while(1){if(void 0===e.current()&&Qe(e,"Unexpected end of text inside a command"),"}"===e.current())break;i?a+=e.current():e.current().match(/[a-z]/i)?o+=e.current():"="===e.current()?(r&&Qe(e,"Closing commands may not contain arguments"),i=!0):Qe(e,"Unexpected character in command name."),e.next()}return e.next(),r?t.push({type:"commandClose",commandName:o,pos:n}):t.push({type:"command",pos:n,argument:a,commandName:o}),Ke}function en(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),Ke}var nn=new Map([rn("i",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isItalic:!0})})),rn("b",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isBold:!0})})),rn("u",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isUnderlined:!0})})),rn("s",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isStrikethrough:!0})})),rn("plain",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})})),rn("edited",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})})),on("k",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{letterSpacing:e?t.letterSpacing+n:n})})),on("size",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{fontSize:e?t.fontSize+n:n})})),on("alpha",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{alpha:e?t.alpha+n:n})})),on("stroke",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{strokeWidth:e?t.strokeWidth+n:n})})),["font",function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{fontName:e})}],["color",function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{color:e})}],["outlinecolor",function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{strokeColor:e})}]]);function rn(t,e){return[t,function(n,r){if(r)throw new Error("Operator '".concat(t,"' does not take any arguments."));return e(n)}]}function on(t,e){return[t,function(n,r){if(!r)throw new Error("Operator '".concat(t,"' needs an argument."));var o="+"===r[0]||"-"===r[0],a=Number(r);if(isNaN(a))throw new Error("Operator '".concat(t,"' needs a numeric argument."));return e(n,o,a)}]}function an(t){throw new Error('Unexpected value "'.concat(t,'"'))}var cn=function(){function t(e,n){Object(Me["a"])(this,t),this.str=e,this.baseStyle=n,this.tokens=Xe(e),this.rebuildParts()}return Object(Ve["a"])(t,[{key:"rebuildParts",value:function(){this.renderParts=this.getRenderParts(this.tokens,this.baseStyle)}},{key:"loadFonts",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o,a,i,c,s,u,l,d,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("fonts"in document){t.next=2;break}return t.abrupt("return");case 2:e=new Set,n=null,r=Object(yt["a"])(this.renderParts),t.prev=5,r.s();case 7:if((o=r.n()).done){t.next=14;break}if(a=o.value,"style"in a){t.next=11;break}return t.abrupt("continue",12);case 11:a.style!==n&&(n=a.style,n.fontName&&e.add(n.fontName));case 12:t.next=7;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](5),r.e(t.t0);case 19:return t.prev=19,r.f(),t.finish(19);case 22:i=!1,c=Object(yt["a"])(e),t.prev=24,c.s();case 26:if((s=c.n()).done){t.next=36;break}if(u=s.value,l=document,d="8px ".concat(u),l.fonts.check(d)){t.next=34;break}return i=!0,t.next=34,l.fonts.load(d);case 34:t.next=26;break;case 36:t.next=41;break;case 38:t.prev=38,t.t1=t["catch"](24),c.e(t.t1);case 41:return t.prev=41,c.f(),t.finish(41);case 44:i&&(f=Xe(this.str),this.renderParts=this.getRenderParts(f,this.baseStyle));case 45:case"end":return t.stop()}}),t,this,[[5,16,19,22],[24,38,41,44]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(t){t.save();var e,n=null,r=Object(yt["a"])(this.renderParts);try{for(r.s();!(e=r.n()).done;){var o=e.value;"newline"!==o.type&&(o.style!==n&&(n=o.style,hn(n,t)),n.strokeWidth>0&&n.strokeColor>""&&t.strokeText(o.character,o.x,o.y))}}catch(s){r.e(s)}finally{r.f()}var a,i=Object(yt["a"])(this.renderParts);try{for(i.s();!(a=i.n()).done;){var c=a.value;"newline"!==c.type&&(c.style!==n&&(n=c.style,hn(n,t)),t.fillText(c.character,c.x,c.y))}}catch(s){i.e(s)}finally{i.f()}t.restore()}},{key:"quote",value:function(){var t;(function(t){t[t["None"]=0]="None",t[t["ExplictQuote"]=1]="ExplictQuote",t[t["ImplictQuote"]=2]="ImplictQuote",t[t["Star"]=3]="Star"})(t||(t={}));for(var e=-1,n=t.None,r=0;r<this.renderParts.length;++r){var o=this.renderParts[r];if("character"===o.type)switch(n){case t.None:if(o.character.match(/\s/))continue;'"'===o.character?(n=t.ExplictQuote,e=r):"*"===o.character?(n=t.Star,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:o.style,character:'"',height:o.height,width:ln(o.style,'"')}),r++,e=r,n=t.ImplictQuote);break;case t.ExplictQuote:e=r,'"'===o.character&&(n=t.None);break;case t.ImplictQuote:if(o.character.match(/\s/))continue;"*"===o.character&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:o.style,character:'"',height:o.height,width:ln(o.style,'"')}),n=t.Star,r++),e=r;break;case t.Star:"*"===o.character&&(n=t.None),e=r;break}}var a=this.renderParts[e];a&&n===t.Star&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:"*",height:a.height,width:ln(a.style,'"')}),!a||n!==t.ExplictQuote&&n!==t.ImplictQuote||this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:'"',height:a.height,width:ln(a.style,'"')})}},{key:"fixAlignment",value:function(t,e,n,r,o){var a=0,i=[];function c(){var r=e;"center"===t?r=e+(n-e)/2-a/2:"right"===t&&(r=n-a);var o,c=Object(yt["a"])(i);try{for(c.s();!(o=c.n()).done;){var s=o.value;s.x=r,r+=s.width}}catch(u){c.e(u)}finally{c.f()}}var s=this.renderParts;o>0&&(s=this.applyLineWrapping(this.renderParts.slice(0),o));var u,l=r,d=[],f=0,h=Object(yt["a"])(s);try{for(h.s();!(u=h.n()).done;){var b=u.value;f=Math.max(f,b.height),"newline"===b.type&&(d.push(f),f=0)}}catch(O){h.e(O)}finally{h.f()}d.push(f);var p,m=0,v=Object(yt["a"])(s);try{for(v.s();!(p=v.n()).done;){var g=p.value;if(f=Math.max(f,g.height),g.y=l,i.push(g),a+=g.width,"newline"===g.type)c(),l+=d[++m]||0,a=0,f=0,i=[];else if("character"===g.type){var j=i[i.length-1];"character"===j.type&&(a+=j.style.letterSpacing,j.width+=j.style.letterSpacing)}}}catch(O){v.e(O)}finally{v.f()}c()}},{key:"getHeight",value:function(t){var e,n=0,r=0,o=0===t?this.renderParts:this.applyLineWrapping(this.renderParts.slice(0),t),a=Object(yt["a"])(o);try{for(a.s();!(e=a.n()).done;){var i=e.value;n=Math.max(n,i.height),"newline"===i.type&&(r+=n,n=0)}}catch(c){a.e(c)}finally{a.f()}return r+=n,r}},{key:"getWidth",value:function(){var t,e=0,n=0,r=null,o=Object(yt["a"])(this.renderParts);try{for(o.s();!(t=o.n()).done;){var a=t.value;e+=a.width,"newline"===a.type?(n=Math.max(n,e),e=0,r=null):"character"===a.type&&(r&&"character"===r.type&&(e+=r.style.letterSpacing),r=a)}}catch(i){o.e(i)}finally{o.f()}return n=Math.max(n,e),n}},{key:"getRenderParts",value:function(e,n){var r,o=[],a=[],i=[],c=fn(n),s=n,u=null,l=Object(yt["a"])(e);try{for(l.s();!(r=l.n()).done;){var d=r.value;switch(d.type){case"command":if(!t.textCommands.has(d.commandName))throw new Error("There is no text command called '".concat(d.commandName,"' at position ").concat(d.pos,"."));a.push(s),i.push(u),s=t.textCommands.get(d.commandName)(s,d.argument),c=fn(s),u=d;break;case"commandClose":if(!u)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', but no commands are currently open."));if(d.commandName!==u.commandName)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', expected to close '").concat(u,"' first. (Opened at position ").concat(u.pos,")"));u=i.pop(),s=a.pop();break;case"newline":o.push({height:c,width:0,x:0,y:0,type:"newline"});break;case"text":var f,h=Object(yt["a"])(d.content);try{for(h.s();!(f=h.n()).done;){var b=f.value;o.push({type:"character",character:b,height:c,width:ln(s,b),style:s,x:0,y:0})}}catch(p){h.e(p)}finally{h.f()}}}}catch(p){l.e(p)}finally{l.f()}return o}},{key:"applyLineWrapping",value:function(t,e){var n,r=-1,o=0,a=0,i=[],c=Object(yt["a"])(t);try{for(c.s();!(n=c.n()).done;){var s=n.value;if("newline"===s.type)r=-1,o=0,a=0,i.push(s);else if("character"===s.type)if(" "===s.character){if(o>e){r=-1,o=0,a=0,i.push({type:"newline",height:s.height,width:0,x:0,y:0});continue}o+=s.width,a=o,r=i.length,i.push(s)}else o+=s.width,o>e&&-1!==r?(o-=a,i.splice(r,1,{type:"newline",height:s.height,width:0,x:0,y:0}),r=-1,a=0,i.push(s)):i.push(s);else an(s)}}catch(u){c.e(u)}finally{c.f()}return i}}]),t}();cn.textCommands=nn;var sn=document.createElement("canvas").getContext("2d"),un=null;function ln(t,e){return t!==un&&(hn(t,sn),un=t),sn.measureText(e).width}var dn=new Map;function fn(t){var e=t.fontSize+" "+t.fontName;if(dn.has(e))return dn.get(e)*t.lineSpacing;var n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize="".concat(t.fontSize,"px"),n.style.lineHeight="1";var r=document.createElement("div");r.style.opacity="0",r.style.fontFamily=t.fontName,r.style.fontSize="".concat(t.fontSize,"px"),r.style.lineHeight="1",r.style.position="absolute",r.style.top="0",r.style.left="0",r.appendChild(n),document.body.appendChild(r);try{var o=r.offsetHeight;return dn.set(e,o),o*t.lineSpacing}finally{r.remove()}}function hn(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}var bn=n("4265"),pn=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(t){var r;Object(Me["a"])(this,n),r=e.call(this,t),r.lastWidth=-1,r.lastHeight=-1,r.lastX=-1,r.lastY=-1,r.lastFlip=null,r.canvasDrawPosX=0,r.canvasDrawPosY=0;var o=Object(We["a"])().Base;return r.canvasHeight=o.screenHeight,r.canvasWidth=o.screenWidth,r.canvasDrawHeight=o.screenHeight,r.canvasDrawWidth=o.screenWidth,r}return Object(Ve["a"])(n,[{key:"getRenderRotation",value:function(){return[0,void 0]}},{key:"needsRedraw",value:function(){return!!Object(Le["a"])(Object(Ue["a"])(n.prototype),"needsRedraw",this).call(this)||(this.width!==this.lastWidth||this.height!==this.lastHeight||this.x!==this.lastX||this.y!==this.lastY||this.flip!==this.lastFlip)}},{key:"updateLocalCanvas",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lastWidth=this.width,this.lastHeight=this.height,this.lastX=this.x,this.lastY=this.y,this.lastFlip=this.flip,t.next=7,Object(Le["a"])(Object(Ue["a"])(n.prototype),"updateLocalCanvas",this).call(this,e);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderLocal",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object(We["a"])().Base,0!==this.rotation){t.next=3;break}return t.abrupt("return",this.draw(e));case 3:return t.next=5,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var o,a,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=r.getHitbox(),a=o.x0+(o.x1-o.x0)/2,i=o.y0+(o.y1-o.y0)/2,c=r.flip?n.screenWidth-a:a,e.translate(c,i),e.rotate(r.rotation),e.translate(-c,-i);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.draw.bind(this));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getHitbox",value:function(){var t=this.centeredVertically,e=this.width/2,n=this.height/2;return{x0:this.x-e,x1:this.x+e,y0:t?this.y-n:this.y,y1:t?this.y+n:this.y+this.height}}},{key:"centeredVertically",get:function(){return!1}}]),n}(bn["a"]),mn=n("d206"),vn=function(){function t(e){Object(Me["a"])(this,t),this.base=e}return Object(Ve["a"])(t,[{key:"getControlsStyle",value:function(){return mn["ControlsTextStyle"]}},{key:"getControlsDisabledStyle",value:function(){return mn["ControlsTextDisabledStyle"]}},{key:"renderControls",value:function(t,e){var n=Object(We["a"])(),r=this.width,o=r/2,a=this.base.obj.flip?n.Base.screenWidth-this.base.obj.x:this.base.obj.x,i=a-o,c=i+r/2,s=this.getControlsStyle();t.drawText(Object(ue["a"])({text:"History",x:c+mn["ControlsXHistoryOffset"],y:e},s)),t.drawText(Object(ue["a"])({text:"Skip",x:c+mn["ControlsXSkipOffset"],y:e},this.base.obj.skip?s:this.getControlsDisabledStyle())),t.drawText(Object(ue["a"])({text:"Auto   Save   Load   Settings",x:c+mn["ControlsXStuffOffset"],y:e},s))}},{key:"obj",get:function(){return this.base.obj}},{key:"refObject",get:function(){return this.base.refObject}},{key:"textboxStyle",get:function(){return mn["TextBoxStyle"]}}],[{key:"resizable",get:function(){return!1}},{key:"defaultWidth",get:function(){return mn["TextBoxWidth"]}},{key:"defaultHeight",get:function(){return mn["TextBoxHeight"]}},{key:"defaultX",get:function(){return Object(We["a"])().Base.screenWidth/2}},{key:"defaultY",get:function(){return Object(We["a"])().Base.screenHeight-this.defaultHeight-mn["NameboxHeight"]-Object(We["a"])().TextBox.TextBoxBottomSpacing}}]),t}(),gn=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t.backgroundImage="textbox",t.xOffset=0,t}return Object(Ve["a"])(n,[{key:"renderNamebox",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,Object(wt["b"])("namebox");case 3:t.t1=t.sent,t.t2=n,t.t3=r,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 8:case"end":return t.stop()}}),t)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n+=this.xOffset,t.next=3,Object(wt["b"])(this.backgroundImage);case 3:o=t.sent,e.drawImage({image:o,x:n,y:r});case 5:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(We["a"])(),r=this.width,o=this.height,a=r/2,i=this.obj.flip?n.Base.screenWidth-this.obj.x:this.obj.x,c=i-a,s=this.obj.y,t.next=9,this.renderBackdrop(e,c,s+this.nameboxHeight);case 9:if(null===this.obj.talkingObjId){t.next=12;break}return t.next=12,this.renderNamebox(e,c+this.nameboxOffsetX,s);case 12:if(u=s+o,l=u-mn["ControlsYBottomOffset"],this.obj.controls&&this.renderControls(e,l),!this.obj.continue){t.next=24;break}return t.t0=e,t.next=19,Object(wt["b"])("next");case 19:t.t1=t.sent,t.t2=c+r-mn["ArrowXRightOffset"],t.t3=u-mn["ArrowYBottomOffset"],t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 24:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"appliesTo",value:function(t){return t===n.id}},{key:"height",get:function(){return mn["TextBoxHeight"]+mn["NameboxHeight"]}},{key:"width",get:function(){return mn["TextBoxWidth"]}},{key:"nameboxWidth",get:function(){return mn["NameboxWidth"]}},{key:"nameboxHeight",get:function(){return mn["NameboxHeight"]}},{key:"nameboxOffsetX",get:function(){return mn["NameboxXOffset"]}},{key:"nameboxOffsetY",get:function(){return mn["NameboxTextYOffset"]}},{key:"nameboxStyle",get:function(){return mn["NameboxTextStyle"]}},{key:"textOffsetX",get:function(){return mn["TextBoxTextXOffset"]}},{key:"textOffsetY",get:function(){return mn["TextBoxTextYOffset"]}}]),n}(vn);gn.id="normal",gn.label="Normal",gn.priority=0,gn.gameMode="ddlc";var jn=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t.backgroundImage="textbox_monika",t.xOffset=(mn["TextBoxWidth"]-mn["TextBoxCorruptedWidth"])/2,t}return Object(Ve["a"])(n,[{key:"appliesTo",value:function(t){return t===n.id}}]),n}(gn);function On(t,e,n,r,o,a){r<0&&(r=0),o<0&&(o=0),r<2*a&&(a=r/2),o<2*a&&(a=o/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+o,a),t.arcTo(e+r,n+o,e,n+o,a),t.arcTo(e,n+o,e,n,a),t.arcTo(e,n,e+r,n,a),t.closePath()}function kn(t,e,n,r,o,a){r<0&&(r=0),o<0&&(o=0),r<2*a&&(a=r/2),o<2*a&&(a=o/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+o,a),t.lineTo(e+r,n+o),t.lineTo(e,n+o),t.arcTo(e,n,e+r,n,a),t.closePath()}jn.id="corrupt",jn.label="Corrupted",jn.priority=1,jn.gameMode="ddlc";var xn=n("525a"),yn=n("31cb"),wn=n("fd0b"),Cn=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t.backgroundImage="textbox",t.xOffset=0,t}return Object(Ve["a"])(n,[{key:"renderNamebox",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=this.nameboxWidth,a=this.nameboxHeight,t.next=4,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),kn(e,n,r,o,a,xn["nameboxRounding"]),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var o,c,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=e.linearGradient(n,r,n,r+a),c=yn["a"].fromCss(i.nameboxBackgroundColor),s=new yn["a"](c.r,c.g,c.b,.95),u=s.toHSL().shift(xn["nameboxGradientEndDelta"]).toRgb(),o.addColorStop(0,s.toCss()),o.addColorStop(xn["nameboxGradientMiddleStopPosition"],s.toCss()),o.addColorStop(1,u.toCss()),e.drawRect({x:n,y:r,w:i.obj.width,h:a,fill:{style:o}});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i,c=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=yn["a"].fromCss(this.customColor).toHSL(),a=new wn["a"](xn["dotPatternSize"],xn["dotPatternSize"]),a.render(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=function(t,r){e.drawPath({path:function(e){e.ellipse(t,r,xn["dotRadius"],xn["dotRadius"],0,0,2*Math.PI)},fill:n})},n={style:o.shift(xn["dotColorDelta"]).toRgb().toCss()},r(0,0),r(xn["dotPatternSize"],0),r(0,xn["dotPatternSize"]),r(xn["dotPatternSize"],xn["dotPatternSize"]),r(xn["dotPatternSize"]/2,xn["dotPatternSize"]/2);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),t.next=5,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),On(e,n+xn["textboxRoundingBuffer"],r+xn["textboxRoundingBuffer"],c.width-2*xn["textboxRoundingBuffer"],c.height-mn["NameboxHeight"]-2*xn["textboxRoundingBuffer"],xn["textboxRounding"]),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var o,i,s,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=c.obj.height,i=c.obj.width,s=e.linearGradient(n,r,n,r+o),l=yn["a"].fromHex(c.customColor),s.addColorStop(0,l.toCss()),s.addColorStop(1,"rgba(".concat(l.r,",").concat(l.g,",").concat(l.b,",0.6667)")),e.drawRect({x:n,y:r,w:i,h:o,fill:{style:s},outline:{style:"#ffdfee",width:6}}),t.next=9,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.translate(n,r);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.patternFrom(a),e.drawRect({x:0,y:0,w:i,h:o,fill:{style:r},composition:"source-atop"});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:d=e.linearGradient(n,r+o-mn["GlowRY"],n,r+o),d.addColorStop(0,"rgba(255,255,255,0.3137)"),d.addColorStop(.5,"rgba(255,255,255,0.0627)"),d.addColorStop(1,"rgba(255,255,255,0)"),e.drawPath({path:function(t){t.ellipse(n+i/2,r+o,mn["GlowRX"],mn["GlowRY"],0,0,2*Math.PI)},fill:{style:d}});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:i=o.shift(xn["textboxOutlineColorDelta"]).toRgb().toCss(),e.drawPath({path:function(t){On(t,n+xn["textboxRoundingBuffer"],r+xn["textboxRoundingBuffer"],c.width-2*xn["textboxRoundingBuffer"],c.height-mn["NameboxHeight"]-2*xn["textboxRoundingBuffer"],xn["textboxRounding"])},outline:{style:i,width:xn["textboxOutlineWidth"]}});case 7:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object(We["a"])(),r=this.width,o=this.height,a=r/2,i=this.obj.flip?n.Base.screenWidth-this.obj.x:this.obj.x,c=i-a,s=this.obj.y,null===this.obj.talkingObjId){t.next=10;break}return t.next=10,this.renderNamebox(e,c+this.nameboxOffsetX,s);case 10:return t.next=12,this.renderBackdrop(e,c,s+this.nameboxHeight);case 12:if(u=s+o,l=u-mn["ControlsYBottomOffset"],this.obj.controls&&this.renderControls(e,l),!this.obj.continue){t.next=24;break}return t.t0=e,t.next=19,Object(wt["b"])("next");case 19:t.t1=t.sent,t.t2=c+r-mn["ArrowXRightOffset"],t.t3=u-mn["ArrowYBottomOffset"],t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 24:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"appliesTo",value:function(t){return t===n.id}},{key:"height",get:function(){return this.obj.height+mn["NameboxHeight"]}},{key:"width",get:function(){return this.obj.width}},{key:"nameboxWidth",get:function(){return this.refObject&&null!==this.refObject.nameboxWidth?this.refObject.nameboxWidth:null!==this.obj.customNameboxWidth?this.obj.customNameboxWidth:mn["NameboxWidth"]}},{key:"nameboxHeight",get:function(){return mn["NameboxHeight"]}},{key:"nameboxOffsetX",get:function(){return mn["NameboxXOffset"]}},{key:"nameboxOffsetY",get:function(){return mn["NameboxTextYOffset"]}},{key:"nameboxStyle",get:function(){return Object(ue["a"])(Object(ue["a"])({},mn["NameboxTextStyle"]),{},{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}},{key:"textOffsetX",get:function(){return mn["TextBoxTextXOffset"]}},{key:"textOffsetY",get:function(){return mn["TextBoxTextYOffset"]}},{key:"customColor",get:function(){return this.obj.overrideColor?this.obj.customColor:this.refObject&&this.refObject.textboxColor?this.refObject.textboxColor:xn["textboxDefaultColor"]}},{key:"nameboxOutlineColor",get:function(){if(this.obj.deriveCustomColors){var t=yn["a"].fromCss(this.customColor).toHSL();return t.shift(xn["nameboxTextOutlineDelta"]).toRgb().toCss()}return this.obj.customNameboxStroke}},{key:"nameboxBackgroundColor",get:function(){if(this.obj.deriveCustomColors){var t=yn["a"].fromCss(this.customColor).toHSL();return t.shift(xn["nameboxBackgroundDelta"]).toRgb().toCss()}return this.obj.customNameboxColor}}],[{key:"resizable",get:function(){return!0}}]),n}(vn);Cn.id="custom",Cn.label="Custom",Cn.priority=0,Cn.gameMode="ddlc";var Sn=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){return Object(Me["a"])(this,n),e.apply(this,arguments)}return Object(Ve["a"])(n,[{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"appliesTo",value:function(t){return t===n.id}},{key:"height",get:function(){return mn["TextBoxHeight"]+mn["NameboxHeight"]}},{key:"width",get:function(){return mn["TextBoxWidth"]}},{key:"nameboxWidth",get:function(){return mn["NameboxWidth"]}},{key:"nameboxHeight",get:function(){return mn["NameboxHeight"]}},{key:"nameboxOffsetX",get:function(){return mn["NameboxXOffset"]}},{key:"nameboxOffsetY",get:function(){return mn["NameboxTextYOffset"]}},{key:"nameboxStyle",get:function(){return mn["NameboxTextStyle"]}},{key:"textOffsetX",get:function(){return mn["TextBoxTextXOffset"]}},{key:"textOffsetY",get:function(){return mn["TextBoxTextYOffset"]}},{key:"textboxStyle",get:function(){return mn["TextBoxStyle"]}}]),n}(vn);Sn.id="none",Sn.label="None",Sn.priority=0,Sn.gameMode="ddlc";var Rn=n("caeb"),Pn=n("7134"),Tn=function(){function t(e){Object(Me["a"])(this,t),this.base=e}return Object(Ve["a"])(t,[{key:"getControlsStyle",value:function(){return Rn["ControlsTextStyle"]}},{key:"getControlsDisabledStyle",value:function(){return Rn["ControlsTextDisabledStyle"]}},{key:"renderControls",value:function(e,n){for(var r=Object(We["a"])(),o=this.width,a=o/2,i=this.base.obj.flip?r.Base.screenWidth-this.base.obj.x:this.base.obj.x,c=i-a,s=this.getControlsStyle(),u=["History","Skip","Auto","Save","Load","Settings"],l=[],d=0,f=0,h=u;f<h.length;f++){var b=h[f],p=t.controlWidth(e,b);l.push(p),d+=p}for(var m=Math.min((o-d)/u.length,78),v=c+(o-d-m*(u.length-1))/2,g=0;g<u.length;++g){var j=u[g],O=l[g],k="Skip"!==j||this.base.obj.skip?s:this.getControlsDisabledStyle();e.drawText(Object(ue["a"])({text:j,x:v,y:n},k)),v+=O+m}}},{key:"obj",get:function(){return this.base.obj}},{key:"refObject",get:function(){return this.base.refObject}}],[{key:"controlWidth",value:function(t,e){if(this.widthCache[e])return this.widthCache[e];var n=t.measureText(Object(ue["a"])({text:e},Rn["ControlsTextStyle"])).width;return this.widthCache[e]=n,n}},{key:"resizable",get:function(){return!1}},{key:"defaultWidth",get:function(){return Rn["TextBoxWidth"]}},{key:"defaultHeight",get:function(){return Rn["TextBoxHeight"]}},{key:"defaultX",get:function(){return Object(We["a"])().Base.screenWidth/2}},{key:"defaultY",get:function(){return Object(We["a"])().Base.screenHeight-this.defaultHeight-Rn["NameboxHeight"]-Object(We["a"])().TextBox.TextBoxBottomSpacing}}]),t}();Tn.widthCache={};var Bn=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t.backgroundImage="textbox",t.xOffset=0,t}return Object(Ve["a"])(n,[{key:"renderNamebox",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=this.nameboxWidth,a=this.nameboxHeight,t.next=4,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),kn(e,n,r,o,a,Pn["nameboxRounding"]),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var o,c,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=e.linearGradient(n,r,n,r+a),c=yn["a"].fromCss(i.nameboxBackgroundColor),s=new yn["a"](c.r,c.g,c.b,.95),u=s.toHSL().shift(Pn["nameboxGradientEndDelta"]).toRgb(),o.addColorStop(0,s.toCss()),o.addColorStop(Pn["nameboxGradientMiddleStopPosition"],s.toCss()),o.addColorStop(1,u.toCss()),e.drawRect({x:n,y:r,w:i.obj.width,h:a,fill:{style:o}});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i,c=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=yn["a"].fromCss(this.customColor).toHSL(),a=new wn["a"](Pn["dotPatternSize"],Pn["dotPatternSize"]),a.render(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=function(t,r){e.drawPath({path:function(e){e.ellipse(t,r,Pn["dotRadius"],Pn["dotRadius"],0,0,2*Math.PI)},fill:n})},n={style:o.shift(Pn["dotColorDelta"]).toRgb().toCss()},r(0,0),r(Pn["dotPatternSize"],0),r(0,Pn["dotPatternSize"]),r(Pn["dotPatternSize"],Pn["dotPatternSize"]),r(Pn["dotPatternSize"]/2,Pn["dotPatternSize"]/2);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),t.next=5,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),On(e,n+Pn["textboxRoundingBuffer"],r+Pn["textboxRoundingBuffer"],c.width-2*Pn["textboxRoundingBuffer"],c.height-Rn["NameboxHeight"]-2*Pn["textboxRoundingBuffer"],Pn["textboxRounding"]),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var o,i,s,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=c.obj.height,i=c.obj.width,s=e.linearGradient(n,r,n,r+o),l=yn["a"].fromHex(c.customColor),s.addColorStop(0,l.toCss()),s.addColorStop(1,"rgba(".concat(l.r,",").concat(l.g,",").concat(l.b,",0.6667)")),e.drawRect({x:n,y:r,w:i,h:o,fill:{style:s},outline:{style:"#ffdfee",width:6}}),t.next=9,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.translate(n,r);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.patternFrom(a),e.drawRect({x:0,y:0,w:i,h:o,fill:{style:r},composition:"source-atop"});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:d=e.linearGradient(n,r+o-Rn["GlowRY"],n,r+o),d.addColorStop(0,"rgba(255,255,255,0.3137)"),d.addColorStop(.5,"rgba(255,255,255,0.0627)"),d.addColorStop(1,"rgba(255,255,255,0)"),e.drawPath({path:function(t){t.ellipse(n+i/2,r+o,Rn["GlowRX"],Rn["GlowRY"],0,0,2*Math.PI)},fill:{style:d}});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:i=o.shift(Pn["textboxOutlineColorDelta"]).toRgb().toCss(),e.drawPath({path:function(t){On(t,n+Pn["textboxRoundingBuffer"],r+Pn["textboxRoundingBuffer"],c.width-2*Pn["textboxRoundingBuffer"],c.height-Rn["NameboxHeight"]-2*Pn["textboxRoundingBuffer"],Pn["textboxRounding"])},outline:{style:i,width:Pn["textboxOutlineWidth"]}});case 7:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object(We["a"])(),r=this.width,o=this.height,a=r/2,i=this.obj.flip?n.Base.screenWidth-this.obj.x:this.obj.x,c=i-a,s=this.obj.y,null===this.obj.talkingObjId){t.next=10;break}return t.next=10,this.renderNamebox(e,c+this.nameboxOffsetX,s);case 10:return t.next=12,this.renderBackdrop(e,c,s+this.nameboxHeight);case 12:if(u=s+o,l=u-Rn["ControlsYBottomOffset"],this.obj.controls&&this.renderControls(e,l),!this.obj.continue){t.next=24;break}return t.t0=e,t.next=19,Object(wt["b"])("next_plus");case 19:t.t1=t.sent,t.t2=c+r-Rn["ArrowXRightOffset"],t.t3=u-Rn["ArrowYBottomOffset"],t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 24:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"appliesTo",value:function(t){return t===n.id}},{key:"height",get:function(){return this.obj.height+Rn["NameboxHeight"]}},{key:"width",get:function(){return this.obj.width}},{key:"nameboxWidth",get:function(){return this.refObject&&null!==this.refObject.nameboxWidth?this.refObject.nameboxWidth:null!==this.obj.customNameboxWidth?this.obj.customNameboxWidth:Rn["NameboxWidth"]}},{key:"nameboxHeight",get:function(){return Rn["NameboxHeight"]}},{key:"nameboxOffsetX",get:function(){return Rn["NameboxXOffset"]}},{key:"nameboxOffsetY",get:function(){return Rn["NameboxTextYOffset"]}},{key:"nameboxStyle",get:function(){return Object(ue["a"])(Object(ue["a"])({},Rn["NameboxTextStyle"]),{},{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}},{key:"textOffsetX",get:function(){return Rn["TextBoxTextXOffset"]}},{key:"textOffsetY",get:function(){return Rn["TextBoxTextYOffset"]}},{key:"textboxStyle",get:function(){return Rn["TextBoxStyle"]}},{key:"customColor",get:function(){return this.obj.overrideColor?this.obj.customColor:this.refObject&&this.refObject.textboxColor?this.refObject.textboxColor:Pn["textboxDefaultColor"]}},{key:"nameboxOutlineColor",get:function(){if(this.obj.deriveCustomColors){var t=yn["a"].fromCss(this.customColor).toHSL();return t.shift(Pn["nameboxTextOutlineDelta"]).toRgb().toCss()}return this.obj.customNameboxStroke}},{key:"nameboxBackgroundColor",get:function(){if(this.obj.deriveCustomColors){var t=yn["a"].fromCss(this.customColor).toHSL();return t.shift(Pn["nameboxBackgroundDelta"]).toRgb().toCss()}return this.obj.customNameboxColor}}],[{key:"resizable",get:function(){return!0}}]),n}(Tn);Bn.id="custom_plus",Bn.label="Custom (Plus)",Bn.priority=0,Bn.gameMode="ddlc_plus";var In=[gn,jn,Cn,Sn,Bn],Dn=function(){var t,e={},n=Object(yt["a"])(In);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r.id]=r}}catch(o){n.e(o)}finally{n.f()}return e}();var An=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t.refObject=null,t._lastRenderer=null,t}return Object(Ve["a"])(n,[{key:"updatedContent",value:function(t,e){Object(Le["a"])(Object(Ue["a"])(n.prototype),"updatedContent",this).call(this,t,e);var r=this.obj.talkingObjId;if(null!==r&&"$other$"!==r){var o=t.state.objects.objects[r];if(o)return void(this.refObject=o)}this.refObject=null}},{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(We["a"])(),r=this.textboxRenderer,o=r.width,r.height,a=o/2,i=this.flip?n.Base.screenWidth-this.obj.x:this.obj.x,c=i-a,s=this.obj.y,t.next=10,r.render(e);case 10:if(null===this.obj.talkingObjId){t.next=14;break}return l="$other$"===this.obj.talkingObjId?this.obj.talkingOther:(null===(u=this.refObject)||void 0===u?void 0:u.label)||"Missing name",t.next=14,this.renderName(e,c+r.nameboxOffsetX,s,l);case 14:return t.next=16,this.renderText(e,c,s,this.obj.autoWrap?o:0);case 16:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderName",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r,o){var a,i,c,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.textboxRenderer,i=a.nameboxWidth,c=a.nameboxStyle,s=new cn(o,c),t.next=6,s.loadFonts();case 6:s.fixAlignment("center",n,n+i,r+a.nameboxOffsetY,0),s.render(e.fsCtx);case 8:case"end":return t.stop()}}),t,this)})));function e(e,n,r,o){return t.apply(this,arguments)}return e}()},{key:"renderText",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r,o){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new cn(this.obj.text,this.textboxRenderer.textboxStyle),this.obj.autoQuoting&&null!==this.obj.talkingObjId&&a.quote(),t.next=4,a.loadFonts();case 4:a.fixAlignment("left",n+this.textboxRenderer.textOffsetX,0,r+this.textboxRenderer.nameboxHeight+this.textboxRenderer.textOffsetY,o-2*this.textboxRenderer.textOffsetX),a.render(e.fsCtx);case 6:case"end":return t.stop()}}),t,this)})));function e(e,n,r,o){return t.apply(this,arguments)}return e}()},{key:"y",get:function(){return this.obj.y}},{key:"width",get:function(){return this.textboxRenderer.width}},{key:"height",get:function(){return this.textboxRenderer.height}},{key:"textboxRenderer",get:function(){if(this._lastRenderer&&this._lastRenderer.appliesTo(this.obj.style))return this._lastRenderer;var t=this.forcedStyle;if(!Dn[t])throw new Error("Unknown textbox style renderer");var e=new Dn[t](this);return this._lastRenderer=e,e}},{key:"forcedStyle",get:function(){return"normal"!==this.obj.style&&"normal_plus"!==this.obj.style||!this.refObject||!this.refObject.textboxColor&&null===this.refObject.nameboxWidth?this.obj.style:"custom"}}]),n}(pn),Hn=Object(r["m"])({components:{Toggle:X["a"],DFieldset:Gt["a"]},props:{obj:{required:!0}},computed:{freeMove:{get:function(){return this.obj.freeMove},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFreeMove",{id:e.obj.id,freeMove:t})}))}},preserveRatio:{get:function(){return this.obj.preserveRatio},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPreserveRatio",{id:e.obj.id,preserveRatio:t})}))}},pos:{get:function(){return Object(zt["c"])(this.obj.x)},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:Object(We["a"])().Base.characterPositions[t],y:e.obj.y})}))}},x:{get:function(){return this.obj.x},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:t,y:e.y})}))}},y:{get:function(){return this.obj.y},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:e.x,y:t})}))}},height:{get:function(){return this.obj.height},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setHeight",{id:e.obj.id,height:t})}))}},width:{get:function(){return this.obj.width},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setWidth",{id:e.obj.id,width:t})}))}},allowSize:function(){var t=this.obj;if("textBox"===t.type){var e=Dn[t.style];return e.resizable}return!("character"===t.type&&!t.freeMove)},allowStepMove:function(){return"freeMove"in this.obj},positionNames:function(){return Object(We["a"])().Base.positions},isFirstPos:function(){return 0===this.pos},isLastPos:function(){return this.pos===Object(We["a"])().Base.positions.length-1}}});n("835e");Hn.render=Ee,Hn.__scopeId="data-v-3e1f568a";var _n=Hn,$n=Object(r["F"])("data-v-90b83fd8");Object(r["r"])("data-v-90b83fd8");var Fn=Object(r["k"])("i",{class:"material-icons"},"vertical_align_bottom",-1),Nn=Object(r["k"])("i",{class:"material-icons"},"arrow_downward",-1),En=Object(r["k"])("i",{class:"material-icons"},"arrow_upward",-1),Wn=Object(r["k"])("i",{class:"material-icons"},"vertical_align_top",-1);Object(r["q"])();var Mn=$n((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{id:"layerfs",title:"Layer:"},{default:$n((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tbody",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.shiftLayer(-1/0)}),title:"Move to back"},[Fn])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.shiftLayer(-1)}),title:"Move backwards"},[Nn])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.shiftLayer(1)}),title:"Move forwards"},[En])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return t.shiftLayer(1/0)}),title:"Move to front"},[Wn])])])])]),Object(r["k"])(c,{modelValue:t.onTop,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.onTop=e}),label:"In front?"},null,8,["modelValue"])]})),_:1})})),Vn=Object(r["m"])({components:{Toggle:X["a"],DFieldset:Gt["a"]},props:{object:{required:!0}},computed:{onTop:be()("onTop","objects/setOnTop",!0)},methods:{shiftLayer:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/shiftLayer",{id:e.object.id,delta:t})}))}}});n("71ca");Vn.render=Mn,Vn.__scopeId="data-v-90b83fd8";var Ln=Vn;function Un(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("button",{onClick:e[1]||(e[1]=function(){return t.onClick&&t.onClick.apply(t,arguments)})},"Delete")}var zn=Object(r["m"])({props:{obj:{required:!0}},methods:{onClick:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/removeObject",{id:t.obj.id})}))}}});zn.render=Un;var Gn=zn,qn=(n("b680"),Object(r["F"])("data-v-4dd06317"));Object(r["r"])("data-v-4dd06317");var Yn=Object(r["k"])("h2",null,"Image options",-1),Xn={class:"column ok-col"},Kn={key:0,class:"column"},Jn=Object(r["k"])("label",{for:"compositionSelect"},"Compositing Mode:",-1),Zn=Object(r["j"])("[?]"),Qn=Object(r["k"])("option",{value:"source-over"},"source-over",-1),tr=Object(r["k"])("option",{value:"source-atop"},"source-atop",-1),er=Object(r["k"])("option",{value:"destination-over"},"destination-over",-1),nr=Object(r["k"])("option",{value:"destination-in"},"destination-in",-1),rr=Object(r["k"])("option",{value:"destination-in"},"destination-out",-1),or=Object(r["k"])("option",{value:"destination-in"},"destination-atop",-1),ar=Object(r["k"])("option",{value:"lighter"},"lighter",-1),ir=Object(r["k"])("option",{value:"xor"},"xor",-1),cr=Object(r["k"])("option",{value:"multiply"},"multiply",-1),sr=Object(r["k"])("option",{value:"screen"},"screen",-1),ur=Object(r["k"])("option",{value:"overlay"},"overlay",-1),lr=Object(r["k"])("option",{value:"darken"},"darken",-1),dr=Object(r["k"])("option",{value:"lighten"},"lighten",-1),fr=Object(r["k"])("option",{value:"color-dodge"},"color-dodge",-1),hr=Object(r["k"])("option",{value:"color-burn"},"color-burn",-1),br=Object(r["k"])("option",{value:"hard-light"},"hard-light",-1),pr=Object(r["k"])("option",{value:"soft-light"},"soft-light",-1),mr=Object(r["k"])("option",{value:"difference"},"difference",-1),vr=Object(r["k"])("option",{value:"exclusion"},"exclusion",-1),gr=Object(r["k"])("option",{value:"hue"},"hue",-1),jr=Object(r["k"])("option",{value:"saturation"},"saturation",-1),Or=Object(r["k"])("option",{value:"color"},"color",-1),kr=Object(r["k"])("option",{value:"luminosity"},"luminosity",-1),xr=Object(r["k"])("label",{for:"addEffect"},"Add new effect",-1),yr={key:0,class:"value-input-table"},wr=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"shadow_color"},"Color:")],-1),Cr=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_x"},"X:")],-1),Sr=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_y"},"Y:")],-1),Rr=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_blur"},"Blur:")],-1),Pr=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_value"},"Value:")],-1),Tr=Object(r["j"])("% "),Br={key:0},Ir={colspan:"2"},Dr=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_value"},"Value:")],-1),Ar={key:0},Hr={colspan:"2"};Object(r["q"])();var _r=qn((function(t,e,n,o,a,i){var c=Object(r["w"])("color"),s=Object(r["w"])("l"),u=Object(r["w"])("d-flow"),l=Object(r["w"])("slider"),d=Object(r["w"])("d-fieldset");return t.showShadowColor?(Object(r["p"])(),Object(r["g"])(c,{key:0,modelValue:t.shadowColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.shadowColor=e}),format:"rgb",onLeave:e[2]||(e[2]=function(e){return t.showShadowColor=!1})},null,8,["modelValue"])):(Object(r["p"])(),Object(r["g"])(u,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:qn((function(){return[Yn,Object(r["k"])("div",Xn,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.$emit("leave")})},"Back")]),t.noComposition?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("div",Kn,[Jn,Object(r["k"])(s,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:qn((function(){return[Zn]})),_:1}),Object(r["D"])(Object(r["k"])("select",{id:"compositionSelect","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.compositionMode=e}),onKeydown:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},[Qn,tr,er,nr,rr,or,ar,ir,cr,sr,ur,lr,dr,fr,hr,br,pr,mr,vr,gr,jr,Or,kr],544),[[r["z"],t.compositionMode]])])),Object(r["k"])(d,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:qn((function(){return[Object(r["k"])(u,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:qn((function(){return[Object(r["k"])(u,{direction:"vertical","no-wraping":""},{default:qn((function(){return[xr,Object(r["D"])(Object(r["k"])("select",{id:"addEffect","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.addEffectSelection=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.filterTypes,(function(e){return Object(r["p"])(),Object(r["g"])("option",{key:e,value:e},Object(r["x"])(t.getFilterLabel(e)),9,["value"])})),128))],544),[[r["z"],t.addEffectSelection]]),Object(r["k"])("button",{disabled:""===t.addEffectSelection,onClick:e[8]||(e[8]=function(){return t.addFilter&&t.addFilter.apply(t,arguments)}),onKeydown:e[9]||(e[9]=Object(r["E"])((function(){}),["stop"]))}," Add ",40,["disabled"]),Object(r["k"])("button",{disabled:!t.currentFilter,onClick:e[10]||(e[10]=function(){return t.removeFilter&&t.removeFilter.apply(t,arguments)}),onKeydown:e[11]||(e[11]=Object(r["E"])((function(){}),["stop"]))}," Remove ",40,["disabled"]),Object(r["k"])("button",{disabled:0===t.currentFilterIdx,onClick:e[12]||(e[12]=function(e){return t.moveFilter(-1)}),onKeydown:e[13]||(e[13]=Object(r["E"])((function(){}),["stop"]))}," Move up ",40,["disabled"]),Object(r["k"])("button",{disabled:t.currentFilterIdx===t.filters.length-1||0===t.filters.length,onClick:e[14]||(e[14]=function(e){return t.moveFilter(1)}),onKeydown:e[15]||(e[15]=Object(r["E"])((function(){}),["stop"]))}," Move down ",40,["disabled"])]})),_:1}),Object(r["k"])(u,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:qn((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.filters,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{key:n,class:{choiceBtn:!0,active:n===t.currentFilterIdx},onClick:function(e){return t.selectFilter(n)}},Object(r["x"])(t.getFilterText(e)),11,["onClick"])})),128))]})),_:1}),t.currentFilter?(Object(r["p"])(),Object(r["g"])("table",yr,["drop-shadow"===t.currentFilter.type?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Object(r["k"])("tr",null,[wr,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"shadow_color",class:"color-button",style:{background:t.shadowColor},onClick:e[16]||(e[16]=function(e){return t.showShadowColor=!0})},"   ",4)])]),Object(r["k"])("tr",null,[Cr,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_x",type:"number","onUpdate:modelValue":e[17]||(e[17]=function(e){return t.shadowX=e}),onKeydown:e[18]||(e[18]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowX,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Sr,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_y",type:"number","onUpdate:modelValue":e[19]||(e[19]=function(e){return t.shadowY=e}),onKeydown:e[20]||(e[20]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowY,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Rr,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_blur",type:"number","onUpdate:modelValue":e[21]||(e[21]=function(e){return t.shadowBlur=e}),onKeydown:e[22]||(e[22]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowBlur,void 0,{number:!0}]])])])],64)):t.isPercentFilter?(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])("tr",null,[Pr,Object(r["k"])("td",null,[Object(r["k"])("input",{id:"filter_value",value:(100*t.currentFilter.value).toFixed(),type:"number",max:t.maxValue,min:t.minValue,onInput:e[23]||(e[23]=function(e){return t.setValue({value:Number(e.target.value/100)})}),onKeydown:e[24]||(e[24]=Object(r["E"])((function(){}),["stop"]))},null,40,["value","max","min"]),Tr])]),0===t.minValue&&void 0!==t.maxValue?(Object(r["p"])(),Object(r["g"])("tr",Br,[Object(r["k"])("td",Ir,[Object(r["k"])(l,{gradientStops:["#000000","#ffffff"],label:"",maxValue:t.maxValue,modelValue:100*t.currentFilter.value,"no-input":"","onUpdate:modelValue":e[25]||(e[25]=function(e){return t.setValue({value:Math.round(e)/100})})},null,8,["maxValue","modelValue"])])])):Object(r["h"])("",!0)],64)):(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[Dr,Object(r["k"])("td",null,[Object(r["k"])("input",{id:"filter_value",value:t.currentFilter.value,type:"number",max:t.maxValue,min:t.minValue,onInput:e[26]||(e[26]=function(e){return t.setValue({value:Number(e.target.value)})}),onKeydown:e[27]||(e[27]=Object(r["E"])((function(){}),["stop"]))},null,40,["value","max","min"])])]),0===t.minValue&&void 0!==t.maxValue?(Object(r["p"])(),Object(r["g"])("tr",Ar,[Object(r["k"])("td",Hr,[Object(r["k"])(l,{gradientStops:t.hueStops,label:"",maxValue:t.maxValue,modelValue:t.currentFilter.value,"no-input":"","onUpdate:modelValue":e[28]||(e[28]=function(e){return t.setValue({value:Math.round(e)})})},null,8,["gradientStops","maxValue","modelValue"]),Object(r["k"])(l,{gradientStops:t.hueStops,label:"",maxValue:t.maxValue,modelValue:t.currentFilter.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):Object(r["h"])("",!0)],64))])):Object(r["h"])("",!0)]})),_:1})]})),_:1})]})),_:1}))})),$r=Object(r["F"])("data-v-f14035dc"),Fr=$r((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:{slider:!0,vertical:t.vertical},onKeydown:e[9]||(e[9]=Object(r["E"])((function(){}),["stop"]))},[t.noInput?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("label",{key:0,for:t._.uid},Object(r["x"])(t.label),9,["for"])),Object(r["k"])("div",null,[(Object(r["p"])(),Object(r["g"])("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:e[1]||(e[1]=function(){return t.enterSlide&&t.enterSlide.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.enterSlide&&t.enterSlide.apply(t,arguments)}),onMousemove:e[3]||(e[3]=function(){return t.moveSlide&&t.moveSlide.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.moveSlide&&t.moveSlide.apply(t,arguments)}),onMouseup:e[5]||(e[5]=function(){return t.exitSlide&&t.exitSlide.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.exitSlide&&t.exitSlide.apply(t,arguments)})},[Object(r["k"])("defs",null,[Object(r["k"])("linearGradient",{id:"gradient".concat(t._.uid),x1:100*t.gradientOffset+"%",y1:"0%",x2:100*(t.gradientOffset+1)+"%",y2:"0%",spreadMethod:"repeat"},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.gradientStops,(function(e,n){return Object(r["p"])(),Object(r["g"])("stop",{key:n,offset:n/(t.gradientStops.length-1)*100+"%",style:"stop-color:"+e},null,12,["offset"])})),128))],8,["id","x1","x2"])]),Object(r["k"])("g",null,[Object(r["k"])("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:"url(#gradient".concat(t._.uid,")")},null,8,["fill"]),Object(r["k"])("path",{d:t.pointerPath,"stroke-width":"2",class:"slider-pointer"},null,8,["d"])])],544))]),t.noInput?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("input",{key:1,id:t._.uid,class:"sliderInput",min:"0",max:t.maxValue,value:t.modelValue,type:"number",onInput:e[7]||(e[7]=function(e){return t.$emit("update:modelValue",parseFloat(e.target.value))}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},null,40,["id","max","value"]))],34)})),Nr=255,Er=8,Wr=Object(r["m"])({props:{label:{type:String,required:!0},gradientStops:{required:!0},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},data:function(){return{slideActive:!1}},computed:{vertical:function(){return this.$store.state.ui.vertical},pointerPath:function(){var t=this.modelValue/this.maxValue*Nr;return"M".concat(t," 0L").concat(t+14," 0L").concat(t+7," 12Z")},gradientOffset:function(){return this.shiftGradient?0===this.modelValue?0:this.modelValue/this.maxValue:0}},methods:{enterSlide:function(t){this.slideActive=!0,this.moveSlide(t)},moveSlide:function(t){if(this.slideActive){var e=this.$refs.svg;if(e.contains(t.target)||t.target===e)if(t instanceof MouseEvent&&1!==t.which)this.slideActive=!1;else{var n=e.getBoundingClientRect(),r=n.width/(Er+Nr+Er),o=(t instanceof MouseEvent?t.clientX:t.touches[0].clientX)-n.x,a=o/r;t.preventDefault();var i=Math.max(Math.min(a-Er,Nr),0)/Nr*this.maxValue;this.$emit("update:modelValue",i)}}},exitSlide:function(){this.slideActive=!1}}});n("ae6d");Wr.render=Fr,Wr.__scopeId="data-v-f14035dc";var Mr=Wr,Vr=Object(r["F"])("data-v-8ecc10b2");Object(r["r"])("data-v-8ecc10b2");var Lr={class:"column"},Ur={class:"hex-selector"},zr=Object(r["j"])("Pick color");Object(r["q"])();var Gr=Vr((function(t,e,n,o,a,i){var c=Object(r["w"])("slider-group"),s=Object(r["w"])("d-button");return Object(r["p"])(),Object(r["g"])("div",{class:{color:!0,vertical:t.vertical}},[Object(r["k"])("h2",null,Object(r["x"])(t.title),1),Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"OK"),Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.mode="hsla"})},"HSLA")]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.mode="rgba"})},"RGBA")])])]),Object(r["k"])("div",Lr,[Object(r["k"])(c,{mode:t.mode,modelValue:t.color,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.color=e}),relative:!0},null,8,["mode","modelValue"]),Object(r["k"])("div",Ur,[Object(r["k"])("label",{class:"hex-label",for:"hex_".concat(t._.uid)},"Hex",8,["for"]),Object(r["k"])("input",{id:"hex_".concat(t._.uid),value:t.color,onInput:e[5]||(e[5]=function(){return t.updateHex&&t.updateHex.apply(t,arguments)}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},null,40,["id","value"])]),Object(r["k"])("button",{onClick:e[7]||(e[7]=function(){return t.addSwatch&&t.addSwatch.apply(t,arguments)})},"Add as swatch"),Object(r["k"])(s,{icon:"colorize",onClick:t.pickColor},{default:Vr((function(){return[zr]})),_:1},8,["onClick"])]),Object(r["k"])("div",{id:"color-swatches",class:{vertical:t.vertical}},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.swatches,(function(e){return Object(r["p"])(),Object(r["g"])("button",{class:"swatch",key:e.color,style:{backgroundColor:e.color},title:e.label,onClick:function(n){t.color=e.color,t.$emit("leave")}},null,12,["title","onClick"])})),128))],2)],2)})),qr=n("2909"),Yr=Object(r["F"])("data-v-24b7dbc3"),Xr=Yr((function(t,e,n,o,a,i){var c=Object(r["w"])("slider");return Object(r["p"])(),Object(r["g"])("div",null,[Object(r["k"])(c,{label:t.label1,modelValue:t.v1,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.v1=e}),"max-value":t.maxValue1,"gradient-stops":t.stops1},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:t.label2,modelValue:t.v2,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.v2=e}),"max-value":t.maxValue2,"gradient-stops":t.stops2},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:t.label3,modelValue:t.v3,"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.v3=e}),"max-value":t.maxValue3,"gradient-stops":t.stops3},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:"Alpha",modelValue:t.a,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.a=e}),"max-value":255,"gradient-stops":t.stopsAlpha},null,8,["modelValue","gradient-stops"])])})),Kr=n("e965"),Jr=Object(r["m"])({components:{Slider:Mr},props:{modelValue:{type:String,validator:function(t){return!!t.match(/^#[0-9a-f]{6,8}$/i)}},mode:{type:String},relative:Boolean},data:function(){return{lastRGBEmit:null,v1:0,v2:0,v3:0,a:0}},computed:{vertical:function(){return this.$store.state.ui.vertical},maxValue1:function(){return"rgba"===this.mode?255:360},label1:function(){return"rgba"===this.mode?"Red":"Hue"},stops1:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v2:0,n=this.relative?this.v3:0;t=[new yn["a"](0,e,n,1),new yn["a"](255,e,n,1)]}else{var r=this.relative?this.v2/100:1,o=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new Kr["a"](t,r,o,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue2:function(){return"rgba"===this.mode?255:100},label2:function(){return"rgba"===this.mode?"Green":"Saturation"},stops2:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v3:0;t=[new yn["a"](e,0,n,1),new yn["a"](e,255,n,1)]}else{var r=this.relative?this.v1/360:0,o=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new Kr["a"](r,t,o,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue3:function(){return"rgba"===this.mode?255:100},label3:function(){return"rgba"===this.mode?"Blue":"Luminosity"},stops3:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v2:0;t=[new yn["a"](e,n,0,1),new yn["a"](e,n,255,1)]}else{var r=this.relative?this.v1/360:0,o=this.relative?this.v2/100:.5;t=this.eightsStops((function(t){return new Kr["a"](r,o,t,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},stopsAlpha:function(){var t=yn["a"].fromHex(this.modelValue);return[new yn["a"](t.r,t.g,t.b,0).toCss(),new yn["a"](t.r,t.g,t.b,1).toCss()]}},created:function(){this.initValues()},methods:{valueChanged:function(){this.modelValue!==this.lastRGBEmit&&this.initValues()},updateValue:function(){var t;t="rgba"===this.mode?new yn["a"](this.v1,this.v2,this.v3,this.a/255):new Kr["a"](this.v1/360,this.v2/100,this.v3/100,this.a/255);var e=t.toRgb().toHex();if(this.lastRGBEmit!==e){if(9!==e.length)throw new Error("Invalid color code: ".concat(e));this.lastRGBEmit=e,this.$emit("update:modelValue",e)}},initValues:function(){var t=yn["a"].fromHex(this.modelValue);if(this.lastRGBEmit=t.toHex(),this.a=255*t.a,"hsla"===this.mode){var e=t.toHSL();this.v1=360*e.h,this.v2=100*e.s,this.v3=100*e.l}else this.v1=t.r,this.v2=t.g,this.v3=t.b},eightsStops:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}},watch:{value:function(){this.valueChanged()},v1:function(){this.updateValue()},v2:function(){this.updateValue()},v3:function(){this.updateValue()},a:function(){this.updateValue()},mode:function(){this.initValues()}}});n("02e0");Jr.render=Xr,Jr.__scopeId="data-v-24b7dbc3";var Zr=Jr,Qr="dddg.generated.colors",to=Object(r["m"])({components:{SliderGroup:Zr,DButton:It},inheritAttrs:!1,emits:["leave","update:modelValue"],props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},data:function(){return{mode:"hsla",relative:!0}},computed:{vertical:function(){return this.$store.state.ui.vertical},swatches:function(){return this.$store.state.content.current.colors},color:{get:function(){if("rgb"===this.format){var t=yn["a"].fromCss(this.modelValue);return t.toHex()}return this.modelValue},set:function(t){if("rgb"===this.format){var e=yn["a"].fromCss(t);this.$emit("update:modelValue",e.toCss())}else this.$emit("update:modelValue",t)}}},mounted:function(){at["h"].subscribe(at["b"],this.settingColor)},unmounted:function(){at["h"].unsubscribe(at["b"],this.settingColor)},methods:{settingColor:function(t){this.color=yn["a"].fromCss(t.color).toHex()},updateHex:function(t){var e=t.target.value;!yn["a"].validHex(e)||7!==e.length&&9!==e.length||(this.color=e)},addSwatch:function(){var t=this;if(!this.swatches.find((function(e){return e.color===t.color}))){var e=this.$store.state.content.contentPacks.find((function(t){return"generatedPackId"===t.packId}))||{packId:Qr,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},n=Object(ue["a"])(Object(ue["a"])({},e),{},{colors:[].concat(Object(qr["a"])(e.colors),[{label:this.color,color:this.color}])});this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:n,processed:!0})}))}},pickColor:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.commit("ui/setColorPicker",!0)}))}}});n("c185");to.render=Gr,to.__scopeId="data-v-8ecc10b2";var eo=to,no=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function ro(t,e,n){var r,o=e(t.id),a=Object(qr["a"])(o.filters);switch(t.type){case"hue-rotate":r={type:t.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:t.type,value:1};break;case"drop-shadow":r={type:t.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:an(t.type)}a.splice(t.idx,0,r),n({id:t.id,filters:a})}function oo(t,e,n){var r=e(t.id),o=Object(qr["a"])(r.filters);o.splice(t.idx,1),n({id:t.id,filters:o})}function ao(t,e,n){var r=e(t.id),o=Object(qr["a"])(r.filters),a=o[t.idx];o.splice(t.idx,1),o.splice(t.idx+t.moveBy,0,a),n({id:t.id,filters:o})}function io(t,e,n){var r=e(t.id),o=Object(qr["a"])(r.filters),a=Object(ue["a"])({},o[t.idx]);o[t.idx]=a,"drop-shadow"===a.type?(void 0!==t.blurRadius&&(a.blurRadius=t.blurRadius),void 0!==t.color&&(a.color=t.color),void 0!==t.offsetX&&(a.offsetX=t.offsetX),void 0!==t.offsetY&&(a.offsetY=t.offsetY)):a.value=t.value,n({id:t.id,filters:o})}var co=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),so=Array.from(co.keys()).sort(),uo=Object(r["m"])({components:{DFlow:de,DFieldset:Gt["a"],Color:eo,Slider:Mr,L:ot["a"]},props:{type:{type:String,required:!0},title:{type:String},id:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],data:function(){return{addEffectSelection:"",currentFilterIdx:0,showShadowColor:!1}},computed:{object:function(){switch(this.type){case"object":return this.$store.state.objects.objects[this.id];case"background":return this.$store.state.panels.panels[this.id].background;case"panel":return this.$store.state.panels.panels[this.id];default:return an(this.type),null}},compositionMode:{get:function(){return this.object.composite},set:function(t){var e=this;this.vuexHistory.transaction((function(){switch(e.type){case"object":e.$store.commit("objects/setComposition",{id:e.id,composite:t});break;case"background":break;case"panel":break;default:an(e.type);break}}))}},filters:function(){return this.object.filters},filterTypes:function(){try{var t=document.createElement("canvas"),e=t.getContext("2d");if("filter"in e)return so}catch(n){}return["opacity"]},currentFilter:function(){return this.filters[this.currentFilterIdx]||null},isPercentFilter:function(){var t=this.currentFilter;return!!t&&no.has(t.type)},maxValue:function(){var t=this.currentFilter;if(t)return"hue-rotate"===t.type?360:"grayscale"===t.type||"sepia"===t.type||"opacity"===t.type||"invert"===t.type?100:void 0},minValue:function(){var t=this.currentFilter;if(t)switch(t.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}},shadowColor:{get:function(){var t=this.currentFilter;if(t&&"color"in t)return t.color},set:function(t){this.setValue({color:t})}},shadowX:{get:function(){var t=this.currentFilter;if(t&&"offsetX"in t)return t.offsetX},set:function(t){this.setValue({offsetX:t})}},shadowY:{get:function(){var t=this.currentFilter;if(t&&"offsetY"in t)return t.offsetY},set:function(t){this.setValue({offsetY:t})}},shadowBlur:{get:function(){var t=this.currentFilter;if(t&&"blurRadius"in t)return t.blurRadius},set:function(t){this.setValue({blurRadius:t})}},hueStops:function(){var t=this.eightsStops((function(t){return new Kr["a"](t,1,.5,1)}));return t.map((function(t){return t.toRgb().toCss()}))}},methods:{getFilterLabel:function(t){return co.get(t)},getFilterText:function(t){return no.has(t.type)?"".concat(co.get(t.type)," ").concat((100*t.value).toFixed(),"%"):"hue-rotate"===t.type?"".concat(co.get(t.type)," ").concat(t.value.toFixed(),"°"):"blur"===t.type?"".concat(co.get(t.type)," ").concat(t.value.toFixed(),"px"):co.get(t.type)},objectTypeScope:function(t){switch(this.type){case"object":return"objects/"+t;case"background":return"panels/background"+t[0].toUpperCase()+t.slice(1);case"panel":return"panels/"+t}},addFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch(t.objectTypeScope("addFilter"),{id:t.id,type:t.addEffectSelection,idx:t.currentFilterIdx+1})}))},selectFilter:function(t){this.currentFilterIdx=t},removeFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch(t.objectTypeScope("removeFilter"),{id:t.id,idx:t.currentFilterIdx})}))},moveFilter:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch(e.objectTypeScope("moveFilter"),{id:e.id,idx:e.currentFilterIdx,moveBy:t}),e.currentFilterIdx+=t}))},setValue:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch(e.objectTypeScope("setFilter"),Object(ue["a"])({id:e.id,idx:e.currentFilterIdx},t))}))},eightsStops:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}}});n("80a6");uo.render=_r,uo.__scopeId="data-v-4dd06317";var lo=uo,fo=Object(r["F"])("data-v-358bd1b6");Object(r["r"])("data-v-358bd1b6");var ho={class:"column ok-col"},bo={class:"column"},po={key:0,class:"column error-col"},mo={class:"column"},vo=Object(r["k"])("p",{class:"hint-col"},"Apply style to selected text:",-1),go={class:"column"},jo={class:"column"},Oo={class:"column"},ko=Object(r["i"])('<option value data-v-358bd1b6>Font</option><option value="aller" style="font-family:aller;" data-v-358bd1b6>Aller (Textbox)</option><option value="riffic" style="font-family:riffic;" data-v-358bd1b6>Riffic (Bold text)</option><option value="hashtag" style="font-family:hashtag;" data-v-358bd1b6>Hashtag (Sayori)</option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-358bd1b6>Ammy&#39;s Handwriting (Natsuki)</option><option value="journal" style="font-family:journal;" data-v-358bd1b6>Journal (Monika)</option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-358bd1b6>JP Hand Slanted (Yuri)</option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-358bd1b6>Damagrafik (Yuri, Act 2)</option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-358bd1b6>As I Lay Dying (Yuri, Act Unused)</option><option value="halogen" style="font-family:halogen;" data-v-358bd1b6>Halogen (MC)</option>',10);Object(r["q"])();var xo=fo((function(t,e,n,o,a,i){var c=Object(r["w"])("color");return t.colorSelector?(Object(r["p"])(),Object(r["g"])(c,{key:0,modelValue:t.selectedColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.selectedColor=e}),onLeave:t.applyColor},null,8,["modelValue","onLeave"])):(Object(r["p"])(),Object(r["g"])("div",{key:1,class:{"text-subpanel":!0,vertical:t.vertical}},[Object(r["k"])("h2",null,Object(r["x"])(t.title),1),Object(r["k"])("div",ho,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},"OK")]),Object(r["k"])("div",bo,[Object(r["k"])("textarea",{ref:"textArea",value:t.modelValue,onInput:e[3]||(e[3]=function(){return t.onValueChanged&&t.onValueChanged.apply(t,arguments)}),onKeydown:e[4]||(e[4]=Object(r["E"])((function(){}),["stop"])),onKeypress:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},null,40,["value"])]),t.error?(Object(r["p"])(),Object(r["g"])("div",po,Object(r["x"])(t.error),1)):Object(r["h"])("",!0),Object(r["k"])("div",mo,[Object(r["k"])("button",{onClick:e[6]||(e[6]=function(e){return t.insertText("\\\\")}),class:"style-button"},"Insert \\"),Object(r["k"])("button",{onClick:e[7]||(e[7]=function(e){return t.insertText("\\{")}),class:"style-button"},"Insert {"),Object(r["k"])("button",{onClick:e[8]||(e[8]=function(e){return t.insertText("\\}")}),class:"style-button"},"Insert }")]),vo,Object(r["k"])("div",go,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(e){return t.insertCommand("b")}),class:"style-button",style:{"font-weight":"bold"}}," Bold "),Object(r["k"])("button",{onClick:e[10]||(e[10]=function(e){return t.insertCommand("i")}),class:"style-button",style:{"font-style":"italic"}}," Italics "),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(e){return t.insertCommand("plain")}),class:"style-button"}," Plain "),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(e){return t.insertCommand("edited")}),class:"style-button edited-style"}," Edited "),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(e){return t.insertCommand("k",2)}),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),Object(r["k"])("div",jo,[Object(r["k"])("button",{onClick:e[14]||(e[14]=function(e){return t.insertCommand("alpha",.5)}),class:"style-button"}," Alpha ")]),Object(r["k"])("div",Oo,[Object(r["k"])("button",{onClick:e[15]||(e[15]=function(e){return t.insertCommand("size",12)}),class:"style-button",style:{"font-size":"20px"}}," Font size "),Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[16]||(e[16]=function(e){return t.selectedFont=e}),class:"style-button"},[ko],512),[[r["z"],t.selectedFont]]),Object(r["k"])("button",{onClick:e[17]||(e[17]=function(e){return t.selectColor("text")}),class:"style-button"}," Text color "),Object(r["k"])("button",{onClick:e[18]||(e[18]=function(e){return t.selectColor("outline")}),class:"style-button"}," Outline color ")])],2))})),yo=Object(r["m"])({inheritAttrs:!1,components:{Color:eo},props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},data:function(){return{colorSelector:"",selectedFont:"",selectedColor:"#000000",rememberedStart:0,rememberedEnd:0,error:""}},computed:{vertical:function(){return this.$store.state.ui.vertical}},watch:{selectedFont:function(){""!==this.selectedFont&&(this.insertCommand("font",this.selectedFont),this.selectedFont="")}},methods:{onValueChanged:function(){var t=Object(We["a"])(),e=this.$refs.textArea.value;try{new cn(e,t.TextBox.NameboxTextStyle),this.error=""}catch(n){this.error=n.message}this.$emit("update:modelValue",e)},selectColor:function(t){var e=this.$refs.textArea;this.colorSelector=t,this.rememberedStart=e.selectionStart,this.rememberedEnd=e.selectionEnd},applyColor:function(){var t=this,e=this.selectedColor,n=this.colorSelector,r=function r(){var o=t.$refs.textArea;o?(o.selectionStart=t.rememberedStart,o.selectionEnd=t.rememberedEnd,t.insertCommand("text"===n?"color":"outlinecolor",e)):t.$nextTick(r)};this.$nextTick(r),this.selectedColor="#000000",this.colorSelector=""},insertText:function(t){var e=this.$refs.textArea,n=e.value,r=e.selectionStart,o=e.selectionEnd;e.value=n.slice(0,r)+t+n.slice(o),e.selectionStart=e.selectionEnd=r+t.length,e.focus(),this.onValueChanged()},insertCommand:function(t,e){var n=this.$refs.textArea,r=n.value,o=n.selectionStart,a=n.selectionEnd,i=r.slice(o,a),c=r.slice(0,o),s=r.slice(a),u=t;e&&(u+="="+e),n.value="".concat(c,"{").concat(u,"}").concat(i,"{/").concat(t,"}").concat(s),n.selectionStart=o+u.length+2,n.selectionEnd=n.selectionStart+i.length,n.focus(),this.onValueChanged()}}});n("b35b");yo.render=xo,yo.__scopeId="data-v-358bd1b6";var wo=yo,Co=be(),So=Object(r["m"])({mixins:[J],components:{Toggle:X["a"],PositionAndSize:_n,Layers:Ln,Delete:Gn,TextEditor:wo,ImageOptions:lo,Color:eo,ModalDialog:rt,DFieldset:Gt["a"]},props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},data:function(){return{imageOptionsOpen:!1,canEdit:!0,modalNameInput:"",showRename:!1,localColorHandler:null}},computed:{flip:Co("flip","objects/setFlip"),rotation:Co("rotation","objects/setRotation"),enlargeWhenTalking:Co("enlargeWhenTalking","objects/setEnlargeWhenTalking"),nameboxWidth:{get:function(){var t=this.object.nameboxWidth;return null===t?"":t+""},set:function(t){var e=this,n=""===t.trim()?null:parseInt(t);this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("objects/setObjectNameboxWidth",{id:e.object.id,nameboxWidth:n});case 1:case"end":return t.stop()}}),t)}))))}},zoom:{get:function(){return 100*this.object.zoom},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("objects/setObjectZoom",{id:e.object.id,zoom:t/100});case 1:case"end":return n.stop()}}),n)}))))}},defaultNameboxWidth:function(){return Object(We["a"])().TextBox.NameboxWidth},finalColorHandler:function(){return this.localColorHandler||this.colorHandler||null},hasLabel:function(){return null!==this.object.label},heading:function(){return console.log("heading",this.object.label,this.title,"Object"),this.object.label||this.title||"Object"},useCustomTextboxColor:{get:function(){return null!==this.object.textboxColor},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("objects/setTextboxColor",{id:e.object.id,textboxColor:t?Object(We["a"])().TextBoxCustom.textboxDefaultColor:null});case 1:case"end":return n.stop()}}),n)}))))}}},methods:{copy:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/copyObjectToClipboard",{id:t.object.id});case 1:case"end":return e.stop()}}),e)}))))},enableNameEdit:function(){this.modalNameInput=this.object.label||"",this.showRename=!0},renameOption:function(t){var e=this;this.showRename=!1,"Apply"===t&&this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("objects/setLabel",{id:e.object.id,label:e.modalNameInput});case 1:case"end":return t.stop()}}),t)}))))},selectTextboxColor:function(){var t=this;this.localColorHandler={title:"Textbox color",get:function(){return t.object.textboxColor},set:function(e){t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$store.commit("objects/setTextboxColor",{id:t.object.id,textboxColor:e});case 1:case"end":return n.stop()}}),n)}))))},leave:function(){t.localColorHandler=null}}}}});n("cf9e"),n("a319");So.render=Re,So.__scopeId="data-v-16d40063";var Ro=So,Po=be(),To=Object(r["m"])({mixins:[J],components:{Toggle:X["a"],Parts:he,DFieldset:Gt["a"],ObjectTool:Ro},data:function(){return{panelForParts:null}},computed:{flip:Po("flip","objects/setFlip"),closeUp:Po("close","objects/setClose"),selection:function(){return this.$store.state.ui.selection},object:function(){var t=this.$store.state.objects.objects[this.selection];if("character"===t.type)return t},charData:function(){return Object(zt["e"])(this.$store,this.object)},label:function(){return this.charData.label||""},parts:function(){return Object(zt["g"])(this.charData,this.object)},hasMultipleStyles:function(){return this.charData.styleGroups[this.object.styleGroupId].styles.length>1||this.charData.styleGroups.length>1},hasMultiplePoses:function(){var t=this.charData.styleGroups[this.object.styleGroupId],e=t.styles[this.object.styleId];return e.poses.length>1}},methods:{seekPose:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekPose",{id:e.object.id,delta:t})}))},seekStyle:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekStyle",{id:e.object.id,delta:t})}))},seekPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/seekPart",{id:n.object.id,delta:e,part:t})}))},captialize:function(t){return t.charAt(0).toUpperCase()+t.substring(1)}},watch:{selection:function(){this.panelForParts=null}}});n("dd24");To.render=Ut,To.__scopeId="data-v-47403597";var Bo=To;function Io(t,e,n,o,a,i){var c=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(c,{object:t.object,title:"Custom Sprite"},null,8,["object"])}var Do=Object(r["m"])({mixins:[J],components:{ObjectTool:Ro},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("sprite"===t.type)return t}}});Do.render=Io;var Ao=Do,Ho=Object(r["F"])("data-v-fb44b570");Object(r["r"])("data-v-fb44b570");var _o={class:"upper-combos"},$o=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"text_style"},"Style:")],-1),Fo={colspan:"2"},No=Object(r["k"])("option",{value:"normal"},"Normal",-1),Eo=Object(r["k"])("option",{value:"corrupt"},"Corrupt",-1),Wo=Object(r["k"])("option",{value:"custom"},"Custom",-1),Mo=Object(r["k"])("option",{value:"custom_plus"},"Custom (Plus)",-1),Vo=Object(r["k"])("option",{value:"none"},"None",-1),Lo=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"current_talking"},"Person talking:")],-1),Uo=Object(r["k"])("option",{value:"$null$"},"No-one",-1),zo=Object(r["k"])("option",{value:"$other$"},"Other",-1),Go=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_name"},"Other name:")],-1),qo={id:"dialog_text_wrapper"},Yo=Object(r["k"])("label",{for:"dialog_text"},"Dialog:",-1),Xo={key:0},Ko=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_width"},"Namebox width:")],-1),Jo={colspan:"2"},Zo={key:0},Qo=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"textbox_color"},"Color:")],-1),ta={key:1},ea={colspan:"2"},na=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_controls_color"},"Controls Color:")],-1),ra=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_color"},"Namebox Color:")],-1),oa=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1);Object(r["q"])();var aa=Ho((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset"),d=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(d,{object:t.object,title:"Textbox",textHandler:t.textHandler,colorHandler:t.colorHandler},{default:Ho((function(){return[Object(r["k"])("table",_o,[Object(r["k"])("tr",null,[$o,Object(r["k"])("td",Fo,[Object(r["D"])(Object(r["k"])("select",{id:"text_style","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.textBoxStyle=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},[No,Eo,Wo,Mo,Vo],544),[[r["z"],t.textBoxStyle]])])]),Object(r["k"])("tr",null,[Lo,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"current_talking","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.talkingObjId=e}),onKeydown:e[4]||(e[4]=Object(r["E"])((function(){}),["stop"]))},[Uo,(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.nameList,(function(t){var e=Object(l["a"])(t,2),n=e[0],o=e[1];return Object(r["p"])(),Object(r["g"])("option",{key:n,value:n},Object(r["x"])(o),9,["value"])})),128)),zo],544),[[r["z"],t.talkingObjId]])]),Object(r["k"])("td",null,[Object(r["k"])("button",{title:"Jump to talking character",onClick:e[5]||(e[5]=function(){return t.jumpToCharacter&&t.jumpToCharacter.apply(t,arguments)}),disabled:"$null$"===t.talkingObjId||"$other$"===t.talkingObjId}," > ",8,["disabled"])])]),Object(r["k"])("tr",null,[Go,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"custom_name","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.talkingOther=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.talkingOther]])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[8]||(e[8]=function(e){return t.textEditor="name"})},"...")])])]),Object(r["k"])(c,{label:"Auto quoting?",modelValue:t.autoQuoting,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.autoQuoting=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),Object(r["k"])("div",qo,[Yo,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[11]||(e[11]=function(e){return t.dialog=e}),id:"dialog_text",onKeydown:e[12]||(e[12]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.dialog]]),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(e){return t.textEditor="body"})},"Formatting")])]})),options:Ho((function(){return[Object(r["k"])(u,{title:"Customization:",class:t.customizable?"customization-set":""},{default:Ho((function(){return[Object(r["k"])(s,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:Ho((function(){return[Object(r["k"])(c,{label:"Controls visible?",modelValue:t.showControls,"onUpdate:modelValue":e[14]||(e[14]=function(e){return t.showControls=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Able to skip?",modelValue:t.allowSkipping,"onUpdate:modelValue":e[15]||(e[15]=function(e){return t.allowSkipping=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Continue arrow?",modelValue:t.showContinueArrow,"onUpdate:modelValue":e[16]||(e[16]=function(e){return t.showContinueArrow=e})},null,8,["modelValue"]),t.customizable?(Object(r["p"])(),Object(r["g"])("table",Xo,[Object(r["k"])("tr",null,[Ko,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:t.nameboxWidthDefault,"onUpdate:modelValue":e[17]||(e[17]=function(e){return t.customNameboxWidth=e}),disabled:t.overrideColor,onKeydown:e[18]||(e[18]=Object(r["E"])((function(){}),["stop"]))},null,40,["placeholder","disabled"]),[[r["A"],t.customNameboxWidth,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",Jo,[Object(r["k"])(c,{modelValue:t.overrideColor,"onUpdate:modelValue":e[19]||(e[19]=function(e){return t.overrideColor=e}),label:"Override color"},null,8,["modelValue"])])]),t.overrideColor?(Object(r["p"])(),Object(r["g"])("tr",Zo,[Qo,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"textbox_color",class:"color-button",style:{background:t.object.customColor},onClick:e[20]||(e[20]=function(e){return t.colorSelect="base"})},null,4)])])):Object(r["h"])("",!0),t.overrideColor?(Object(r["p"])(),Object(r["g"])("tr",ta,[Object(r["k"])("td",ea,[Object(r["k"])(c,{id:"derive_custom_colors",modelValue:t.deriveCustomColors,"onUpdate:modelValue":e[21]||(e[21]=function(e){return t.deriveCustomColors=e}),label:"Derive other colors"},null,8,["modelValue"])])])):Object(r["h"])("",!0),t.overrideColor&&!t.deriveCustomColors?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[na,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_controls_color",class:"color-button",style:{background:t.object.customControlsColor},onClick:e[22]||(e[22]=function(e){return t.colorSelect="controls"})},null,4)])]),Object(r["k"])("tr",null,[ra,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_namebox_color",class:"color-button",style:{background:t.object.customNameboxColor},onClick:e[23]||(e[23]=function(e){return t.colorSelect="namebox"})},null,4)])]),Object(r["k"])("tr",null,[oa,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_namebox_stroke",class:"color-button",style:{background:t.object.customNameboxStroke},onClick:e[24]||(e[24]=function(e){return t.colorSelect="nameboxStroke"})},null,4)])])],64)):Object(r["h"])("",!0)])):Object(r["h"])("",!0)]})),_:1})]})),_:1},8,["class"]),Object(r["k"])("button",{onClick:e[25]||(e[25]=function(){return t.resetPosition&&t.resetPosition.apply(t,arguments)})},"Reset position"),Object(r["k"])("button",{onClick:e[26]||(e[26]=function(){return t.splitTextbox&&t.splitTextbox.apply(t,arguments)})},"Split textbox")]})),_:1},8,["object","textHandler","colorHandler"])})),ia=(n("2ca0"),be()),ca=Object(r["m"])({components:{Toggle:X["a"],DFieldset:Gt["a"],ObjectTool:Ro,DFlow:de},mixins:[J],data:function(){return{textEditor:"",colorSelect:""}},computed:{customizable:function(){return this.textBoxStyle.startsWith("custom")},nameboxWidthDefault:function(){return Object(We["a"])().TextBox.NameboxWidth},object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("textBox"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:this.textEditorName,get:function(){return"name"===t.textEditor?t.object.talkingOther:"body"===t.textEditor?t.dialog:""},set:function(e){"name"===t.textEditor?t.talkingOther=e:"body"===t.textEditor&&(t.dialog=e)},leave:function(){t.textEditor=""}}},colorHandler:function(){var t=this;if(this.colorSelect)return{title:this.colorName,get:function(){switch(t.colorSelect){case"":return"#000000";case"base":return t.object.customColor;case"controls":return t.object.customControlsColor;case"namebox":return t.object.customNameboxColor;case"nameboxStroke":return t.object.customNameboxStroke;default:return an(t.colorSelect),""}},set:function(e){t.vuexHistory.transaction((function(){switch(t.colorSelect){case"":return;case"base":return void t.$store.commit("objects/setCustomColor",{id:t.object.id,color:e});case"controls":return void t.$store.commit("objects/setControlsColor",{id:t.object.id,customControlsColor:e});case"namebox":return void t.$store.commit("objects/setNameboxColor",{id:t.object.id,customNameboxColor:e});case"nameboxStroke":return void t.$store.commit("objects/setNameboxStroke",{id:t.object.id,customNameboxStroke:e})}}))},leave:function(){t.colorSelect=""}}},talkingObjId:{get:function(){return this.object.talkingObjId||"$null$"},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setTalkingObject",{id:e.object.id,talkingObjId:"$null$"===t?null:t})}))}},talkingOther:ia("talkingOther","objects/setTalkingOther"),showControls:ia("controls","objects/setControlsVisible"),allowSkipping:ia("skip","objects/setSkipable"),autoQuoting:ia("autoQuoting","objects/setAutoQuoting"),autoWrap:ia("autoWrap","objects/setAutoWrapping"),showContinueArrow:ia("continue","objects/setContinueArrow"),dialog:ia("text","objects/setText"),textBoxStyle:ia("style","objects/setStyle",!0),overrideColor:ia("overrideColor","objects/setColorOverride"),deriveCustomColors:ia("deriveCustomColors","objects/setDeriveCustomColors"),customNameboxWidth:ia("customNameboxWidth","objects/setNameboxWidth"),nameList:function(){for(var t=this.$store.state.objects.panels[this.$store.state.panels.currentPanel],e=[],n=0,r=[].concat(Object(qr["a"])(t.order),Object(qr["a"])(t.onTopOrder));n<r.length;n++){var o=r[n],a=this.$store.state.objects.objects[o];null!==a.label&&e.push([o,a.label])}return e},textEditorName:function(){return"name"===this.textEditor?"Name":"body"===this.textEditor?"Dialog":""},customControlsColor:function(){return this.object.customControlsColor},colorName:function(){switch(this.colorSelect){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:return an(this.colorSelect),""}}},methods:{splitTextbox:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/splitTextbox",{id:t.object.id})}))},resetPosition:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/resetTextboxBounds",{id:t.object.id})}))},jumpToCharacter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.commit("ui/setSelection",t.talkingObjId)}))}}});n("6307");ca.render=aa,ca.__scopeId="data-v-fb44b570";var sa=ca,ua=Object(r["F"])("data-v-6218d3d4");Object(r["r"])("data-v-6218d3d4");var la=Object(r["k"])("tr",null,[Object(r["k"])("td",{colspan:"2"},[Object(r["k"])("label",{for:"choice-button-input"},"Text")])],-1);Object(r["q"])();var da=ua((function(t,e,n,o,a,i){var c=Object(r["w"])("d-flow"),s=Object(r["w"])("d-fieldset"),u=Object(r["w"])("toggle"),l=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(l,{object:t.object,title:"Choice",textHandler:t.textHandler},{default:ua((function(){return[Object(r["k"])(s,{class:"buttons",title:"Buttons:"},{default:ua((function(){return[Object(r["k"])(c,{maxSize:"100%",direction:"vertical",noWraping:""},{default:ua((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.buttons,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{class:{choiceBtn:!0,active:n===t.currentIdx},key:n,onClick:function(e){return t.select(n)}},Object(r["x"])(""===e.text.trim()?"[Empty]":e.text),11,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["k"])(s,{class:"current_button",title:"Current button:"},{default:ua((function(){return[Object(r["k"])("table",null,[la,Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"choice-button-input","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.buttonText=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.buttonText]])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"...")])])])]})),_:1}),Object(r["k"])("button",{onClick:e[4]||(e[4]=function(){return t.addChoice&&t.addChoice.apply(t,arguments)})},"Add"),Object(r["k"])("button",{onClick:e[5]||(e[5]=function(){return t.removeChoice&&t.removeChoice.apply(t,arguments)})},"Remove"),Object(r["k"])(u,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.autoWrap=e})},null,8,["modelValue"])]})),_:1},8,["object","textHandler"])})),fa=be(),ha=Object(r["m"])({mixins:[J],components:{Toggle:X["a"],DFieldset:Gt["a"],DFlow:de,ObjectTool:Ro},data:function(){return{currentIdx:0,textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("choice"===t.type)return t},autoWrap:fa("autoWrap","objects/setAutoWrapping"),buttonText:ba("text","objects/setChoiceText",!0),buttons:function(){return this.object.choices},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.buttonText},set:function(e){t.buttonText=e},leave:function(){t.textEditor=!1}}}},methods:{select:function(t){this.currentIdx=t},addChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/addChoice",{id:t.object.id,text:""})}))},removeChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.currentIdx===t.object.choices.length-1&&t.currentIdx>0&&t.select(t.currentIdx-1),t.$store.dispatch("objects/removeChoice",{id:t.object.id,choiceIdx:t.currentIdx})}))}}});function ba(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object.choices[this.currentIdx][t]},set:function(r){var o=this;this.vuexHistory.transaction((function(){o.$store[n?"dispatch":"commit"](e,Object(se["a"])({id:o.object.id,choiceIdx:o.currentIdx},t,r))}))}}}n("5c35");ha.render=da,ha.__scopeId="data-v-6218d3d4";var pa=ha,ma=Object(r["F"])("data-v-753d2b9a");Object(r["r"])("data-v-753d2b9a");var va={class:"panel"},ga=Object(r["k"])("h1",null,"Help and Credits",-1),ja=Object(r["j"])("Help"),Oa=Object(r["j"])("Fork me on GitHub"),ka=Object(r["j"])("Privacy Statement"),xa=Object(r["k"])("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1),ya=Object(r["k"])("p",null,[Object(r["j"])(" Doki Doki Dialog Generator developed by EDave64 "),Object(r["k"])("br"),Object(r["j"])("Based on gemdude46's DDLC Shitpost generator ")],-1),wa=Object(r["j"])(" Unused House Background by "),Ca=Object(r["j"])(" Fatelogic "),Sa=Object(r["j"])(" Aller Font by "),Ra=Object(r["j"])("Dalton Maag Ltd"),Pa=Object(r["j"])(" Riffic Bold Font by "),Ta=Object(r["j"])("InkyType"),Ba=Object(r["j"])(" Verily Serif Mono Font by "),Ia=Object(r["j"])("Stephen G. Hartke"),Da=Object(r["j"])(" F25 Bank Printer Font by "),Aa=Object(r["j"])("F25 Digital Typeface Design"),Ha=Object(r["j"])(" Journal Font by "),_a=Object(r["j"])("Fontourist"),$a=Object(r["j"])(" Hashtag Font by "),Fa=Object(r["j"])(" TitanVex"),Na=Object(r["j"])(" JP Hand Slanted Font by "),Ea=Object(r["j"])("Jonathan Paterson"),Wa=Object(r["j"])(" As I Lay Dying Font by "),Ma=Object(r["j"])("Moises Esqueda"),Va=Object(r["j"])(" Damagrafik Script Font by "),La=Object(r["j"])("Davide Terenzi"),Ua=Object(r["j"])(" Ammy's Handwriting Font by "),za=Object(r["j"])("Ammy K."),Ga=Object(r["j"])(" Halogen Font by "),qa=Object(r["j"])("JLH Fonts"),Ya=Object(r["i"])("<p data-v-753d2b9a> MC Classic Sprite by Childish-N <br data-v-753d2b9a>MC Classic Chibi by GyleToTheRescue </p><p data-v-753d2b9a> MC Sprite by Childish-N <br data-v-753d2b9a>MC Casual Sprite by SlightlySimple <br data-v-753d2b9a>MC Chibi by SlightlySimple </p><p data-v-753d2b9a> MC Chad Sprite by Cylent-Nite <br data-v-753d2b9a>MC Chad Poses and expressions by SlightlySimple <br data-v-753d2b9a>MC Chad Poses and chibi by Meddy-sin </p><p data-v-753d2b9a> FeMC Sprite by Meddy-sin <br data-v-753d2b9a>FeMC Casual Sprite by SlightlySimple </p><p data-v-753d2b9a>Classic Amy Sprite by Meddy-sin</p><p data-v-753d2b9a>Amy Sprite by Meddy-sin and SlightlySimple</p><p data-v-753d2b9a>Special thanks to SlightlySimple for testing and technical help</p><p data-v-753d2b9a> Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing </p>",8);Object(r["q"])();var Xa=ma((function(t,e,n,o,a,i){var c=Object(r["w"])("l");return Object(r["p"])(),Object(r["g"])("div",va,[ga,Object(r["k"])(c,{class:"btn",to:"wiki://Dokumentation"},{default:ma((function(){return[ja]})),_:1}),Object(r["k"])(c,{class:"btn",to:"github://"},{default:ma((function(){return[Oa]})),_:1}),Object(r["k"])(c,{class:"btn",to:"wiki://Privacy Statement"},{default:ma((function(){return[ka]})),_:1}),xa,ya,Object(r["k"])("p",null,[wa,Object(r["k"])(c,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:ma((function(){return[Ca]})),_:1})]),Object(r["k"])("p",null,[Sa,Object(r["k"])(c,{to:"https://www.daltonmaag.com/library/aller"},{default:ma((function(){return[Ra]})),_:1})]),Object(r["k"])("p",null,[Pa,Object(r["k"])(c,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:ma((function(){return[Ta]})),_:1})]),Object(r["k"])("p",null,[Ba,Object(r["k"])(c,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:ma((function(){return[Ia]})),_:1})]),Object(r["k"])("p",null,[Da,Object(r["k"])(c,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:ma((function(){return[Aa]})),_:1})]),Object(r["k"])("p",null,[Ha,Object(r["k"])(c,{to:"https://www.dafont.com/journal.font"},{default:ma((function(){return[_a]})),_:1})]),Object(r["k"])("p",null,[$a,Object(r["k"])(c,{to:"https://www.dafont.com/hashtag.font"},{default:ma((function(){return[Fa]})),_:1})]),Object(r["k"])("p",null,[Na,Object(r["k"])(c,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:ma((function(){return[Ea]})),_:1})]),Object(r["k"])("p",null,[Wa,Object(r["k"])(c,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:ma((function(){return[Ma]})),_:1})]),Object(r["k"])("p",null,[Va,Object(r["k"])(c,{to:"https://www.dafont.com/damagrafik-script.font"},{default:ma((function(){return[La]})),_:1})]),Object(r["k"])("p",null,[Ua,Object(r["k"])(c,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:ma((function(){return[za]})),_:1})]),Object(r["k"])("p",null,[Ga,Object(r["k"])(c,{to:"https://www.dafont.com/halogen.font"},{default:ma((function(){return[qa]})),_:1})]),Ya])})),Ka=Object(r["m"])({mixins:[J],components:{L:ot["a"]}});n("6a18");Ka.render=Xa,Ka.__scopeId="data-v-753d2b9a";var Ja=Ka,Za=Object(r["F"])("data-v-42a773bc");Object(r["r"])("data-v-42a773bc");var Qa=Object(r["j"])("Drop here to add as a new background"),ti=Object(r["k"])("h1",null,"Background",-1),ei=Object(r["j"])(" Upload "),ni=Object(r["k"])("i",{class:"material-icons"},"extension",-1),ri=Object(r["j"])(" Search in content packs "),oi=Object(r["j"])(" Open sprites folder ");Object(r["q"])();var ai=Za((function(t,e,n,o,a,i){var c=Object(r["w"])("drop-target"),s=Object(r["w"])("color"),u=Object(r["w"])("image-options"),l=Object(r["w"])("background-settings"),d=Object(r["w"])("d-button"),f=Object(r["w"])("background-button");return Object(r["p"])(),Object(r["g"])("div",{class:"panel",onDragenter:e[10]||(e[10]=function(){return t.dragEnter&&t.dragEnter.apply(t,arguments)}),onMouseleave:e[11]||(e[11]=function(e){return t.$refs.dt.hide()})},[Object(r["k"])(c,{ref:"dt",class:"drop-target",onDrop:t.addImageFile},{default:Za((function(){return[Qa]})),_:1},8,["onDrop"]),ti,t.colorSelect?(Object(r["p"])(),Object(r["g"])(s,{key:0,modelValue:t.bgColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.bgColor=e}),onLeave:e[2]||(e[2]=function(e){return t.colorSelect=!1})},null,8,["modelValue"])):t.imageOptions?(Object(r["p"])(),Object(r["g"])(u,{key:1,type:"background",title:"",id:t.$store.state.panels.currentPanel,"no-composition":"",onLeave:e[3]||(e[3]=function(e){return t.imageOptions=!1})},null,8,["id"])):(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])(l,{onChangeColor:e[4]||(e[4]=function(e){return t.colorSelect=!0}),onOpenImageOptions:e[5]||(e[5]=function(e){return t.imageOptions=!0})}),Object(r["k"])("div",{class:"btn upload-background",onClick:e[7]||(e[7]=function(e){return t.$refs.upload.click()})},[ei,Object(r["k"])("input",{type:"file",ref:"upload",onChange:e[6]||(e[6]=function(){return t.onFileUpload&&t.onFileUpload.apply(t,arguments)})},null,544)]),Object(r["k"])("button",{class:"upload-background",onClick:e[8]||(e[8]=function(){return t.addByUrl&&t.addByUrl.apply(t,arguments)})},"Add by URL"),Object(r["k"])("button",{class:"upload-background",onClick:e[9]||(e[9]=function(e){return t.$emit("show-dialog","type: Backgrounds")})},[ni,ri]),t.showBackgroundsFolder?(Object(r["p"])(),Object(r["g"])(d,{key:0,icon:"folder",class:"upload-background",onClick:t.openBackgroundFolder},{default:Za((function(){return[oi]})),_:1},8,["onClick"])):Object(r["h"])("",!0),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.backgrounds,(function(e){return Object(r["p"])(),Object(r["g"])(f,{key:e,backgroundId:e,onInput:function(n){return t.setBackground(e)}},null,8,["backgroundId","onInput"])})),128))],64))],32)})),ii=Object(r["F"])("data-v-09138076"),ci=ii((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:{background:!0,active:t.isActive},title:t.title,style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("input",t.backgroundId)})},Object(r["x"])(t.title),15,["title"])})),si=Object(r["m"])({props:{backgroundId:{type:String,required:!0}},data:function(){return{isWebPSupported:null,assets:[]}},computed:{background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this.$store.getters["content/getBackgrounds"];return t.get(this.backgroundId)||null},isActive:function(){return this.backgroundId===this.background.current},title:function(){switch(this.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return this.bgData.label||""},style:function(){switch(this.backgroundId){case"buildin.static-color":return{"background-color":this.background.color};case"buildin.transparent":return{}}var t=this.assets.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src,"')")})).join(",");return{backgroundImage:t}}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.bgData){e.next=4;break}return e.next=3,Promise.all(t.bgData.variants[0].map((function(t){return Object(wt["a"])(t,!1)})));case 3:t.assets=e.sent;case 4:case"end":return e.stop()}}),e)})))()}});n("6f08");si.render=ci,si.__scopeId="data-v-09138076";var ui=si,li=Object(r["F"])("data-v-99a6545a");Object(r["r"])("data-v-99a6545a");var di=Object(r["k"])("label",{for:"bg_color"},"Color:",-1),fi={key:1},hi={colspan:"3"},bi={key:0},pi={class:"arrow-col"},mi=Object(r["k"])("td",{style:{"text-align":"center"}},"Variant",-1),vi={class:"arrow-col"},gi={colspan:"3"},ji=Object(r["k"])("option",{value:"0"},"None",-1),Oi=Object(r["k"])("option",{value:"1"},"Stretch",-1),ki=Object(r["k"])("option",{value:"2"},"Cover",-1),xi={colspan:"3"};Object(r["q"])();var yi=li((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{class:{"bg-settings":!0,vertical:t.vertical},title:"Settings:"},{default:li((function(){return[t.isColor?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[di,Object(r["k"])("button",{id:"bg_color",class:"color-button",style:{background:t.color},onClick:e[1]||(e[1]=function(e){return t.$emit("change-color")})},null,4)],64)):Object(r["h"])("",!0),t.isVariant?(Object(r["p"])(),Object(r["g"])("table",fi,[Object(r["k"])("tr",null,[Object(r["k"])("td",hi,[Object(r["k"])(c,{modelValue:t.flipped,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.flipped=e}),label:"Flipped?"},null,8,["modelValue"])])]),t.hasVariants?(Object(r["p"])(),Object(r["g"])("tr",bi,[Object(r["k"])("td",pi,[Object(r["k"])("button",{class:"small-button",onClick:e[3]||(e[3]=function(e){return t.seekVariant(-1)})},"<")]),mi,Object(r["k"])("td",vi,[Object(r["k"])("button",{class:"small-button",onClick:e[4]||(e[4]=function(e){return t.seekVariant(1)})},">")])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[Object(r["k"])("td",gi,[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.scaling=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},[ji,Oi,ki],544),[[r["z"],t.scaling]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",xi,[Object(r["k"])("button",{id:"image_options_button",onClick:e[7]||(e[7]=function(e){return t.$emit("open-image-options")})}," Image options ")])])])):Object(r["h"])("",!0)]})),_:1},8,["class"])})),wi=(n("25f0"),Object(r["m"])({components:{Toggle:X["a"],DFieldset:Gt["a"]},computed:{vertical:function(){return this.$store.state.ui.vertical},color:{get:function(){return this.background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},flipped:{get:function(){return this.background.flipped},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundFlipped",{flipped:t,panelId:e.$store.state.panels.currentPanel})}))}},scaling:{get:function(){return this.background.scaling.toString()},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundScaling",{scaling:parseInt(t,10),panelId:e.$store.state.panels.currentPanel})}))}},currentBackgroundId:function(){return this.background.current},background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this;return this.$store.state.content.current.backgrounds.find((function(e){return e.id===t.currentBackgroundId}))||null},isColor:function(){return"buildin.static-color"===this.currentBackgroundId},isVariant:function(){return!!this.bgData},hasVariants:function(){return!!this.bgData&&this.bgData.variants.length>1}},methods:{seekVariant:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("panels/seekBackgroundVariant",{delta:t,panelId:e.$store.state.panels.currentPanel})}))}}}));n("5b30");wi.render=yi,wi.__scopeId="data-v-99a6545a";var Ci=wi,Si={packId:"dddg.buildin.uploadedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},Ri=Object(r["m"])({mixins:[J],components:{BackgroundButton:ui,BackgroundSettings:Ci,DropTarget:Ct["a"],Color:eo,ImageOptions:lo,DButton:It},data:function(){return{colorSelect:!1,imageOptions:!1}},computed:{bgColor:{get:function(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel].background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},backgrounds:function(){return[].concat(Object(qr["a"])(this.$store.state.content.current.backgrounds.map((function(t){return t.id}))),["buildin.static-color","buildin.transparent"])},showBackgroundsFolder:function(){return Z["a"].supports.openableFolders.has("backgrounds")}},methods:{setBackground:function(t){this.$store.commit("panels/setCurrentBackground",{current:t,panelId:this.$store.state.panels.currentPanel})},onFileUpload:function(t){var e=this.$refs.upload;if(e.files){var n,r=Object(yt["a"])(e.files);try{for(r.s();!(n=r.n()).done;){var o=n.value;this.addImageFile(o)}}catch(a){r.e(a)}finally{r.f()}}},addImageFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomBackground(t.name,t.name,e)},addByUrl:function(){var t=prompt("Enter the URL of the image");if(t){var e=t.split("/").slice(-1)[0];this.addNewCustomBackground(e,e,t)}},addNewCustomBackground:function(t,e,n){var r=this;Si.backgrounds.push({id:t,label:e,variants:[[n]],scaling:"none"}),this.vuexHistory.transaction((function(){r.$store.dispatch("content/replaceContentPack",{contentPack:Si}),r.setBackground(t)}))},dragEnter:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link",this.$refs.dt.show()))},openBackgroundFolder:function(){Z["a"].openFolder("backgrounds")}}});n("b8e2");Ri.render=ai,Ri.__scopeId="data-v-42a773bc";var Pi=Ri,Ti=Object(r["F"])("data-v-714ad0fa");Object(r["r"])("data-v-714ad0fa");var Bi={class:"panel"},Ii=Object(r["k"])("h1",null,"Content Packs",-1),Di={class:"list"},Ai=Object(r["k"])("label",{for:"pack_name"},"Name:",-1),Hi=Object(r["k"])("label",{for:"pack_credits"},"Credits:",-1),_i={key:4},$i=Object(r["j"])(" The tool need restart for changes to take effect. ");Object(r["q"])();var Fi=Ti((function(t,e,n,o,a,i){var c=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])("div",Bi,[Ii,Object(r["k"])("button",{onClick:e[1]||(e[1]=function(){return t.addNew&&t.addNew.apply(t,arguments)})},"Add new Pack"),Object(r["k"])(c,{title:"Installed Packs:"},{default:Ti((function(){return[Object(r["k"])("div",Di,[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.packs,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:{active:e.name===t.name},key:e.name,onClick:function(n){return t.select(e.name)}},Object(r["x"])(e.name),11,["onClick"])})),128))])]})),_:1}),Ai,Object(r["k"])("input",{id:"pack_name",value:t.name,readonly:""},null,8,["value"]),Hi,Object(r["k"])("div",{id:"pack_credits",innerHTML:t.credits},null,8,["innerHTML"]),t.activatable?(Object(r["p"])(),Object(r["g"])("button",{key:0,onClick:e[2]||(e[2]=function(){return t.activate&&t.activate.apply(t,arguments)})},"Activate")):Object(r["h"])("",!0),t.deactivatable?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(){return t.deactivate&&t.deactivate.apply(t,arguments)})},"Deactivate")):Object(r["h"])("",!0),t.installable?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(){return t.install&&t.install.apply(t,arguments)})},"Install")):Object(r["h"])("",!0),t.uninstallable?(Object(r["p"])(),Object(r["g"])("button",{key:3,onClick:e[5]||(e[5]=function(){return t.uninstall&&t.uninstall.apply(t,arguments)})},"Uninstall")):Object(r["h"])("",!0),t.needRestart?(Object(r["p"])(),Object(r["g"])("div",_i,[$i,Object(r["k"])("button",{onClick:e[6]||(e[6]=function(){return t.restart&&t.restart.apply(t,arguments)})},"Restart Now")])):Object(r["h"])("",!0)])})),Ni=Object(r["m"])({mixins:[J],components:{DFieldset:Gt["a"]},data:function(){return{selectedPack:null,needRestart:!1}},computed:{packs:function(){var t=this.$store.state.content.contentPacks;return t.filter((function(t){return t.packId&&!t.packId.startsWith("dddg.buildin.")})).map((function(t){return{name:t.packId,credits:t.packCredits,installed:!0,active:!0,queuedUninstall:!1,freshInstall:!1,url:""}}))},name:function(){return this.selectedPack?this.selectedPack.name:""},credits:function(){return this.selectedPack?this.selectedPack.credits:[""]},activatable:function(){return!!Z["a"].supports.autoLoading&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&!this.selectedPack.active))))},deactivatable:function(){return!!Z["a"].supports.autoLoading&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&this.selectedPack.active))))},installable:function(){return!!Z["a"].supports.autoLoading&&(!!this.selectedPack&&(this.selectedPack.queuedUninstall||!this.selectedPack.installed))},uninstallable:function(){return!!Z["a"].supports.autoLoading&&(!!this.selectedPack&&(!this.selectedPack.freshInstall&&!(this.selectedPack.queuedUninstall||!this.selectedPack.installed)))}},methods:{select:function(t){this.selectedPack=this.packs.find((function(e){return e.name===t}))||null},addNew:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Z["a"].prompt("Enter the URL of the character pack:");case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.$store.dispatch("content/loadContentPacks",n);case 7:case"end":return e.stop()}}),e)})))()},restart:function(){location.reload(!0)},install:function(){this.selectedPack&&(this.selectedPack.queuedUninstall?this.selectedPack.queuedUninstall=!1:this.selectedPack.installed=!0)},uninstall:function(){this.selectedPack&&(Z["a"].localRepoUninstall(this.selectedPack.url),this.selectedPack.queuedUninstall=!0,this.needRestart=!0)},activate:function(){this.selectedPack&&(Z["a"].autoLoadAdd(this.selectedPack.url),this.selectedPack.active=!0,this.needRestart=!0)},deactivate:function(){this.selectedPack&&(Z["a"].autoLoadRemove(this.selectedPack.url),this.selectedPack.active=!1,this.needRestart=!0)}}});n("edcc");Ni.render=Fi,Ni.__scopeId="data-v-714ad0fa";var Ei=Ni,Wi=Object(r["F"])("data-v-0c58913e");Object(r["r"])("data-v-0c58913e");var Mi={class:"panel"},Vi=Object(r["k"])("h1",null,"Panels",-1),Li={class:"panel_text"},Ui={class:"panel_nr"},zi={class:"column"},Gi=Object(r["j"])(" Add new "),qi=Object(r["j"])(" Delete panel "),Yi=Object(r["j"])(" Move ahead "),Xi=Object(r["j"])(" Move behind "),Ki=Object(r["j"])(" Image options "),Ji=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_format"},"Format")],-1),Zi=Object(r["k"])("option",{value:"image/png"},"PNG (lossless)",-1),Qi={key:0,value:"image/webp"},tc={key:1,value:"image/heif"},ec=Object(r["k"])("option",{value:"image/jpeg"},"JPEG (lossy)",-1),nc={key:0},rc=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_quality"},"Quality:")],-1),oc=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_ppi"},[Object(r["j"])(" Panels per image: "),Object(r["k"])("br"),Object(r["k"])("small",null,"(0 for one single image)")])],-1),ac=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_pages"},[Object(r["j"])(" Panels to export: "),Object(r["k"])("br"),Object(r["k"])("small",null,"(Leave empty for all)")])],-1),ic=Object(r["j"])(" Download ");Object(r["q"])();var cc,sc=Wi((function(t,e,n,o,a,i){var c=Object(r["w"])("image-options"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset"),l=Object(r["w"])("d-button");return Object(r["p"])(),Object(r["g"])("div",Mi,[Vi,t.imageOptions?(Object(r["p"])(),Object(r["g"])(c,{key:0,type:"panel",title:"",id:t.currentPanel,"no-composition":"",onLeave:e[1]||(e[1]=function(e){t.imageOptions=!1,t.renderThumbnail()})},null,8,["id"])):(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])(u,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:Wi((function(){return[Object(r["k"])(s,{"no-wraping":"",maxSize:"350px"},{default:Wi((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.panelButtons,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{key:e.id,class:{panel_button:!0,active:e.id===t.currentPanel},style:"background-image: url('".concat(e.image,"')"),onClick:function(n){return t.updateCurrentPanel(e.id)}},[Object(r["k"])("div",Li,[Object(r["k"])("p",null,Object(r["x"])(e.text),1)]),Object(r["k"])("div",Ui,Object(r["x"])(n+1),1)],14,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["k"])("div",zi,[Object(r["k"])(l,{icon:"add_to_queue",onClick:t.addNewPanel},{default:Wi((function(){return[Gi]})),_:1},8,["onClick"]),Object(r["k"])(l,{icon:"remove_from_queue",onClick:t.deletePanel,disabled:!t.canDeletePanel},{default:Wi((function(){return[qi]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"arrow_upward",onClick:t.moveAhead,disabled:!t.canMoveAhead},{default:Wi((function(){return[Yi]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"arrow_downward",onClick:t.moveBehind,disabled:!t.canMoveBehind},{default:Wi((function(){return[Xi]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"color_lens",onClick:e[2]||(e[2]=function(e){return t.imageOptions=!0})},{default:Wi((function(){return[Ki]})),_:1})]),Object(r["k"])(u,{title:"Export"},{default:Wi((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Ji,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"export_format","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.format=e})},[Zi,t.webpSupport?(Object(r["p"])(),Object(r["g"])("option",Qi,"WebP (lossy)")):Object(r["h"])("",!0),t.heifSupport?(Object(r["p"])(),Object(r["g"])("option",tc,"HEIF (lossy)")):Object(r["h"])("",!0),ec],512),[[r["z"],t.format]])])]),t.isLossy?(Object(r["p"])(),Object(r["g"])("tr",nc,[rc,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.quality=e}),onKeydown:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.quality,void 0,{number:!0}]])])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[oc,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.ppi=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.ppi,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[ac,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_pages","onUpdate:modelValue":e[8]||(e[8]=function(e){return t.pages=e}),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[r["A"],t.pages]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])(l,{icon:"photo_camera",onClick:t.download},{default:Wi((function(){return[ic]})),_:1},8,["onClick"])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(){return t.estimateExportSize&&t.estimateExportSize.apply(t,arguments)})},"Estimate filesizes")])])])]})),_:1})],64))])})),uc=(n("13d5"),n("4d90"),n("53ca")),lc=n("c837");(function(t){t[t["None"]=0]="None",t[t["Stretch"]=1]="Stretch",t[t["Cover"]=2]="Cover"})(cc||(cc={}));var dc="buildin.transparent",fc=0,hc={panelToUrl:new Map,urlToPanel:new Map,register:function(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister:function(t,e){if(this.urlToPanel.has(e)){var n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),0===n.length&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},bc={namespaced:!0,state:{panels:{},panelOrder:[],currentPanel:null},mutations:{setCurrentPanel:function(t,e){var n=e.panelId;t.currentPanel=n},setPanelPreview:function(t,e){var n=e.panelId,r=e.url;t.panels[n].lastRender=r,hc.register(n,r)},createPanel:function(t,e){var n=e.panel;t.panels[n.id]=n},setPanelOrder:function(t,e){var n=e.panelOrder;t.panelOrder=Object(qr["a"])(n)},setCurrentBackground:function(t,e){var n=e.current,r=e.panelId,o=t.panels[r];o.background.current=n,o.background.variant=0},setBackgroundColor:function(t,e){var n=e.color,r=e.panelId,o=t.panels[r];o.background.color=n},setBackgroundFlipped:function(t,e){var n=e.flipped,r=e.panelId,o=t.panels[r];o.background.flipped=n},setBackgroundVariant:function(t,e){var n=e.variant,r=e.panelId,o=t.panels[r];o.background.variant=n},setBackgroundScaling:function(t,e){var n=e.scaling,r=e.panelId,o=t.panels[r];o.background.scaling=n},deletePanel:function(t,e){var n=e.panelId;hc.unregister(n,hc.panelToUrl.get(n)),delete t.panels[n]},setComposition:function(t,e){var n=t.panels[e.id];n.composite=e.composite},setFilters:function(t,e){var n=t.panels[e.id];n.filters=e.filters},backgroundSetComposition:function(t,e){var n=t.panels[e.id];n.background.composite=e.composite},backgroundSetFilters:function(t,e){var n=t.panels[e.id];n.background.filters=e.filters}},actions:{createPanel:function(t){var e=t.state,n=t.commit,r="panel"+ ++fc;n("createPanel",{panel:{id:r,background:{color:"#000000",current:dc,flipped:!1,scaling:cc.Cover,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[]}}),e.panelOrder?n("setPanelOrder",{panelOrder:[].concat(Object(qr["a"])(e.panelOrder),[r])}):n("setPanelOrder",{panelOrder:[r]}),n("setCurrentPanel",{panelId:r})},duplicatePanel:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,a=e.panelId,i=n.panels[a],c="panel"+ ++fc;hc.register(c,i.lastRender),r("createPanel",{panel:{id:c,background:JSON.parse(JSON.stringify(i.background)),lastRender:i.lastRender,composite:i.composite,filters:JSON.parse(JSON.stringify(i.filters))}}),o("objects/copyObjects",{sourcePanelId:a,targetPanelId:c},{root:!0});var s=n.panelOrder.indexOf(a);r("setPanelOrder",{panelOrder:[].concat(Object(qr["a"])(n.panelOrder.slice(0,s+1)),[c],Object(qr["a"])(n.panelOrder.slice(s+1)))}),r("setCurrentPanel",{panelId:c})},seekBackgroundVariant:function(t,e){var n=t.state,r=t.rootGetters,o=t.commit,a=e.delta,i=n.panels[n.currentPanel],c=r["content/getBackgrounds"],s=c.get(i.background.current);s&&o("setBackgroundVariant",{panelId:n.currentPanel,variant:Object(lc["a"])(s.variants,i.background.variant,a)})},delete:function(t,e){var n=t.state,r=t.dispatch,o=t.commit,a=e.panelId;if(!(n.panelOrder.length<=1)){var i,c=n.panelOrder.indexOf(a);i=c===n.panelOrder.length-1?c-1:c+1,o("setCurrentPanel",{panelId:n.panelOrder[i]}),o("setPanelOrder",{panelOrder:[].concat(Object(qr["a"])(n.panelOrder.slice(0,c)),Object(qr["a"])(n.panelOrder.slice(c+1)))}),r("objects/deleteAllOfPanel",{panelId:a},{root:!0}),o("deletePanel",{panelId:a})}},fixContentPackRemoval:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.state,o=t.rootGetters,a=t.commit,i=t.rootState,c=function(){var t=u[s],n=e.backgrounds.find((function(e){return e.id===t.background.current}));if(!n)return{v:void 0};var r=o["content/getBackgrounds"].get(t.background.current);if(!r)return i.content.current.backgrounds[0]?a("setCurrentBackground",{current:i.content.current.backgrounds[0].id,panelId:t.id}):a("setCurrentBackground",{current:"buildin.transparent",panelId:t.id}),{v:void 0};var c=JSON.stringify(n.variants[t.background.variant]),l=r.variants.findIndex((function(t){return JSON.stringify(t)===c}));l!==t.background.variant&&a("setBackgroundVariant",{variant:-1===l?0:l,panelId:t.id})},s=0,u=Object.values(r.panels);case 3:if(!(s<u.length)){n.next=10;break}if(l=c(),"object"!==Object(uc["a"])(l)){n.next=7;break}return n.abrupt("return",l.v);case 7:s++,n.next=3;break;case 10:case"end":return n.stop()}}),n)})))()},move:function(t,e){var n=t.state,r=t.commit,o=e.panelId,a=e.delta,i=Object(qr["a"])(n.panelOrder),c=i.indexOf(o);i.splice(c,1);var s=Math.max(c+a,0);i.splice(s,0,o),r("setPanelOrder",{panelOrder:i})},addFilter:function(t,e){var n=t.state,r=t.commit;ro(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},removeFilter:function(t,e){var n=t.state,r=t.commit;oo(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},moveFilter:function(t,e){var n=t.state,r=t.commit;ao(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},setFilter:function(t,e){var n=t.state,r=t.commit;io(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},backgroundAddFilter:function(t,e){var n=t.state,r=t.commit;ro(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundRemoveFilter:function(t,e){var n=t.state,r=t.commit;oo(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundMoveFilter:function(t,e){var n=t.state,r=t.commit;ao(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundSetFilter:function(t,e){var n=t.state,r=t.commit;io(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))}}},pc=function(){function t(e,n,r,o,a,i){Object(Me["a"])(this,t),this.id=e,this.assets=n,this.flip=r,this.scale=o,this.compositeMode=a,this.filters=i}return Object(Ve["a"])(t,[{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,f,h,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(We["a"])().Base,r=n.screenWidth,o=n.screenHeight,t.next=3,Promise.all(this.assets.map((function(t){return Object(wt["a"])(t,e.hq)})));case 3:a=t.sent,i=Object(yt["a"])(a),t.prev=5,i.s();case 7:if((c=i.n()).done){t.next=32;break}if(s=c.value,s instanceof HTMLImageElement){t.next=11;break}return t.abrupt("return");case 11:u=0,l=0,d=s.width,f=s.height,t.t0=this.scale,t.next=t.t0===cc.None?18:t.t0===cc.Stretch?21:t.t0===cc.Cover?24:29;break;case 18:return u=r/2-d/2,l=o/2-f/2,t.abrupt("break",29);case 21:return d=r,f=o,t.abrupt("break",29);case 24:h=d/f,b=r/o,h>b?(f=o,d=f*h):(d=r,f=d/h),u=r/2-d/2,l=o/2-f/2;case 29:e.drawImage({image:s,x:u,y:l,w:d,h:f,flip:this.flip,composite:this.compositeMode,filters:this.filters});case 30:t.next=7;break;case 32:t.next=37;break;case 34:t.prev=34,t.t1=t["catch"](5),i.e(t.t1);case 37:return t.prev=37,i.f(),t.finish(37);case 40:case"end":return t.stop()}}),t,this,[[5,34,37,40]])})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),mc={id:"buildin.static-color",name:"Static color",color:"#000000",render:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=Object(We["a"])().Base,o=r.screenWidth,a=r.screenHeight,t.drawRect({x:0,y:0,w:o,h:a,fill:{style:e.color}});case 2:case"end":return n.stop()}}),n)})))()}},vc=n("4a6f"),gc=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(t){var r;return Object(Me["a"])(this,n),r=e.call(this,t),r.canvasHeight=0,r.canvasWidth=0,r.init(),r}return Object(Ve["a"])(n,[{key:"init",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o,a,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.ready=new Promise((function(t,n){e=t})),t.next=3,Promise.all(this.obj.assets.map((function(t){return Object(wt["a"])(t)})));case 3:n=t.sent,r=0,o=0,a=Object(yt["a"])(n);try{for(a.s();!(i=a.n()).done;)c=i.value,c instanceof HTMLImageElement&&(c.height>o&&(o=c.height),c.width>r&&(r=c.width))}catch(s){a.e(s)}finally{a.f()}this.canvasWidth=r,this.canvasHeight=o,this.assets=[{loaded:!0,assets:n,offset:[0,0]}],e();case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getAssetList",value:function(){return this.assets||[]}},{key:"version",get:function(){return null===this.assets?-1:this.obj.version}}]),n}(vc["a"]),jc=n("1a7b"),Oc=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t._height=0,t.choiceRenderers=[],t}return Object(Ve["a"])(n,[{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.updateChoiceBounds();case 2:n=Object(We["a"])(),r=this.obj.width,o=this.height,a=r/2,i=this.flip?n.Base.screenWidth-this.obj.x:this.obj.x,c=i-a,s=this.obj.y-o/2,u=Object(yt["a"])(this.choiceRenderers),t.prev=10,u.s();case 12:if((l=u.n()).done){t.next=23;break}return d=l.value,t.next=16,d.loadFonts();case 16:f=d.getHeight(this.obj.autoWrap?this.obj.width:0),e.drawRect({x:c,y:s,w:r,h:f+2*n.Choices.ChoicePadding,outline:{style:n.Choices.ChoiceButtonBorderColor,width:n.Choices.Outline},fill:{style:n.Choices.ChoiceButtonColor}}),d.fixAlignment("center",c,c+r,s+1.25*n.Choices.ChoiceSpacing,this.obj.autoWrap?r:0),d.render(e.fsCtx),s+=f+2*n.Choices.ChoicePadding+n.Choices.ChoiceSpacing;case 21:t.next=12;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t["catch"](10),u.e(t.t0);case 28:return t.prev=28,u.f(),t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[10,25,28,31]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateChoiceBounds",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Object(We["a"])(),this.choiceRenderers=this.obj.choices.map((function(t){return new cn(t.text||" ",e.Choices.ChoiceTextStyle)})),this._height=this.choiceRenderers.reduce((function(t,r){return t+r.getHeight(n.obj.autoWrap?n.obj.width:0)+2*e.Choices.ChoicePadding}),0)+this.obj.choiceDistance*(this.obj.choices.length-1);case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"centeredVertically",get:function(){return!0}}]),n}(pn),kc=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t._height=0,t._width=0,t}return Object(Ve["a"])(n,[{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,r){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=Object(We["a"])(),this.obj.backdrop&&r.drawRect({x:0,y:0,w:o.Base.screenWidth,h:o.Base.screenHeight,fill:{style:Object(We["a"])().Notification.NotificationBackdropColor}}),t.next=4,Object(Le["a"])(Object(Ue["a"])(n.prototype),"render",this).call(this,e,r);case 4:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,f,h,b,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(We["a"])(),r=new cn(this.obj.text,n.Notification.NotificationTextStyle),o=new cn("OK",n.Notification.NotificationOkTextStyle),t.next=5,r.loadFonts();case 5:return t.next=7,o.loadFonts();case 7:a=this.obj.autoWrap?this.obj.width-2*n.Notification.NotificationPadding:0,i=this.obj.autoWrap?a:r.getWidth(),c=r.getHeight(a),s=this.obj.autoWrap?a:o.getWidth(),u=o.getHeight(a),l=this._width=Math.max(i,s)+2*n.Notification.NotificationPadding,d=this._height=c+2*n.Notification.NotificationPadding+n.Notification.NotificationSpacing+u,f=l/2,h=this.flip?n.Base.screenWidth-this.obj.x:this.obj.x,b=h-f,p=this.obj.y-d/2,e.drawRect({x:b,y:p,w:l,h:d,outline:{style:n.Choices.ChoiceButtonBorderColor,width:3},fill:{style:n.Choices.ChoiceButtonColor}}),r.fixAlignment("center",b,b+l,p+1.5*n.Notification.NotificationPadding,a),r.render(e.fsCtx),o.fixAlignment("center",b,b+l,p+d-n.Notification.NotificationPadding,a),o.render(e.fsCtx);case 23:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"centeredVertically",get:function(){return!0}},{key:"id",get:function(){return this.obj.id}}]),n}(pn),xc=-2,yc=26,wc=10,Cc=10,Sc=function(t){Object(ze["a"])(n,t);var e=Object(Ge["a"])(n);function n(){var t;return Object(Me["a"])(this,n),t=e.apply(this,arguments),t._height=0,t._width=0,t}return Object(Ve["a"])(n,[{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,f,h,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object(We["a"])(),r=n.Poem.poemBackgrounds[this.obj.background],o=this.flip?n.Base.screenWidth-this.obj.x:this.obj.x,a=this.obj.y,i=o+Cc,c=n.Poem.poemPadding,s=n.Poem.poemTopPadding,u=2*c,"internal:console"!==r.file){t.next=17;break}l=this._height=this.obj.height,d=this._width=this.obj.width,e.drawRect({x:o-d/2,y:this.obj.y-l/2,h:l,w:d,fill:{style:n.Poem.consoleBackgroundColor}}),c=xc,s=yc,u=wc,t.next=26;break;case 17:if("internal:transparent"!==r.file){t.next=22;break}this._height=this.obj.height,this._width=this.obj.width,t.next=26;break;case 22:return t.next=24,Object(wt["c"])("assets/poemBackgrounds/".concat(r.file));case 24:f=t.sent,f instanceof HTMLImageElement&&(e.drawImage({image:f,x:o-f.width/2,y:this.obj.y-f.height/2}),this._height=f.height,this._width=f.width);case 26:return a-=this.height/2,i-=this.width/2,h=n.Poem.poemTextStyles[this.obj.font],b=new cn(this.obj.text,h),t.next=32,b.loadFonts();case 32:b.fixAlignment("left",i+c,i+c,a+s+c,this.obj.autoWrap?this.width-u:0),b.render(e.fsCtx);case 34:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"centeredVertically",get:function(){return!0}}]),n}(pn),Rc=function(){function t(e,n,r,o){Object(Me["a"])(this,t),this.store=e,this.panelId=n,this.canvasWidth=r,this.canvasHeight=o,this.renderObjectCache=new Map,this.lCurrentlyRendering=!1,this.renderer=new wn["a"](r,o)}return Object(Ve["a"])(t,[{key:"render",value:function(t,e){return this.panel?this.renderer.render(this.renderCallback.bind(this),t,e):Promise.resolve(!1)}},{key:"download",value:function(){var t=new Date,e="panel-".concat([t.getFullYear(),"".concat(t.getMonth()+1).padStart(2,"0"),"".concat(t.getDate()).padStart(2,"0"),"".concat(t.getHours()).padStart(2,"0"),"".concat(t.getMinutes()).padStart(2,"0"),"".concat(t.getSeconds()).padStart(2,"0")].join("-"),".png");return this.renderer.download(this.renderCallback.bind(this),e)}},{key:"paintOnto",value:function(t,e){this.renderer.paintOnto(t,e)}},{key:"objectsAt",value:function(t,e){return this.getRenderObjects().filter((function(n){return n.hitTest(t,e)})).map((function(t){return t.id}))}},{key:"renderCallback",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lCurrentlyRendering=!0,t.prev=1,e.fsCtx.imageSmoothingEnabled=!0,e.fsCtx.imageSmoothingQuality=e.hq?"high":"low",t.next=6,null===(n=this.getBackgroundRenderer())||void 0===n?void 0:n.render(e);case 6:r=this.store.state.ui.selection,o=Object(yt["a"])(this.getRenderObjects()),t.prev=8,o.s();case 10:if((a=o.n()).done){t.next=18;break}return i=a.value,c=!1,i instanceof bn["a"]&&(i.updatedContent(this.store,this.panelId),c=r===i.id),t.next=16,i.render(c,e);case 16:t.next=10;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](8),o.e(t.t0);case 23:return t.prev=23,o.f(),t.finish(23);case 26:if(e.applyFilters(Object(qr["a"])(this.panel.filters)),!e.preview){t.next=34;break}return t.t1=e,t.next=31,Object(wt["b"])("backgrounds/transparent");case 31:t.t2=t.sent,t.t3={x:0,y:0,composite:"destination-over",image:t.t2},t.t1.drawImage.call(t.t1,t.t3);case 34:return t.prev=34,this.lCurrentlyRendering=!1,t.finish(34);case 37:case"end":return t.stop()}}),t,this,[[1,,34,37],[8,20,23,26]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRenderObjects",value:function(){var t,e=this,n=this.store.state.objects.panels[this.panelId],r=n?[].concat(Object(qr["a"])(n.order),Object(qr["a"])(n.onTopOrder)):[],o=this.store.state.objects.objects,a=Object.keys(this.renderObjectCache).filter((function(t){return!r.includes(t)})),i=Object(yt["a"])(a);try{for(i.s();!(t=i.n()).done;){var c=t.value;this.renderObjectCache.delete(c)}}catch(s){i.e(s)}finally{i.f()}return r.map((function(t){var n=e.renderObjectCache.get(t);if(!n){var r=o[t];switch(r.type){case"sprite":n=new gc(r);break;case"character":var a=r;n=new jc["a"](a,Object(zt["e"])(e.store,a));break;case"textBox":n=new An(r);break;case"choice":n=new Oc(r);break;case"notification":n=new kc(r);break;case"poem":n=new Sc(r);break}e.renderObjectCache.set(t,n)}return n}))}},{key:"getBackgroundRenderer",value:function(){var t=this.panel;switch(t.background.current){case"buildin.static-color":return mc.color=t.background.color,mc;default:var e=this.store.getters["content/getBackgrounds"],n=e.get(t.background.current);if(!n)return null;var r=n.variants[t.background.variant];return r?new pc(t.background.current,r,t.background.flipped,t.background.scaling,t.background.composite,t.background.filters):null}}},{key:"currentlyRendering",get:function(){return this.lCurrentlyRendering}},{key:"panel",get:function(){return this.store.state.panels.panels[this.panelId]}}]),t}(),Pc=1.5,Tc=1/4,Bc=.5,Ic=100,Dc=90,Ac=70,Hc=Object(r["m"])({mixins:[J],components:{DFieldset:Gt["a"],DFlow:de,DButton:It,ImageOptions:lo},data:function(){return{webpSupport:!1,heifSupport:!1,ppi:0,pages:"",format:"image/png",quality:Dc,imageOptions:!1}},computed:{currentPanel:function(){return this.$store.state.panels.currentPanel},isLossy:function(){return"image/png"!==this.format},canDeletePanel:function(){return this.panelButtons.length>1},panelButtons:function(){var t=this,e=this.$store.state.panels.panelOrder;return e.map((function(e){var n=t.$store.state.panels.panels[e],r=t.$store.state.objects.panels[e],o=r?[].concat(r.order,r.onTopOrder).map((function(e){return t.$store.state.objects.objects[e]})).map(t.extractObjectText):[];return{id:e,image:n.lastRender,text:o.reduce((function(t,e){return t.length>e.length?t:e}),"")}}))},canMoveAhead:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e>0},canMoveBehind:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e<t.length-1}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(wt["e"])(),Object(wt["d"])()]);case 2:n=e.sent,r=Object(l["a"])(n,2),t.webpSupport=r[0],t.heifSupport=r[1];case 6:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.moveFocusToActivePanel(),t.renderThumbnail();case 2:case"end":return e.stop()}}),e)})))()},methods:{download:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,o,a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=new Date,o="cd-".concat([r.getFullYear(),"".concat(r.getMonth()+1).padStart(2,"0"),"".concat(r.getDate()).padStart(2,"0"),"".concat(r.getHours()).padStart(2,"0"),"".concat(r.getMinutes()).padStart(2,"0"),"".concat(r.getSeconds()).padStart(2,"0")].join("-")),a=t.format.split("/")[1],i=t.format,c=t.quality,e.next=8,t.renderObjects(n,!0,function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:Z["a"].saveToFile(n,"".concat(o,"_").concat(e,".").concat(a),i,c/Ic);case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))()},estimateExportSize:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,o,a,i,c,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=t.format||"image/png",o=t.quality||Dc,e.next=5,t.renderObjects(n,!1,function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){n.toBlob((function(n){n?t(n.size):a("Image ".concat(e+1," could not be rendered."))}),r,o/Ic)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 5:a=e.sent,i=a.map((function(t){return(t*Pc/1024/1024).toFixed(2)+"MiB"})),c=i.length>1?"files":"file",s=i.length>1?"These":"It",l=i.length>1?"sizes":"size",at["h"].fire(new at["f"]("This would export ".concat(i.length," ").concat(c,". ").concat(s," would have the following (aproximate) ").concat(l,": ").concat(i.join(","))));case 11:case"end":return e.stop()}}),e)})))()},renderObjects:function(t,e,n){var r=this;return Object(u["a"])(regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a=Object(We["a"])().Base,o.next=3,Promise.all(t.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(o,i){var c,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=document.createElement("canvas"),c.width=a.screenWidth,c.height=a.screenHeight*o.length,s=c.getContext("2d"),t.next=6,Promise.all(o.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n,i){var c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=new Rc(r.$store,o[i],a.screenWidth,a.screenHeight),t.next=3,c.render(e,!1);case 3:c.paintOnto(s,{x:0,y:a.screenHeight*i,w:a.screenWidth,h:a.screenHeight});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 6:return t.next=8,n(i,c);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}}),o)})))()},getLimitedPanelList:function(){var t,e=this,n=this.$store.state.panels.panelOrder.length-1,r=0,o=this.pages.split(","),a=[],i=!1,c=Object(yt["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value,u=s.trim(),l=u.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(l)if(i=!0,l[2])a.push(parseInt(l[2],10)-1);else{var d=Math.max(parseInt(l[3],10)-1,r),f=Math.min(parseInt(l[4],10)-1,n);if(void 0===d||void 0===f||d>f)continue;for(var h=d;h<=f;++h)a.push(h)}else""!==u&&at["h"].fire(new at["f"]("Could not read '".concat(s,"' in the page list.")))}}catch(b){c.e(b)}finally{c.f()}return i?a.sort((function(t,e){return t-e})).filter((function(t,e,n){return n[e-1]!==t})).map((function(t){return e.$store.state.panels.panelOrder[t]})):this.$store.state.panels.panelOrder},getPanelDistibution:function(){var t=this.getLimitedPanelList();if(0===this.ppi)return[t];for(var e=[],n=0;n<t.length/this.ppi;++n){var r=n*this.ppi,o=r+this.ppi;e.push(Object(qr["a"])(t.slice(r,o)))}return e},moveFocusToActivePanel:function(){var t=this.$el.querySelector(".panel_button.active");t&&this.scrollIntoView(t)},scrollIntoView:function(t){var e=t.parentElement.parentElement,n=Array.from(t.parentElement.children).indexOf(t);if(this.$store.state.ui.vertical){var r=n*t.clientHeight-e.clientHeight/2+t.clientHeight/2;e.scrollTop=r,e.scrollLeft=0}else{var o=n*t.clientWidth-e.clientWidth/2+t.clientWidth/2;e.scrollLeft=o,e.scrollTop=0}},extractObjectText:function(t){switch(t.type){case"textBox":return t.text;case"notification":return t.text;case"poem":return t.text;case"choice":return t.choices.map((function(t){return"[".concat(t.text,"]")})).join("\n")}return""},addNewPanel:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/duplicatePanel",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)}))));case 2:t.$nextTick((function(){t.moveFocusToActivePanel()}));case 3:case"end":return e.stop()}}),e)})))()},updateCurrentPanel:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("panels/setCurrentPanel",{panelId:t});case 1:case"end":return n.stop()}}),n)})))),this.$nextTick((function(){e.moveFocusToActivePanel()}))},deletePanel:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/delete",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)})))),this.$nextTick((function(){t.moveFocusToActivePanel()}))},moveAhead:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:-1})}))},moveBehind:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:1})}))},renderThumbnail:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(We["a"])().Base,r=new Rc(t.$store,t.currentPanel,n.screenWidth,n.screenHeight),e.next=4,r.render(!1,!0);case 4:return o=document.createElement("canvas"),o.width=n.screenWidth*Tc,o.height=n.screenHeight*Tc,r.paintOnto(o.getContext("2d"),{x:0,y:0,w:o.width,h:o.height}),e.t0=o,e.t1=function(e){if(e){var n=URL.createObjectURL(e);t.vuexHistory.transaction((function(){t.$store.commit("panels/setPanelPreview",{panelId:t.$store.state.panels.currentPanel,url:n})}))}},e.next=12,Object(wt["e"])();case 12:if(!e.sent){e.next=16;break}e.t2="image/webp",e.next=17;break;case 16:e.t2="image/jpeg";case 17:e.t3=e.t2,e.t4=Bc,e.t0.toBlob.call(e.t0,e.t1,e.t3,e.t4);case 20:case"end":return e.stop()}}),e)})))()}},watch:{quality:function(t,e){t!==Ic?e>Ac&&t<=Ac&&at["h"].fire(new at["f"]("Note: A quality level below 70% might be very noticable and impair legibility of text.")):at["h"].fire(new at["f"]("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."))}}});n("51f8");Hc.render=sc,Hc.__scopeId="data-v-0c58913e";var _c=Hc,$c=Object(r["F"])("data-v-618f75f2");Object(r["r"])("data-v-618f75f2");var Fc={id:"notification_text"},Nc=Object(r["k"])("label",{for:"notification_text"},"Text:",-1);Object(r["q"])();var Ec=$c((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(s,{object:t.object,title:"Notification",textHandler:t.textHandler},{default:$c((function(){return[Object(r["k"])("div",Fc,[Nc,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),id:"notification_text",onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.text]]),Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"Formatting")])]})),options:$c((function(){return[Object(r["k"])(c,{modelValue:t.renderBackdrop,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.renderBackdrop=e}),label:"Show backdrop?"},null,8,["modelValue"])]})),_:1},8,["object","textHandler"])})),Wc=be(),Mc=Object(r["m"])({mixins:[J],components:{Toggle:X["a"],ObjectTool:Ro},data:function(){return{textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("notification"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.text},set:function(e){t.text=e},leave:function(){t.textEditor=!1}}},text:Wc("text","objects/setNotificationText"),autoWrap:Wc("autoWrap","objects/setAutoWrapping"),renderBackdrop:Wc("backdrop","objects/setNotificationBackdrop")}});n("28de");Mc.render=Ec,Mc.__scopeId="data-v-618f75f2";var Vc=Mc,Lc=Object(r["F"])("data-v-67d04474");Object(r["r"])("data-v-67d04474");var Uc={id:"poem_text"},zc=Object(r["k"])("label",{for:"poem_text"},"Text:",-1);Object(r["q"])();var Gc=Lc((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(s,{object:t.object,title:"poem"===t.object.subType?"Poem":"Console",textHandler:t.textHandler},{default:Lc((function(){return[Object(r["k"])("div",Uc,[zc,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.text]]),Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"Formatting")]),Object(r["k"])(c,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),"poem"===t.object.subType?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.poemBackground=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.backgrounds,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{value:e,key:e},Object(r["x"])(t.name),9,["value"])})),128))],544),[[r["z"],t.poemBackground]]),Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.poemStyle=e}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.poemTextStyles,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{value:e,key:e},Object(r["x"])(t.name),9,["value"])})),128))],544),[[r["z"],t.poemStyle]])],64)):Object(r["h"])("",!0)]})),_:1},8,["object","title","textHandler"])})),qc=n("f70f"),Yc=be(),Xc=Object(r["m"])({mixins:[J],components:{Toggle:X["a"],ObjectTool:Ro},data:function(){return{textEditor:!1}},computed:{backgrounds:function(){return qc["poemBackgrounds"]},poemTextStyles:function(){return qc["poemTextStyles"]},object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("poem"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.text},set:function(e){t.text=e},leave:function(){t.textEditor=!1}}},text:Yc("text","objects/setPoemText"),autoWrap:Yc("autoWrap","objects/setAutoWrapping"),poemStyle:Yc("font","objects/setPoemFont"),poemBackground:Yc("background","objects/setPoemBackground")}});n("7b2f");Xc.render=Gc,Xc.__scopeId="data-v-67d04474";var Kc=Xc,Jc=Object(r["m"])({components:{SettingsPanel:lt,AddPanel:Ht,BackgroundsPanel:Pi,CreditsPanel:Ja,CharacterPanel:Bo,TextBoxPanel:sa,ChoicePanel:pa,SpritePanel:Ao,ContentPacksPanel:Ei,PanelsPanel:_c,NotificationPanel:Vc,PoemPanel:Kc},data:function(){return{panelSelection:"add"}},computed:{vertical:function(){return this.$store.state.ui.vertical},selection:function(){return this.$store.state.ui.selection},panel:function(){if("selection"===this.panelSelection){if(null!==this.selection){var t=this.$store.state.objects.objects[this.selection];return t.type}this.panelSelection="add"}return this.panelSelection},hasPrevRender:function(){return null!==this.$store.state.ui.lastDownload}},methods:{create:function(){var t=this;Z["a"].onPanelChange((function(e){t.panelSelection=e}))},setPanel:function(t){if(t===this.panelSelection&&(t="add"),this.panelSelection=t,this.selection){if(null===this.$store.state.ui.selection)return;this.$store.commit("ui/setSelection",null)}}},watch:{selection:function(t){t?this.panelSelection="selection":"selection"===this.panelSelection&&(this.panelSelection="add")}}});n("3672");Jc.render=k;var Zc=Jc,Qc=Object(r["F"])("data-v-7f9dc964");Object(r["r"])("data-v-7f9dc964");var ts={key:0};Object(r["q"])();var es=Qc((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{id:"messageConsole",class:{vertical:t.vertical}},[t.showLoading?(Object(r["p"])(),Object(r["g"])("p",ts,"Loading...")):Object(r["h"])("",!0),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.messages,(function(t,e){return Object(r["p"])(),Object(r["g"])("p",{key:t+"_"+e},Object(r["x"])(t),1)})),128)),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.errors,(function(e,n){return Object(r["p"])(),Object(r["g"])("p",{class:"error",key:e+"_"+n},[Object(r["j"])(Object(r["x"])(e)+" ",1),Object(r["k"])("a",{href:"#",onClick:function(e){return t.dismissError(n)}},"[Dismiss]",8,["onClick"])])})),128))],2)})),ns=5e3,rs=2e4,os=100,as=Object(r["m"])({props:{loading:{default:!1,type:Boolean}},data:function(){return{messages:[],errors:[],showLoading:!1,showLoadingTimeout:0,hideLoadingTimeout:0}},computed:{vertical:function(){return this.$store.state.ui.vertical}},created:function(){var t=this;this.onLoadingChange(this.loading),at["h"].subscribe(at["a"],(function(e){t.messages.push("Failed to load asset '".concat(e.path,"'")),setTimeout((function(){t.messages.shift()}),ns)})),at["h"].subscribe(at["c"],(function(e){t.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout((function(){t.messages.shift()}),rs)})),at["h"].subscribe(at["d"],(function(e){t.errors.push(e.message)})),at["h"].subscribe(at["f"],(function(e){t.messages.push(e.message),setTimeout((function(){t.messages.shift()}),rs)})),at["h"].subscribe(at["g"],(function(e){t.messages.push(e.error.name),t.messages.push(JSON.stringify(e.error.stack)),t.messages.push(e.info),setTimeout((function(){t.messages.shift(),t.messages.shift(),t.messages.shift()}),rs)}))},methods:{onLoadingChange:function(t){var e=this;t?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),this.showLoading||this.showLoadingTimeout||(this.showLoadingTimeout=setTimeout((function(){e.showLoading=!0,e.showLoadingTimeout=0}),os))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout((function(){e.showLoading=!1,e.hideLoadingTimeout=0}),os)))},dismissError:function(t){this.errors.splice(t,1)}},watch:{loading:function(t){this.onLoadingChange(t)}}});n("121d");as.render=es,as.__scopeId="data-v-7f9dc964";var is=as;function cs(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("canvas",{id:"scaled_display",ref:"sd",height:t.bitmapHeight,width:t.bitmapWidth,style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px",cursor:t.cursor},draggable:"true",onClick:e[1]||(e[1]=function(){return t.onUiClick&&t.onUiClick.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.onTouchStart&&t.onTouchStart.apply(t,arguments)}),onDragstart:e[3]||(e[3]=function(){return t.onDragStart&&t.onDragStart.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.onSpriteDragMove&&t.onSpriteDragMove.apply(t,arguments)}),onMousemove:e[5]||(e[5]=function(){return t.onSpriteDragMove&&t.onSpriteDragMove.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.onSpriteDrop&&t.onSpriteDrop.apply(t,arguments)}),onMouseup:e[7]||(e[7]=function(){return t.onSpriteDrop&&t.onSpriteDrop.apply(t,arguments)}),onDragover:e[8]||(e[8]=function(){return t.onDragOver&&t.onDragOver.apply(t,arguments)}),onDrop:e[9]||(e[9]=function(){return t.onDrop&&t.onDrop.apply(t,arguments)}),onMouseenter:e[10]||(e[10]=function(){return t.onMouseEnter&&t.onMouseEnter.apply(t,arguments)})},"HTML5 is required to use the Doki Doki Dialog Generator.",44,["height","width"])}var ss=n("6ae4"),us=Object(r["m"])({props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean}},data:function(){return{sdCtx:null,currentlyRendering:!1,queuedRender:null,showingLast:!1,dropSpriteCount:0,dropPreventClick:!1,draggedObject:null,dragXOffset:0,dragYOffset:0,dragXOriginal:0,dragYOriginal:0}},computed:{selection:function(){return this.$store.state.ui.selection},lqRendering:function(){return this.$store.state.ui.lqRendering},sceneRender:function(){return new Rc(this.$store,this.$store.state.panels.currentPanel,this.bitmapWidth,this.bitmapHeight)},bitmapHeight:function(){return this.preLoading,Object(We["a"])().Base.screenHeight},bitmapWidth:function(){return this.preLoading,Object(We["a"])().Base.screenWidth},pickerMode:function(){return this.$store.state.ui.pickColor},cursor:function(){return this.pickerMode?"crosshair":"default"}},methods:{download:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.sceneRender.download();case 2:n=e.sent,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.$store.state.ui.lastDownload,t.$store.commit("ui/setLastDownload",n),r&&URL.revokeObjectURL(r);case 3:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)})))()},invalidateRender:function(){var t=this;this.queuedRender||(this.queuedRender=requestAnimationFrame((function(){return t.render_()})))},render_:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.queuedRender&&(cancelAnimationFrame(t.queuedRender),t.queuedRender=null),!t.$store.state.unsafe){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.sceneRender.render(!t.lqRendering,!0);case 5:t.display();case 6:case"end":return e.stop()}}),e)})))()},renderLoadingScreen:function(){if(this.sdCtx){var t=document.createElement("canvas");t.height=this.bitmapHeight,t.width=this.bitmapWidth;var e=ss["a"].make(t,!0,!1);e.drawText({text:"Starting...",x:t.width/2,y:t.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),this.sdCtx.drawImage(t,this.canvasWidth,this.canvasHeight)}},display:function(){this.sdCtx&&(this.showingLast=!1,this.sceneRender.paintOnto(this.sdCtx,{x:0,y:0,w:this.bitmapWidth,h:this.bitmapHeight}))},toRendererCoordinate:function(t,e){var n=this.$refs.sd,r=t-n.offsetLeft,o=e-n.offsetTop,a=r/n.offsetWidth*n.width,i=o/n.offsetWidth*n.width;return[a,i]},onUiClick:function(t){var e=this,n=this.toRendererCoordinate(t.clientX,t.clientY),r=Object(l["a"])(n,2),o=r[0],a=r[1];if(this.pickerMode){var i=this.sdCtx.getImageData(o,a,1,1).data,c="rgba(".concat(i[0].toString(),",").concat(i[1].toString(),",").concat(i[2].toString(),",").concat((i[3]/255).toString(),")");this.vuexHistory.transaction((function(){e.$store.commit("ui/setColorPicker",!1),at["h"].fire(new at["b"](c))}))}else if(this.dropPreventClick)this.dropPreventClick=!1;else{var s,u=this.sceneRender.objectsAt(o,a),d=u.findIndex((function(t){return t===e.selection}));s=0===d?null:-1!==d?u[d-1]:u[u.length-1]||null,this.$store.state.ui.selection!==s&&this.vuexHistory.transaction((function(){e.$store.commit("ui/setSelection",s)}))}},onDragStart:function(t){if(t.preventDefault(),this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.clientX,t.clientY),n=Object(l["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onTouchStart:function(t){if(this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),n=Object(l["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onDragOver:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},onSpriteDragMove:function(t){var e=this;if(this.draggedObject){t.preventDefault();var n=t instanceof MouseEvent?this.toRendererCoordinate(t.clientX,t.clientY):this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),r=Object(l["a"])(n,2),o=r[0],a=r[1];o-=this.dragXOffset,a-=this.dragYOffset;var i=Math.abs(o-this.dragXOriginal),c=Math.abs(a-this.dragYOriginal);i+c>1&&(this.dropPreventClick=!0),t.shiftKey&&(i>c?a=this.dragYOriginal:o=this.dragXOriginal),this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.draggedObject.id,x:o,y:a})}))}},onDrop:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.stopPropagation(),t.preventDefault(),t.dataTransfer){n.next=4;break}return n.abrupt("return");case 4:r=Object(yt["a"])(t.dataTransfer.items);try{for(r.s();!(o=r.n()).done;)a=o.value,"file"===a.kind&&a.type.match(/image.*/)&&function(){var t="dropCustomAsset"+ ++e.dropSpriteCount,n=Object(wt["f"])(t,a.getAsFile());e.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("objects/createSprite",{assets:[{hq:n,lq:n,sourcePack:"dddg.generated.uploaded-sprites"}]});case 2:case"end":return t.stop()}}),t)}))))}()}catch(i){r.e(i)}finally{r.f()}case 6:case"end":return n.stop()}}),n)})))()},onSpriteDrop:function(t){this.draggedObject&&("TouchEvent"in window&&t instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)},onMouseEnter:function(t){1!==t.buttons&&(this.draggedObject=null)}},watch:{canvasWidth:function(){this.display()},canvasHeight:function(){this.display()}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:at["h"].subscribe(at["e"],(function(){return t.invalidateRender()})),t.$store.subscribe((function(e){"panels/setPanelPreview"!==e.type&&"panels/currentPanel"!==e.type&&t.invalidateRender()}));case 2:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this.$refs.sd;this.sdCtx=t.getContext("2d"),this.renderLoadingScreen(),this.invalidateRender()}});us.render=cs;var ls=us,ds=n("4918"),fs=16/9,hs=20,bs=50,ps=200,ms={"dddg.buildin.backgrounds.nsfw":"".concat("","packs/buildin.base.backgrounds.nsfw.json"),"dddg.buildin.sayori.nsfw":"".concat("","packs/buildin.base.sayori.nsfw.json"),"dddg.buildin.base.natsuki.nsfw":"".concat("","packs/buildin.base.natsuki.nsfw.json"),"dddg.buildin.yuri.nsfw":"".concat("","packs/buildin.base.yuri.nsfw.json")},vs=new Set(Object.keys(ms)),gs=Object.values(ms),js=Object(r["m"])({components:{ToolBox:Zc,MessageConsole:is,Render:ls,ModalDialog:rt,SingleBox:Object(r["l"])((function(){return n.e("chunk-f6c4e426").then(n.bind(null,"dcb9"))})),ExpressionBuilder:Object(r["l"])((function(){return n.e("chunk-57967dfc").then(n.bind(null,"d785"))}))},data:function(){return{canvasWidth:0,canvasHeight:0,blendOver:null,uiSize:192,currentlyRendering:!1,panel:"",dialogVisable:!1,canvasTooSmall:!1,expressionBuilderVisible:!1,expressionBuilderCharacter:"",expressionBuilderHeadGroup:void 0,systemPrefersDarkMode:!1,preLoading:!0}},computed:{isSafari:function(){return!1},useDarkTheme:function(){var t;return null!==(t=this.userPrefersDarkMode)&&void 0!==t?t:this.systemPrefersDarkMode},userPrefersDarkMode:function(){return this.$store.state.ui.useDarkTheme},nsfw:function(){return this.$store.state.ui.nsfw}},methods:{drawLastDownload:function(){var t=this.$store.state.ui.lastDownload;t&&this.$refs.render.blendOver(t)},setBlendOver:function(){this.blendOver=this.$store.state.ui.lastDownload},optimum:function(t,e){var n=t/fs,r=e*fs;return n>e?n=e:r=t,[r,n]},optimizeWithMenu:function(t,e){var n=this.optimum(t,e-this.uiSize),r=this.optimum(t-this.uiSize,e);return!this.isSafari&&n[0]*n[1]>r[0]*r[1]?[n[0],n[1],!1]:[r[0],r[1],!0]},updateArea:function(){var t=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight),e=Object(l["a"])(t,3),n=e[0],r=e[1],o=e[2];this.canvasWidth=n,this.canvasHeight=r,this.canvasTooSmall=Math.max(n,r)<ps,this.$store.state.ui.vertical!==o&&this.$store.commit("ui/setVertical",o)},showDialog:function(t){var e=this;if(this.dialogVisable=!0,t){var n=function n(){e.$refs.packDialog&&e.$refs.packDialog.$refs.packDialog?e.$refs.packDialog.$refs.packDialog.setSearch(t):setTimeout(n,bs)};this.$nextTick(n)}},showExpressionDialog:function(t){this.expressionBuilderVisible=!0,this.expressionBuilderCharacter=t.character,this.expressionBuilderHeadGroup=t.headGroup},onKeydown:function(t){var e=this;t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement?console.log("skip keydown on potential target"):this.vuexHistory.transaction((function(){var n=e.$store.state.objects.objects[e.$store.state.ui.selection];if(t.ctrlKey){if("z"===t.key)return void t.preventDefault();if("y"===t.key)return void t.preventDefault();if("v"===t.key)return e.$store.dispatch("objects/pasteObjectFromClipboard",{}),void t.preventDefault()}if(n)if("Delete"!==t.key){if("c"===t.key||"x"===t.key)return e.$store.dispatch("objects/copyObjectToClipboard",{id:n.id}),"x"===t.key&&e.$store.dispatch("objects/removeObject",{id:n.id}),void t.preventDefault();if("character"===n.type){var r=n;if(!r.freeMove){if("ArrowLeft"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:-1});if("ArrowRight"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:1})}}var o=n.x,a=n.y;if("ArrowLeft"===t.key)o-=t.shiftKey?1:hs;else if(n&&"ArrowRight"===t.key)o+=t.shiftKey?1:hs;else if(n&&"ArrowUp"===t.key)a-=t.shiftKey?1:hs;else{if(!n||"ArrowDown"!==t.key)return;a+=t.shiftKey?1:hs}e.$store.dispatch("objects/setPosition",{id:n.id,x:o,y:a})}else e.$store.dispatch("objects/removeObject",{id:n.id})}))},destroyed:function(){window.removeEventListener("keydown",this.onKeydown)},applyTheme:function(){document.body.classList.toggle("dark-theme",this.useDarkTheme)}},watch:{systemPrefersDarkMode:function(){this.applyTheme()},userPrefersDarkMode:function(){this.applyTheme()},nsfw:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=5;break}return n.next=3,e.$store.dispatch("content/loadContentPacks",gs);case 3:n.next=7;break;case 5:return n.next=7,e.$store.dispatch("removePacks",{packs:vs});case 7:case"end":return n.stop()}}),n)})))()}},mounted:function(){var t=this;if(window.addEventListener("keypress",(function(e){"Escape"===e.key&&t.vuexHistory.transaction((function(){null!==t.$store.state.ui.selection&&t.$store.commit("ui/setSelection",null)}))})),window.matchMedia){var e=window.matchMedia("(prefers-color-scheme: dark)");this.systemPrefersDarkMode=e.matches,e.addListener((function(e){t.systemPrefersDarkMode=e.matches}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateArea(),ds["a"].setStore(t.$store),window.addEventListener("resize",t.updateArea),window.removeEventListener("keydown",t.onKeydown),window.addEventListener("keydown",t.onKeydown),window.app=t,window.store=t.$store,window.env=Z["a"],document.body.addEventListener("drop",(function(t){t.preventDefault()}),!0),document.body.addEventListener("dragover",(function(t){t.preventDefault()}),!0),e.next=12,Z["a"].loadGameMode();case 12:return t.preLoading=!1,Z["a"].connectToStore(t.vuexHistory,t.$store),e.next=16,Z["a"].loadSettings();case 16:n=e.sent,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){var r,o,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$store.commit("ui/setLqRendering",null!==(r=n.lq)&&void 0!==r&&r),t.$store.commit("ui/setDarkTheme",null!==(o=n.darkMode)&&void 0!==o?o:null),t.$store.commit("ui/setDefaultCharacterTalkingZoom",null===(a=n.defaultCharacterTalkingZoom)||void 0===a||a),e.next=5,t.$store.dispatch("content/loadContentPacks",["".concat("","packs/buildin.base.backgrounds.json"),"".concat("","packs/buildin.base.monika.json"),"".concat("","packs/buildin.base.sayori.json"),"".concat("","packs/buildin.base.natsuki.json"),"".concat("","packs/buildin.base.yuri.json"),"".concat("","packs/buildin.extra.mc.json"),"".concat("","packs/buildin.extra.mc_chad.json"),"".concat("","packs/buildin.extra.mc_classic.json"),"".concat("","packs/buildin.extra.femc.json"),"".concat("","packs/buildin.extra.classic_amy.json"),"".concat("","packs/buildin.extra.amy.json")]);case 5:return e.next=7,t.$store.dispatch("panels/createPanel");case 7:return 0===Object.keys(t.$store.state.objects.objects).length&&t.$store.dispatch("objects/createTextBox",{}),e.next=10,t.$store.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:t.$store.state.panels.currentPanel});case 10:return e.next=12,t.$store.commit("ui/setNsfw",null!==(i=n.nsfw)&&void 0!==i&&i);case 12:case"end":return e.stop()}}),e)}))));case 18:case"end":return e.stop()}}),e)})))()}});n("9be8");js.render=s;var Os=js,ks=n("5502"),xs=n("6289"),ys={},ws=0,Cs={createSprite:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.rootState,n.next=3,Object(wt["a"])(e.assets[0],!1);case 3:if(a=n.sent,a instanceof HTMLImageElement){n.next=6;break}return n.abrupt("return");case 6:r("create",{object:Object(ue["a"])(Object(ue["a"])({},Object(xs["a"])()),{},{assets:e.assets,height:a.height,width:a.width,id:"sprite_"+ ++ws,panelId:o.panels.currentPanel,onTop:!1,preserveRatio:!0,ratio:a.width/a.height,type:"sprite",y:0,enlargeWhenTalking:o.ui.defaultCharacterTalkingZoom})});case 7:case"end":return n.stop()}}),n)})))()}},Ss={setChoices:function(t,e){var n=t.objects[e.id];n.choices=e.choices,++n.version},setChoiceColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setChoiceDistance:function(t,e){var n=t.objects[e.id];n.choiceDistance=e.choiceDistance,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},Rs=0,Ps={createChoice:function(t,e){var n=t.commit,r=t.rootState,o=Object(We["a"])(),a="choice_"+ ++Rs;return n("create",{object:Object(ue["a"])(Object(ue["a"])({},Object(xs["a"])()),{},{y:o.Choices.ChoiceY,width:o.Choices.ChoiceButtonWidth,height:0,panelId:r.panels.currentPanel,id:a,onTop:!0,autoWrap:!0,type:"choice",preserveRatio:!1,ratio:o.TextBox.TextBoxWidth/o.TextBox.TextBoxHeight,choiceDistance:o.Choices.ChoiceSpacing,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:o.Choices.ChoiceButtonColor})}),a},addChoice:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id];r("setChoices",{id:e.id,choices:[].concat(Object(qr["a"])(o.choices),[{selected:!1,text:e.text}])})},removeChoice:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(qr["a"])(o.choices);a[e.choiceIdx]&&(a.splice(e.choiceIdx,1),0===a.length&&a.push({selected:!1,text:""}),r("setChoices",{id:e.id,choices:a}))},setChoiceText:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(qr["a"])(o.choices);a[e.choiceIdx]&&(a[e.choiceIdx].text=e.text,r("setChoices",{id:e.id,choices:a}))}},Ts=n("8cae");function Bs(t,e,n){return t>e?t:e>n?n:e}var Is=4,Ds={setText:function(t,e){var n=t.objects[e.id];n.text=e.text,++n.version},setTalkingObject:function(t,e){var n=t.objects[e.id];n.talkingObjId=e.talkingObjId,++n.version},setTalkingOther:function(t,e){var n=t.objects[e.id];n.talkingOther=e.talkingOther,n.talkingObjId="$other$",++n.version},setStyle:function(t,e){var n=t.objects[e.id];n.style=e.style,++n.version},setControlsVisible:function(t,e){var n=t.objects[e.id];n.controls=e.controls,++n.version},setControlsColor:function(t,e){var n=t.objects[e.id];n.customControlsColor=e.customControlsColor,++n.version},setDeriveCustomColors:function(t,e){var n=t.objects[e.id];n.deriveCustomColors=e.deriveCustomColors,++n.version},setNameboxColor:function(t,e){var n=t.objects[e.id];n.customNameboxColor=e.customNameboxColor,++n.version},setNameboxStroke:function(t,e){var n=t.objects[e.id];n.customNameboxStroke=e.customNameboxStroke,++n.version},setNameboxWidth:function(t,e){var n=t.objects[e.id];n.customNameboxWidth=e.customNameboxWidth,++n.version},setSkipable:function(t,e){var n=t.objects[e.id];n.skip=e.skip,++n.version},setContinueArrow:function(t,e){var n=t.objects[e.id];n.continue=e.continue,++n.version},setCustomColor:function(t,e){var n=t.objects[e.id];n.customColor=e.color,++n.version},setAutoQuoting:function(t,e){var n=t.objects[e.id];n.autoQuoting=e.autoQuoting,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version},setResetBounds:function(t,e){var n=t.objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,n.rotation=e.resetBounds.rotation,++n.version},setColorOverride:function(t,e){var n=t.objects[e.id];n.overrideColor=e.overrideColor,++n.version}},As=0,Hs={createTextBox:function(t,e){var n=t.commit,r=t.rootState,o=Object(We["a"])(),a="textBox_"+ ++As,i=o.TextBox.DefaultTextboxStyle,c=Dn[i],s=e.resetBounds||{x:c.defaultX,y:c.defaultY,width:c.defaultWidth,height:c.defaultHeight,rotation:0};return n("create",{object:Object(ue["a"])(Object(ue["a"])(Object(ue["a"])({},Object(xs["a"])()),s),{},{panelId:r.panels.currentPanel,id:a,onTop:!0,type:"textBox",preserveRatio:!1,ratio:o.TextBox.TextBoxWidth/o.TextBox.TextBoxHeight,continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:i,overrideColor:!1,customColor:o.TextBoxCustom.textboxDefaultColor,deriveCustomColors:!0,customControlsColor:o.TextBoxCustom.controlsDefaultColor,customNameboxColor:o.TextBoxCustom.nameboxDefaultColor,customNameboxWidth:null,customNameboxStroke:o.TextBoxCustom.nameboxStrokeDefaultColor,talkingObjId:null,talkingOther:"",text:"",resetBounds:s})}),a},setStyle:function(t,e){var n=t.state,r=t.commit,o=Object(We["a"])(),a=n.objects[e.id],i=Dn[a.style],c=Dn[e.style],s=10,u=!1,l={id:e.id,x:a.x,y:a.y},d=!1,f={id:e.id,width:a.width,height:a.height};c.resizable?(i.defaultWidth!==c.defaultWidth&&(d=!0,f.width=Math.max(f.width+c.defaultWidth-i.defaultWidth,s)),i.defaultHeight!==c.defaultHeight&&(d=!0,f.height=Math.max(f.height+c.defaultHeight-i.defaultHeight,s))):(d=!0,f.width=c.defaultWidth,f.height=c.defaultHeight),i.defaultX!==c.defaultX&&(u=!0,l.x=Bs(-f.width+s,l.x+c.defaultX-i.defaultX,o.Base.screenWidth-s)),i.defaultY!==c.defaultY&&(u=!0,l.y=Bs(-f.height+s,l.y+c.defaultY-i.defaultY,o.Base.screenHeight-s)),u&&r("setPosition",l),d&&r("setSize",f),r("setStyle",{id:e.id,style:e.style})},resetTextboxBounds:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id];n("setPosition",{id:e.id,x:o.resetBounds.x,y:o.resetBounds.y}),n("setSize",{id:e.id,height:o.resetBounds.height,width:o.resetBounds.width}),n("setRotation",{id:e.id,rotation:o.resetBounds.rotation})},splitTextbox:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u,l,d,f;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.state,a=t.dispatch,i=o.objects[e.id],c=(i.width-Is)/2,s=c/2+Is/2,u=[i.x,i.y],l=[i.x-s,i.y],d=[i.x+s,i.y],0!==i.rotation&&(l=Object(Ts["a"])(l[0],l[1],u[0],u[1],i.rotation/180*Math.PI),d=Object(Ts["a"])(d[0],d[1],u[0],u[1],i.rotation/180*Math.PI)),r("setResetBounds",{id:e.id,resetBounds:{x:l[0],y:l[1],width:c,height:i.height,rotation:i.rotation}}),r("setStyle",{id:e.id,style:"custom"}),n.next=12,a("createTextBox",{resetBounds:{x:d[0],y:d[1],width:c,height:i.height,rotation:i.rotation}});case 12:f=n.sent,r("setStyle",{id:f,style:"custom"}),i.flip&&r("setFlip",{id:f,flip:i.flip});case 15:case"end":return n.stop()}}),n)})))()}},_s={setNotificationColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setNotificationText:function(t,e){var n=e.id,r=e.text,o=t.objects[n];o.text=r,++o.version},setNotificationBackdrop:function(t,e){var n=e.id,r=e.backdrop,o=t.objects[n];o.backdrop=r,++o.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},$s=0,Fs={createNotification:function(t,e){var n=t.commit,r=t.rootState,o=Object(We["a"])(),a="notification_"+ ++$s;return n("create",{object:Object(ue["a"])(Object(ue["a"])({},Object(xs["a"])()),{},{y:o.Base.screenHeight/2,width:o.Choices.ChoiceButtonWidth,height:0,panelId:r.panels.currentPanel,autoWrap:!1,id:a,onTop:!0,type:"notification",preserveRatio:!1,ratio:o.TextBox.TextBoxWidth/o.TextBox.TextBoxHeight,customColor:o.Choices.ChoiceButtonColor,text:"Click here to edit notification",backdrop:!0})}),a}},Ns={setPoemBackground:function(t,e){var n=e.id,r=e.background,o=t.objects[n];o.background=r,++o.version},setPoemFont:function(t,e){var n=e.id,r=e.font,o=t.objects[n];o.font=r,++o.version},setPoemText:function(t,e){var n=e.id,r=e.text,o=t.objects[n];o.text=r,++o.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},Es=0,Ws={createPoem:function(t,e){var n=t.commit,r=t.rootState,o=Object(We["a"])(),a="poem_"+ ++Es;return n("create",{object:{subType:"poem",x:o.Poem.defaultX,y:o.Poem.defaultY,width:o.Poem.defaultPoemWidth,height:o.Poem.defaultPoemHeight,panelId:r.panels.currentPanel,flip:!1,rotation:0,id:a,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,autoWrap:!0,ratio:o.Poem.defaultPoemWidth/o.Poem.defaultPoemHeight,background:o.Poem.defaultPoemBackground,font:o.Poem.defaultPoemStyle,text:"New poem\n\nClick here to edit poem",composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null,zoom:1}}),a},createConsole:function(t,e){var n=t.commit,r=t.rootState,o=Object(We["a"])(),a="poem_"+ ++Es;return n("create",{object:Object(ue["a"])(Object(ue["a"])({},Object(xs["a"])()),{},{subType:"console",x:o.Poem.consoleWidth/2,y:o.Poem.consoleHeight/2,width:o.Poem.consoleWidth,height:o.Poem.consoleHeight,panelId:r.panels.currentPanel,id:a,onTop:!0,type:"poem",preserveRatio:!1,ratio:o.Poem.consoleWidth/o.Poem.consoleHeight,background:o.Poem.defaultConsoleBackground,font:o.Poem.defaultConsoleStyle,text:"> _\n  \n  Console command\n  Click here to edit",autoWrap:!0})}),a}},Ms=0,Vs={namespaced:!0,state:{objects:{},panels:{}},mutations:Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])({create:function(t,e){var n=e.object;t.panels[n.panelId]||(t.panels[n.panelId]={id:n.panelId,onTopOrder:[],order:[]});var r=t.panels[n.panelId],o=n.onTop?r.onTopOrder:r.order;t.objects[n.id]=n,o.push(n.id)},removeFromList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],o=e.onTop?r.onTopOrder:r.order,a=o.indexOf(e.id);o.splice(a,1)},addToList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],o=e.onTop?r.onTopOrder:r.order;o.splice(e.position,0,e.id)},setOnTop:function(t,e){var n=t.objects[e.id];n.onTop=e.onTop},setPosition:function(t,e){var n=t.objects[e.id];n.x=e.x,n.y=e.y},setFlip:function(t,e){var n=t.objects[e.id];n.flip=e.flip},setSize:function(t,e){var n=t.objects[e.id];n.width=e.width,n.height=e.height},setRatio:function(t,e){var n=t.objects[e.id];n.preserveRatio=e.preserveRatio,n.ratio=e.ratio},setRotation:function(t,e){var n=t.objects[e.id];n.rotation=e.rotation<0?360-Math.abs(e.rotation)%360:e.rotation%360},removeObject:function(t,e){var n=t.objects[e.id];delete t.objects[e.id];var r=t.panels[n.panelId];0===r.onTopOrder.length&&0===r.order.length&&delete t.panels[n.panelId]},setComposition:function(t,e){var n=t.objects[e.id];n.composite=e.composite},setFilters:function(t,e){var n=t.objects[e.id];n.filters=e.filters},setLabel:function(t,e){var n=t.objects[e.id];n.label=e.label},setTextboxColor:function(t,e){var n=t.objects[e.id];n.textboxColor=e.textboxColor},setEnlargeWhenTalking:function(t,e){var n=t.objects[e.id];n.enlargeWhenTalking=e.enlargeWhenTalking,++n.version},setObjectNameboxWidth:function(t,e){var n=t.objects[e.id];n.nameboxWidth=e.nameboxWidth,++n.version},setObjectZoom:function(t,e){var n=t.objects[e.id];n.zoom=e.zoom,++n.version}},ys),zt["b"]),Ds),Ss),_s),Ns),actions:Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])({removeObject:function(t,e){var n=t.state,r=t.commit,o=t.rootState,a=n.objects[e.id],i=n.panels[a.panelId];o.ui.selection===e.id&&r("ui/setSelection",null,{root:!0});for(var c=0,s=[].concat(Object(qr["a"])(i.onTopOrder),Object(qr["a"])(i.order));c<s.length;c++){var u=s[c],l=n.objects[u];a.id!==u&&"textBox"===l.type&&(l.talkingObjId===a.id&&r("setTalkingOther",{id:l.id,talkingOther:a.label||""}))}r("removeFromList",{id:e.id,onTop:a.onTop}),r("removeObject",{id:e.id})},setPosition:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,a=n.objects[e.id];"character"===a.type?o("setCharacterPosition",e):r("setPosition",e)},setOnTop:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=n.panels[o.panelId];o.onTop!==e.onTop&&(r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:(e.onTop?a.onTopOrder:a.order).length,onTop:e.onTop}),r("setOnTop",{id:e.id,onTop:e.onTop}))},shiftLayer:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=n.panels[o.panelId],i=o.onTop?a.onTopOrder:a.order,c=i.indexOf(o.id),s=c+e.delta;s<0&&(s=0),s>i.length&&(s=i.length),r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:s,onTop:o.onTop})},setPreserveRatio:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=e.preserveRatio?o.width/o.height:0;n("setRatio",{id:e.id,preserveRatio:e.preserveRatio,ratio:a})},setWidth:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=o.preserveRatio?e.width/o.ratio:o.height;n("setSize",{id:e.id,height:a,width:e.width})},setHeight:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=o.preserveRatio?e.height*o.ratio:o.width;n("setSize",{id:e.id,height:e.height,width:a})},fixContentPackRemoval:function(t,e){Object.values(t.state.objects).map((function(n){switch(n.type){case"character":return void Object(zt["d"])(t,n.id,e);case"sprite":return;case"textBox":return}}))},copyObjects:function(t,e){var n=t.commit,r=t.state,o=e.sourcePanelId,a=e.targetPanelId,i=r.panels[o];if(i){var c,s=[].concat(Object(qr["a"])(i.onTopOrder),Object(qr["a"])(i.order)),u=new Map,l=Object(yt["a"])(s);try{for(l.s();!(c=l.n()).done;){var d=c.value,f="copy_".concat(++Ms);u.set(d,f)}}catch(j){l.e(j)}finally{l.f()}var h,b=Object(yt["a"])(s);try{for(b.s();!(h=b.n()).done;){var p=h.value,m=r.objects[p],v=JSON.parse(JSON.stringify(m));if("talkingObjId"in v){var g=v;null!==g.talkingObjId&&u.has(g.talkingObjId)&&(g.talkingObjId=u.get(g.talkingObjId))}n("create",{object:Object(ue["a"])(Object(ue["a"])({},v),{},{id:u.get(p),panelId:a})})}}catch(j){b.e(j)}finally{b.f()}}},copyObjectToClipboard:function(t,e){var n=t.commit,r=t.state,o=e.id,a=r.objects[o];n("ui/setClipboard",JSON.stringify(a),{root:!0})},pasteObjectFromClipboard:function(t){var e=t.commit,n=t.rootState;if(n.ui.clipboard){var r=JSON.parse(n.ui.clipboard);e("create",{object:Object(ue["a"])(Object(ue["a"])({},r),{},{id:"copy_".concat(++Ms),panelId:n.panels.currentPanel})})}},deleteAllOfPanel:function(t,e){for(var n=t.state,r=t.dispatch,o=e.panelId,a=n.panels[o],i=0,c=[].concat(Object(qr["a"])(a.onTopOrder),Object(qr["a"])(a.order));i<c.length;i++){var s=c[i];r("removeObject",{id:s})}},addFilter:function(t,e){var n=t.state,r=t.commit;ro(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},removeFilter:function(t,e){var n=t.state,r=t.commit;oo(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},moveFilter:function(t,e){var n=t.state,r=t.commit;ao(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},setFilter:function(t,e){var n=t.state,r=t.commit;io(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))}},Cs),zt["a"]),Hs),Ps),Fs),Ws)},Ls={namespaced:!0,state:{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,pickColor:!1},mutations:{setVertical:function(t,e){t.vertical=e},setNsfw:function(t,e){t.nsfw=e},setLqRendering:function(t,e){t.lqRendering=e},setSelection:function(t,e){t.selection=e},setLastDownload:function(t,e){t.lastDownload=e},setClipboard:function(t,e){t.clipboard=e},setDarkTheme:function(t,e){t.useDarkTheme=e},setDefaultCharacterTalkingZoom:function(t,e){t.defaultCharacterTalkingZoom=e},setColorPicker:function(t,e){t.pickColor=e}}},Us=n("0a94"),zs=n("5311"),Gs=n("77e3"),qs=n("b3a0");function Ys(t,e){return{backgrounds:Xs(t.backgrounds,e.backgrounds),characters:Js(t.characters,e.characters),dependencies:nu(t.dependencies,e.dependencies),fonts:ru(t.fonts,e.fonts,(function(t){return t.id}),(function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{files:nu(t.files,e.files)})})),poemStyles:ru(t.poemStyles,e.poemStyles,(function(t){return t.label}),(function(){throw new Error})),poemBackgrounds:[].concat(Object(qr["a"])(t.poemBackgrounds),Object(qr["a"])(e.poemBackgrounds)),sprites:ru(t.sprites,e.sprites,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(qr["a"])(t.variants),Object(qr["a"])(e.variants)),defaultScale:t.defaultScale,hd:t.hd,sdVersion:t.sdVersion||e.sdVersion}})),colors:ru(t.colors,e.colors,(function(t){return t.color}),(function(t){return t}))}}function Xs(t,e){return ru(t,e,(function(t){return t.id}),Ks)}function Ks(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(qr["a"])(t.variants),Object(qr["a"])(e.variants)),scaling:t.scaling,sdVersion:t.sdVersion||e.sdVersion}}function Js(t,e){return ru(t,e,(function(t){return t.id}),Zs)}function Zs(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:eu(t.heads,e.heads),defaultScale:t.defaultScale,hd:t.hd,size:t.size,sdVersion:t.sdVersion,styleGroups:ru(t.styleGroups,e.styleGroups,(function(t){return t.id}),(function(t,e){return{id:t.id,styleComponents:ru(t.styleComponents,e.styleComponents,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:Qs(t.variants,e.variants)}})),styles:ru(t.styles,e.styles,(function(t){return JSON.stringify(t.components)}),(function(t,e){return{components:t.components,poses:ru(t.poses,e.poses,(function(t){return t.id}),tu)}}))}}))}}function Qs(t,e){var n=Object(ue["a"])({},t);for(var r in e)e.hasOwnProperty(r)&&(n.hasOwnProperty(r)||(n[r]=e[r]));return n}function tu(t,e){var n=Object(ue["a"])({},t.positions);for(var r in e.positions)n[r]?n[r]=[].concat(Object(qr["a"])(n[r]),Object(qr["a"])(e.positions[r])):n[r]=e.positions[r];return{id:t.id,compatibleHeads:nu(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function eu(t,e){var n=Object(ue["a"])({},t);for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];if(n[r]){var a=n[r];n[r]={previewOffset:a.previewOffset,previewSize:a.previewSize,variants:[].concat(Object(qr["a"])(a.variants),Object(qr["a"])(o.variants))}}else n[r]=o}return n}function nu(t,e){var n,r=Object(qr["a"])(t),o=Object(yt["a"])(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.includes(a)||r.push(a)}}catch(i){o.e(i)}finally{o.f()}return r}function ru(t,e,n,r){var o,a=Object(qr["a"])(t),i=new Map(t.map((function(t,e){return[n(t),e]}))),c=Object(yt["a"])(e);try{for(c.s();!(o=c.n()).done;){var s=o.value,u=n(s);if(i.has(u)){var l=i.get(u),d=a[l];a.splice(l,1,r(d,s))}else i.set(u,a.length),a.push(s)}}catch(f){c.e(f)}finally{c.f()}return a}function ou(t){return t.split("/").slice(0,-1).join("/")+"/"}var au=new Set(["png","gif","bmp","svg"]),iu={namespaced:!0,state:{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}},mutations:{setContentPacks:function(t,e){t.contentPacks=e},setCurrentContent:function(t,e){t.current=e}},actions:{contentPack:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.state,n.next=3,su(e);case 3:a=n.sent,i=new Set(o.contentPacks.map((function(t){return t.packId}))),c=Object(yt["a"])(e.dependencies),n.prev=6,c.s();case 8:if((s=c.n()).done){n.next=14;break}if(u=s.value,i.has(u)){n.next=12;break}throw new Error("Missing dependency '".concat(u,"'. Refusing to install ").concat(e.packId));case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),c.e(n.t0);case 19:return n.prev=19,c.f(),n.finish(19);case 22:r("setContentPacks",[].concat(Object(qr["a"])(o.contentPacks),[a])),r("setCurrentContent",Ys(o.current,a));case 24:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()},removeContentPacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,o=t.state,a=cu(o.contentPacks.filter((function(t){return!e.has(t.packId)}))),r("setContentPacks",a),r("setCurrentContent",a.reduce((function(t,e){return Ys(t,e)})));case 4:case"end":return n.stop()}}),n)})))()},replaceContentPack:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,o=t.state,!e.processed){n.next=5;break}n.t0=e.contentPack,n.next=8;break;case 5:return n.next=7,su(e.contentPack);case 7:n.t0=n.sent;case 8:a=n.t0,i=o.contentPacks,c=i.findIndex((function(t){return t.packId===e.contentPack.packId})),-1===c?i.push(a):i.splice(c,1,a),i=cu(i),r("setContentPacks",i),r("setCurrentContent",i.reduce((function(t,e){return Ys(t,e)})));case 15:case"end":return n.stop()}}),n)})))()},loadContentPacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,"string"===typeof e&&(e=[e]),n.next=4,Promise.all(e.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,n.ok||lu("Could not load content pack. Server responded with: ".concat(n.statusText)),t.prev=4,t.next=7,n.json();case 7:r=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),lu("Content pack is not valid json!");case 13:try{a={"./":ou(e),"/":ou(location.href)+"assets/"},o="2.0"===r.version?Object(zs["normalizeContentPack"])(r,a):Object(Gs["convert"])(Object(qs["normalizeCharacter"])(r,a),a,!1)}catch(i){lu("Content pack is not in a valid format!",i)}return t.abrupt("return",o);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()));case 4:o=n.sent,a=Object(yt["a"])(o),n.prev=6,a.s();case 8:if((i=a.n()).done){n.next=14;break}return c=i.value,n.next=12,r("contentPack",c);case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:return n.abrupt("return",o.map((function(t){return t.packId})));case 23:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()}},getters:{getCharacters:function(t){var e,n=t.current,r=new Map,o=Object(yt["a"])(n.characters);try{for(o.s();!(e=o.n()).done;){var a=e.value;r.set(a.id,a)}}catch(i){o.e(i)}finally{o.f()}return r},getBackgrounds:function(t){var e,n=t.current,r=new Map,o=Object(yt["a"])(n.backgrounds);try{for(o.s();!(e=o.n()).done;){var a=e.value;r.set(a.id,a)}}catch(i){o.e(i)}finally{o.f()}return r}}};function cu(t){return t}function su(t){return uu.apply(this,arguments)}function uu(){return uu=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,Object(wt["e"])();case 3:if(!t.sent){t.next=7;break}t.t1=["webp"].concat(Object(qr["a"])(au)),t.next=8;break;case 7:t.t1=au;case 8:return t.t2=t.t1,n=new t.t0(t.t2),r=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]),o=Object(Us["assetWalker"])(e,(function(t,o){var a=Object(Us["normalizePath"])(t,r,n,!1),i=Object(Us["normalizePath"])(t,r,n,!0);return{hq:a,lq:i,sourcePack:e.packId||"buildIn"}})),t.abrupt("return",o);case 13:case"end":return t.stop()}}),t)}))),uu.apply(this,arguments)}function lu(t,e){throw console.error(t,e),new Error(t)}var du=Object(ks["a"])({state:{unsafe:!1},mutations:{setUnsafe:function(t,e){t.unsafe=e}},actions:{removePacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,o=t.commit,a=t.state,i=e.packs,c=JSON.parse(JSON.stringify(a.content.current)),o("setUnsafe",!0),n.next=6,r("content/removeContentPacks",i);case 6:return n.next=8,r("panels/fixContentPackRemoval",c);case 8:return n.next=10,r("objects/fixContentPackRemoval",c);case 10:o("setUnsafe",!1);case 11:case"end":return n.stop()}}),n)})))()}},modules:{objects:Vs,ui:Ls,panels:bc,content:iu}}),fu=(n("4160"),n("159b"),{install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.config.globalProperties.$store)throw new Error("VuexUndoRedo plugin must be installed after the Vuex plugin.");e.resetStateMutation||(e.resetStateMutation="emptyState"),e.mutations||(e.mutations={});var n=t.config.globalProperties.$store;function o(t,e){var r={};switch(Object(uc["a"])(e.payload)){case"object":e.payload instanceof Array&&(r=[]),n.commit("".concat(e.type),Object.assign(r,e.payload));break;default:n.commit("".concat(e.type),e.payload)}}function a(t,e){return i.apply(this,arguments)}function i(){return i=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.transaction((function(){n.forEach((function(t){o(e,t)}))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function c(t){return s.apply(this,arguments)}function s(){return s=Object(u["a"])(regeneratorRuntime.mark((function t(r){var o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=r.data.done.slice(0),r.data.done=[],n.commit(e.resetStateMutation),i=0;case 4:if(!(i<o.length)){t.next=10;break}return t.next=7,a(r,o[i]);case 7:++i,t.next=4;break;case 10:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}var l={};function d(t){if(!l[t]){var n,r=t.split("/"),o={ignore:function(t){return!1},combinable:function(t,e){return!1},combinator:function(t,e){return e}},a="",i=Object(yt["a"])(r);try{for(i.s();!(n=i.n()).done;){var c=n.value;e.mutations[a+"*"]&&Object.assign(o,e.mutations[a+"*"]),a+=c+"/"}}catch(s){i.e(s)}finally{i.f()}e.mutations[t]&&Object.assign(o,e.mutations[t]),l[t]=o}return l[t]}var f={data:Object(r["s"])({done:[],undone:[],newMutation:!0,ignoreMutations:e.ignoreMutations||[],currentTransaction:null,transactionQueue:[],initialized:!1}),initialize:function(){f.initialized||(f.initialized=!0,n.subscribe((function(t){var n=function(){t.type===e.resetStateMutation||d(t.type).ignore(t)||(f.currentTransaction.push(t),f.newMutation&&(f.data.undone=[]))};f.currentTransaction?n():f.transaction((function(){n()}))})))},redo:function(){if(!(f.data.undone.length<=0)){var t=f.data.undone.pop();f.newMutation=!1,a(f,t),f.newMutation=!0}},undo:function(){return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(f.data.done.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return f.data.undone.push(f.data.done.pop()),f.newMutation=!1,t.next=6,c(f);case 6:f.newMutation=!0;case 7:case"end":return t.stop()}}),t)})))()},transaction:function(t){return new Promise((function(e,n){var r=function(){var n=Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return f.currentTransaction=[],n.prev=1,n.next=4,t();case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),console.log("Error during transaction!: ",n.t0);case 9:r=f.data.done[f.data.done.length-1],1===f.currentTransaction.length&&r&&1===r.length&&(o=d(f.currentTransaction[0].type),o.combinable(r[0],f.currentTransaction[0])&&(a=o.combinator(r[0],f.currentTransaction[0]),f.data.done.pop(),f.currentTransaction=a?[a]:[])),f.currentTransaction.length>0&&f.data.done.push(f.currentTransaction),f.currentTransaction=null,f.data.transactionQueue.length>0&&f.data.transactionQueue.pop()(),e();case 15:case"end":return n.stop()}}),n,null,[[1,6]])})));return function(){return n.apply(this,arguments)}}();f.currentTransaction?f.data.transactionQueue.push(r):r()}))}};t.config.globalProperties.vuexHistory=f,f.initialize()}});Object(r["f"])(Os).use(du).use(fu).mount("#app")},cda6:function(t,e,n){},cf9e:function(t,e,n){"use strict";n("20ef")},d10c:function(t,e,n){},d206:function(t,e,n){"use strict";n.r(e),n.d(e,"TextBoxWidth",(function(){return i})),n.d(e,"TextBoxCorruptedWidth",(function(){return c})),n.d(e,"TextBoxHeight",(function(){return s})),n.d(e,"TextBoxKerning",(function(){return u})),n.d(e,"TextBoxLineHeight",(function(){return l})),n.d(e,"TextBoxCorruptedKerning",(function(){return d})),n.d(e,"TextBoxTextXOffset",(function(){return f})),n.d(e,"TextBoxTextYOffset",(function(){return h})),n.d(e,"TextBoxBottomSpacing",(function(){return b})),n.d(e,"HdSpacing",(function(){return p})),n.d(e,"HdSideMargin",(function(){return m})),n.d(e,"TextBoxTextCorruptedXOffset",(function(){return v})),n.d(e,"TextBoxTextCorruptedYOffset",(function(){return g})),n.d(e,"NameboxHeight",(function(){return j})),n.d(e,"NameboxWidth",(function(){return O})),n.d(e,"NameboxXOffset",(function(){return k})),n.d(e,"NameboxTextYOffset",(function(){return x})),n.d(e,"ControlsYBottomOffset",(function(){return y})),n.d(e,"ControlsXHistoryOffset",(function(){return w})),n.d(e,"ControlsXSkipOffset",(function(){return C})),n.d(e,"ControlsXStuffOffset",(function(){return S})),n.d(e,"ArrowXRightOffset",(function(){return R})),n.d(e,"ArrowYBottomOffset",(function(){return P})),n.d(e,"GlowRX",(function(){return T})),n.d(e,"GlowRY",(function(){return B})),n.d(e,"BaseTextStyle",(function(){return I})),n.d(e,"NameboxTextStyle",(function(){return D})),n.d(e,"ControlsTextStyle",(function(){return A})),n.d(e,"ControlsTextDisabledStyle",(function(){return H})),n.d(e,"TextBoxCorruptedStyle",(function(){return _})),n.d(e,"TextBoxStyle",(function(){return $})),n.d(e,"TextBoxX",(function(){return F})),n.d(e,"TextBoxCorruptedX",(function(){return N})),n.d(e,"TextBoxTextX",(function(){return E})),n.d(e,"NameboxX",(function(){return W})),n.d(e,"NameboxTextX",(function(){return M})),n.d(e,"ControlsXHistory",(function(){return V})),n.d(e,"ControlsXSkip",(function(){return L})),n.d(e,"ControlsXStuff",(function(){return U})),n.d(e,"DefaultTextboxStyle",(function(){return z}));var r=n("5530"),o=n("e14c"),a=n("525a"),i=816,c=900,s=146,u=0,l=29,d=8,f=38,h=44,b=6,p=93,m=404,v=9,g=9,j=39,O=168,k=34,x=29,y=12,w=-126,C=-72,S=-38,R=30.75,P=26,T=426,B=58,I={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},D=Object(r["a"])(Object(r["a"])({},I),{},{fontName:"riffic",fontSize:24,strokeColor:a["nameboxStrokeDefaultColor"],strokeWidth:6,color:"white",letterSpacing:1}),A={align:"left",font:"13px aller",fill:{style:"#522"}},H=Object(r["a"])(Object(r["a"])({},A),{},{fill:{style:"#a66"}}),_={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},$={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},F=o["screenWidth"]/2-i/2,N=o["screenWidth"]/2-c/2,E=F+f,W=F+k,M=W+O/2,V=F+w,L=F+C,U=F+S,z="normal"},d38f:function(t,e,n){},db4f:function(t,e,n){},dc61:function(t,e,n){"use strict";var r=n("7a23"),o=Object(r["F"])("data-v-0c92f421"),a=o((function(t,e,n,o,a,i){return t.visible?(Object(r["p"])(),Object(r["g"])("div",{key:0,onDragleave:e[1]||(e[1]=function(e){return t.visible=!1}),onDrop:e[2]||(e[2]=function(){return t.drop&&t.drop.apply(t,arguments)}),class:{vertical:t.vertical}},[Object(r["v"])(t.$slots,"default",{},void 0,!0)],34)):Object(r["h"])("",!0)})),i=(n("ac1f"),n("466d"),n("b85c")),c=Object(r["m"])({computed:{vertical:function(){return this.$store.state.ui.vertical}},data:function(){return{visible:!1}},methods:{show:function(){this.visible=!0},hide:function(){this.visible=!1},drop:function(t){if(this.hide(),t.stopPropagation(),t.preventDefault(),t.dataTransfer){var e,n=Object(i["a"])(t.dataTransfer.items);try{for(n.s();!(e=n.n()).done;){var r=e.value;"file"===r.kind&&r.type.match(/image.*/)&&this.$emit("drop",r.getAsFile())}}catch(o){n.e(o)}finally{n.f()}}}}});n("fc0e");c.render=a,c.__scopeId="data-v-0c92f421";e["a"]=c},dd24:function(t,e,n){"use strict";n("d10c")},ddde:function(t,e,n){"use strict";n("acb5")},e074:function(t,e,n){},e14c:function(t,e,n){"use strict";n.r(e),n.d(e,"screenWidth",(function(){return r})),n.d(e,"screenHeight",(function(){return o})),n.d(e,"positions",(function(){return a})),n.d(e,"sdCharacterScaleFactor",(function(){return i})),n.d(e,"hdCharacterScaleFactor",(function(){return c})),n.d(e,"CloseUpYOffset",(function(){return s})),n.d(e,"BaseCharacterYPos",(function(){return u})),n.d(e,"characterPositions",(function(){return l}));var r=1280,o=720,a=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],i=1,c=1/1.5,s=-74,u=-26,l=[200,240,400,493,640,786,880,1040,1080]},e965:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("99af"),n("dca8");var r=n("d4ec"),o=n("bee2"),a=n("31cb"),i=function(){function t(e,n,o,a){Object(r["a"])(this,t),this.h=e,this.s=n,this.l=o,this.a=a,Object.freeze(this)}return Object(o["a"])(t,[{key:"toCss",value:function(){return this.a>=1?"hsl(".concat(this.h,", ").concat(this.s,", ").concat(this.l,")"):"hsla(".concat(this.h,", ").concat(this.s,", ").concat(this.l,", ").concat(this.a,")")}},{key:"shift",value:function(e){var n=this.h,r=this.s,o=this.l,a=this.a;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),r+e.s>1?r-=e.s:(r+=e.s,r<0&&(r=0)),o+e.l>1||o+e.l<0?o-=e.l:o+=e.l,a+e.a>1||a+e.a<0?a-=e.a:a+=e.a,new t(n,r,o,a)}},{key:"toRgb",value:function(){var t,e,n,r=this.h,o=this.s,i=this.l,c=this.a;if(0===o)t=e=n=i;else{var s=i<.5?i*(1+o):i+o-i*o,u=2*i-s;t=this.hue2rgb(u,s,r+1/3),e=this.hue2rgb(u,s,r),n=this.hue2rgb(u,s,r-1/3)}return new a["a"](Math.round(255*t),Math.round(255*e),Math.round(255*n),c)}},{key:"toHSL",value:function(){return this}},{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}]),t}()},ec4d:function(t,e,n){},edcc:function(t,e,n){"use strict";n("6700")},f3c1:function(t,e,n){"use strict";n("536a")},f6f2:function(t,e,n){},f70f:function(t,e,n){"use strict";n.r(e),n.d(e,"poemBackgrounds",(function(){return a})),n.d(e,"defaultPoemBackground",(function(){return i})),n.d(e,"defaultPoemStyle",(function(){return c})),n.d(e,"defaultX",(function(){return s})),n.d(e,"defaultY",(function(){return u})),n.d(e,"poemTopPadding",(function(){return l})),n.d(e,"poemBottomPadding",(function(){return d})),n.d(e,"poemPadding",(function(){return f})),n.d(e,"defaultPoemWidth",(function(){return h})),n.d(e,"defaultPoemHeight",(function(){return b})),n.d(e,"consoleBackgroundColor",(function(){return p})),n.d(e,"consoleWidth",(function(){return m})),n.d(e,"consoleHeight",(function(){return v})),n.d(e,"defaultConsoleBackground",(function(){return g})),n.d(e,"defaultConsoleStyle",(function(){return j})),n.d(e,"poemTextStyles",(function(){return k}));var r=n("5530"),o=n("e14c"),a=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],i=0,c=0,s=o["screenWidth"]/2,u=o["screenHeight"]/2,l=33,d=100,f=30,h=800,b=720,p="rgba(51,51,51,0.75)",m=480,v=180,g=3,j=7,O={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},k=[Object(r["a"])(Object(r["a"])({},O),{},{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),Object(r["a"])(Object(r["a"])({},O),{},{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),Object(r["a"])(Object(r["a"])({},O),{},{name:"Monika",fontName:"journal",fontSize:34}),Object(r["a"])(Object(r["a"])({},O),{},{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),Object(r["a"])(Object(r["a"])({},O),{},{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),Object(r["a"])(Object(r["a"])({},O),{},{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),Object(r["a"])(Object(r["a"])({},O),{},{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),Object(r["a"])(Object(r["a"])({},O),{},{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})]},fc0e:function(t,e,n){"use strict";n("d38f")},fd0b:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n("d3b7"),n("96cf");var r=n("1da1"),o=n("d4ec"),a=n("bee2"),i=n("6ae4"),c=n("73e5"),s=n("032b"),u=n("8f12"),l=function(){function t(e,n){Object(o["a"])(this,t),this.runningContext=null;var r=Object(u["a"])();this.previewCanvas=document.createElement("canvas"),this.previewCanvas.width=null!==e&&void 0!==e?e:r.Base.screenWidth,this.previewCanvas.height=null!==n&&void 0!==n?n:r.Base.screenHeight}return Object(a["a"])(t,[{key:"render",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(s.length>1&&void 0!==s[1])||s[1],r=!(s.length>2&&void 0!==s[2])||s[2],this.runningContext&&this.runningContext.abort(),o=this.previewCanvas.getContext("2d"),o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),a=this.runningContext=i["a"].makeWithContext(this.previewCanvas,o,n,r),t.prev=6,t.next=9,e(this.runningContext);case 9:t.next=16;break;case 11:if(t.prev=11,t.t0=t["catch"](6),!(t.t0 instanceof c["a"])){t.next=15;break}return t.abrupt("return",!1);case 15:throw t.t0;case 16:return t.prev=16,a===this.runningContext&&(this.runningContext=null),t.finish(16);case 19:return t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,this,[[6,11,16,19]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"paintOnto",value:function(t,e){e.w&&e.h?t.drawImage(this.previewCanvas,e.x,e.y,e.w,e.h):t.drawImage(this.previewCanvas,e.x,e.y)}},{key:"download",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=document.createElement("canvas"),r.width=this.previewCanvas.width,r.height=this.previewCanvas.height,o=r.getContext("2d"),o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(i["a"].makeWithContext(r,o,!0,!1));case 7:return t.abrupt("return",s["a"].saveToFile(r,n));case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"renderToBlob",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=document.createElement("canvas"),n.width=this.previewCanvas.width,n.height=this.previewCanvas.height,r=n.getContext("2d"),r.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(i["a"].makeWithContext(n,r,!0,!1));case 7:return t.next=9,new Promise((function(t,e){n.toBlob((function(n){n?t(n):e()}))}));case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDataAt",value:function(t,e){var n=this.previewCanvas.getContext("2d");return n.getImageData(t,e,1,1).data}},{key:"width",get:function(){return this.previewCanvas.width}},{key:"height",get:function(){return this.previewCanvas.height}}]),t}()}});
//# sourceMappingURL=app.a6f1c6b6.js.map